<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Thunderbird for Android - Developer Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="Developer Documentation for the Thunderbird for Android project.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="assets/theme/last-changed.css">
        <link rel="stylesheet" href="assets/theme/navigation.css">
        <link rel="stylesheet" href="assets/theme/pagetoc.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Thunderbird for Android - Developer Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/thunderbird/thunderbird-android" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="about-thunderbird-for-android"><a class="header" href="#about-thunderbird-for-android">About Thunderbird for Android</a></h1>
<p>Thunderbird for Android (TfA) is a powerful, privacy‑focused email app for managing multiple accounts with ease —
including a Unified Inbox for maximum productivity. It’s open source, built with the community, and never treats your
private data as a product.</p>
<p>This page is for both <strong>users</strong> and <strong>contributors</strong>:</p>
<ul>
<li>If you want to use Thunderbird for Android, see <a href="about.html#download">Download</a>.</li>
<li>If you want to contribute, jump to <a href="about.html#contributing">Contributing</a>.</li>
</ul>
<h2 id="-download"><a class="header" href="#-download">📥 Download</a></h2>
<p>You can get Thunderbird for Android from multiple sources:</p>
<ul>
<li><a href="https://play.google.com/store/apps/details?id=net.thunderbird.android" title="" target="_blank">Google Play</a></li>
<li><a href="https://f-droid.org/packages/net.thunderbird.android" title="" target="_blank">F-Droid</a></li>
<li><a href="https://play.google.com/store/apps/details?id=net.thunderbird.android.beta" title="" target="_blank">Beta (early access) on Google Play</a></li>
<li><a href="https://f-droid.org/packages/net.thunderbird.android.beta" title="" target="_blank">Beta on F-Droid</a></li>
<li><a href="https://github.com/thunderbird/thunderbird-android/releases" title="" target="_blank">GitHub Releases</a></li>
</ul>
<p>Check the <a href="https://github.com/thunderbird/thunderbird-android/releases" title="" target="_blank">Release Notes</a> to see what’s new in each version.</p>
<h2 id="-highlights"><a class="header" href="#-highlights">✨ Highlights</a></h2>
<ul>
<li>Unified Inbox and multiple account support</li>
<li>Open source, privacy‑respecting by design</li>
<li>Modern, fast UI with helpful features like powerful search and rich composer</li>
<li>Actively developed with regular updates</li>
</ul>
<h2 id="-k9-mail-heritage"><a class="header" href="#-k9-mail-heritage">📨 K‑9 Mail heritage</a></h2>
<p>Thunderbird for Android is based on <strong>K‑9 Mail</strong>, a long‑standing open source email app. The projects share much of
the same code and therefore may look and feel similar.</p>
<p>Some features are selectively enabled in Thunderbird when they are a better fit for Thunderbird users (e.g., import from K‑9).</p>
<p>If you prefer to keep using K‑9 Mail, you can find it here:</p>
<ul>
<li><a href="https://play.google.com/store/apps/details?id=com.fsck.k9" title="" target="_blank">Google Play</a></li>
<li><a href="https://f-droid.org/packages/com.fsck.k9/" title="" target="_blank">F‑Droid</a></li>
</ul>
<h2 id="-need-help-or-have-feedback"><a class="header" href="#-need-help-or-have-feedback">❓ Need help or have feedback?</a></h2>
<ul>
<li><a href="https://support.mozilla.org/products/thunderbird-android" title="" target="_blank">Knowledge base</a></li>
<li><a href="https://support.mozilla.org/kb/thunderbird-android-8-faq" title="" target="_blank">FAQ</a></li>
<li><a href="https://support.mozilla.org/en-US/questions/new/thunderbird-android" title="" target="_blank">Support forum</a></li>
<li><a href="https://github.com/thunderbird/thunderbird-android/issues" title="" target="_blank">Bug tracker</a></li>
<li><a href="https://connect.mozilla.org/t5/ideas/idb-p/ideas/label-name/thunderbird%20android" title="" target="_blank">Ideas &amp; voting</a></li>
</ul>
<p>Community chat (Matrix):</p>
<ul>
<li><a href="https://matrix.to/#/#tb-android:mozilla.org" title="" target="_blank">General</a></li>
<li><a href="https://matrix.to/#/#tb-android-dev:mozilla.org" title="" target="_blank">Development</a></li>
<li><a href="https://matrix.to/#/#thunderbird-community:mozilla.org" title="" target="_blank">Thunderbird community space</a></li>
</ul>
<h2 id="-contributing"><a class="header" href="#-contributing">🤝 Contributing</a></h2>
<p>We welcome contributions of all kinds:</p>
<ul>
<li>Development: <a href="CONTRIBUTING.html">Contributing Guide</a> if you want to help with code</li>
<li>Translations: <a href="https://hosted.weblate.org/projects/tb-android/" title="" target="_blank">Weblate Project</a> if you want to help localize the app</li>
<li><a href="https://blog.thunderbird.net/2024/09/contribute-to-thunderbird-for-android/" title="" target="_blank">Other ways to help</a></li>
<li><a href="https://www.mozilla.org/about/governance/policies/participation/" title="" target="_blank">Participation guidelines</a></li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-contributing-to-thunderbird-for-android"><a class="header" href="#-contributing-to-thunderbird-for-android">🤝 Contributing to Thunderbird for Android</a></h1>
<p>Welcome to the Thunderbird for Android project! We’re excited to have you here and welcome your contributions.</p>
<h2 id="-new-contributor-essentials"><a class="header" href="#-new-contributor-essentials">🌱 New Contributor Essentials</a></h2>
<p>Before you start contributing, please take a moment to familiarize yourself with the following:</p>
<ul>
<li><a href="about.html">About Thunderbird for Android</a>.</li>
<li><a href="https://developer.thunderbird.net/" title="" target="_blank">Thunderbird Developer Portal</a></li>
<li><a href="https://www.mozilla.org/en-US/about/governance/policies/participation/" title="" target="_blank">Mozilla Community Participation Guidelines</a></li>
<li><a href="https://matrix.to/#/#tb-mobile-dev:mozilla.org" title="" target="_blank">Matrix (developer chat)</a></li>
<li><a href="https://forum.k9mail.app/c/faq" title="" target="_blank">Frequently Asked Questions (historical K-9 forum)</a></li>
<li><a href="https://forum.k9mail.app/" title="" target="_blank">Support Forum (historical K-9 forum)</a></li>
</ul>
<p>Note: Some support resources currently point to the K-9 Mail forum due to the project’s history and ongoing migration.
Where appropriate, we’ll update links to Thunderbird-specific channels.</p>
<h3 id="-recommended-knowledge"><a class="header" href="#-recommended-knowledge">📋 Recommended knowledge</a></h3>
<p>Helpful background (not strictly required):</p>
<ul>
<li><strong><a href="https://kotlinlang.org/docs/home.html" title="" target="_blank">Kotlin</a></strong> - Primary programming language for the project</li>
<li><strong><a href="https://developer.android.com/jetpack/compose" title="" target="_blank">Jetpack Compose</a></strong> - UI toolkit used for Android</li>
<li><strong><a href="https://kotlinlang.org/docs/multiplatform.html" title="" target="_blank">Kotlin Multiplatform</a></strong> - Shared code across modules where applicable</li>
<li><strong><a href="https://developer.android.com/guide" title="" target="_blank">Android Development</a></strong> - Basic understanding of Android app development</li>
<li><strong><a href="https://docs.github.com/en" title="" target="_blank">GitHub</a></strong> - For managing contributions and pull requests</li>
</ul>
<h2 id="-bug-reports-and-feature-ideas"><a class="header" href="#-bug-reports-and-feature-ideas">🐛 Bug Reports and Feature Ideas</a></h2>
<p>When you encounter a bug or have a feature request or idea, please do the following:</p>
<p><strong>Bugs</strong>:</p>
<ul>
<li>Search for <a href="https://github.com/thunderbird/thunderbird-android/issues?q=is%3Aissue" title="" target="_blank">existing issues</a> before filing a new one.</li>
<li>If you can’t find an existing issue, please <a href="https://github.com/thunderbird/thunderbird-android/issues/new/choose" title="" target="_blank">open a new GitHub issue</a> using the appropriate template.</li>
</ul>
<p><strong>Feature Requests / Ideas:</strong></p>
<p>We don’t track new ideas or feature requests in GitHub Issues.</p>
<ul>
<li>Start a discussion in <a href="https://connect.mozilla.org/t5/ideas/idb-p/ideas/label-name/thunderbird%20android" title="" target="_blank">Mozilla Connect – Ideas</a></li>
<li>Once a feature is accepted and work is planned, maintainers will create the corresponding GitHub issue(s).</li>
</ul>
<h2 id="-translations"><a class="header" href="#-translations">🌐 Translations</a></h2>
<p>If you’d like to help to translate Thunderbird for Android, please visit:</p>
<ul>
<li><strong><a href="contributing/translations.html">Translations</a></strong> – How to help localize Thunderbird for Android via Weblate.</li>
<li><strong><a href="https://hosted.weblate.org/projects/tb-android/" title="" target="_blank">Weblate - Thunderbird for Android project</a></strong> - Translation platform where all localization happens.</li>
</ul>
<h2 id="-contributing-code"><a class="header" href="#-contributing-code">🤝 Contributing Code</a></h2>
<p>This should give you a detailed overview on how to contribute code to the project. Use it as a reference for setup,
development, testing, and review.</p>
<h3 id="-getting-started"><a class="header" href="#-getting-started">🚀 Getting Started</a></h3>
<ul>
<li><strong><a href="contributing/contribution-workflow.html">Contribution Workflow</a></strong> – Step-by-step process: find an issue, fork, branch, commit, PR.</li>
<li><strong><a href="contributing/development-environment.html">Development Environment</a></strong> – How to set up Android Studio, build, run, and debug the project.</li>
</ul>
<h3 id="-development-practices"><a class="header" href="#-development-practices">🏗️ Development Practices</a></h3>
<ul>
<li><strong><a href="architecture/README.html">Architecture</a></strong> – System design: module types, UI/Domain/Data layers, offline-first.</li>
<li><strong><a href="contributing/development-guide.html">Development Guidelines</a></strong> – Project-specific conventions and quick “do’s &amp; don’ts.”</li>
<li><strong><a href="contributing/code-quality-guide.html">Code Quality Guide</a></strong> – Style rules, static analysis tools, and security practices.</li>
<li><strong><a href="contributing/testing-guide.html">Testing Guide</a></strong> – Test layers, frameworks, and best practices.</li>
</ul>
<h3 id="-reviews--collaboration"><a class="header" href="#-reviews--collaboration">🔍 Reviews &amp; Collaboration</a></h3>
<ul>
<li><strong><a href="contributing/git-commit-guide.html">Git Commit Guide</a></strong> – How to write clear, Conventional Commit-style messages.</li>
<li><strong><a href="contributing/code-review-guide.html">Code Review Guide</a></strong> – Expectations for PR authors and reviewers, review etiquette.</li>
</ul>
<h3 id="-translations-1"><a class="header" href="#-translations-1">🌐 Translations</a></h3>
<ul>
<li><strong><a href="contributing/translations.html">Translations</a></strong> – How to help localize Thunderbird for Android via Weblate.</li>
<li><strong><a href="contributing/managing-strings.html">Managing Strings</a></strong> – Developer guide for adding/changing/removing strings, languages, and handling Weblate sync.</li>
</ul>
<h2 id="thank-you"><a class="header" href="#thank-you">Thank You!</a></h2>
<p>Thank you for taking the time to contribute to Thunderbird for Android! We appreciate your help in making the project better and more useful for everyone.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-development-environment"><a class="header" href="#-development-environment">🚀 Development Environment</a></h1>
<p>This guide will help you set up your development environment and get started with contributing to the Thunderbird for
Android project.</p>
<h2 id="-prerequisites"><a class="header" href="#-prerequisites">📋 Prerequisites</a></h2>
<p>Before you begin, ensure you have the following installed:</p>
<ul>
<li><strong><a href="https://adoptium.net/temurin/releases/?version=17" title="" target="_blank">Java Development Kit (JDK)</a></strong> - Version 17 or higher (Temurin OpenJDK recommended)</li>
<li><strong><a href="https://developer.android.com/studio" title="" target="_blank">Android Studio</a></strong> - Latest stable version recommended</li>
<li><strong><a href="https://git-scm.com/downloads" title="" target="_blank">Git</a></strong> - For version control</li>
<li><strong>Gradle</strong> - Use the Gradle wrapper included in this repo (<code>./gradlew</code>); no separate install required</li>
<li><strong>Android SDK &amp; command-line tools</strong> – Installed and managed via Android Studio SDK Manager</li>
</ul>
<h2 id="-setting-up-the-development-environment"><a class="header" href="#-setting-up-the-development-environment">🔧 Setting Up the Development Environment</a></h2>
<h3 id="1-get-the-source-code"><a class="header" href="#1-get-the-source-code">1. Get the Source Code</a></h3>
<p>All contributions happen through a personal fork of the repository.</p>
<ul>
<li>If you haven’t forked the project yet, see the <a href="contributing/contribution-workflow.html">Contribution Workflow</a> for step-by-step instructions.</li>
<li>Once you have a fork, clone it to your machine and open it in Android Studio.</li>
</ul>
<ol>
<li>Go to the <a href="https://github.com/thunderbird/thunderbird-android" title="" target="_blank">Thunderbird for Android repository</a></li>
<li>Click the <strong>Fork</strong> button in the top-right corner</li>
<li>Create a fork under your GitHub account</li>
</ol>
<h3 id="2-import-the-project-into-android-studio"><a class="header" href="#2-import-the-project-into-android-studio">2. Import the Project into Android Studio</a></h3>
<ol>
<li>Open Android Studio</li>
<li>Select <strong>Open an Existing Project</strong></li>
<li>Navigate to the cloned repository and open it</li>
<li>Wait for project sync and indexing</li>
</ol>
<h3 id="3-configure-android-studio"><a class="header" href="#3-configure-android-studio">3. Configure Android Studio</a></h3>
<p>For the best development experience, we recommend the following settings:</p>
<ul>
<li><strong>Recommended plugins:</strong>
<ul>
<li><strong>Kotlin Multiplatform</strong> (usually bundled; if not, install from the JetBrains Marketplace)</li>
</ul>
</li>
</ul>
<h2 id="-building-the-project"><a class="header" href="#-building-the-project">🏗️ Building the Project</a></h2>
<h3 id="building-from-android-studio"><a class="header" href="#building-from-android-studio">Building from Android Studio</a></h3>
<ol>
<li>Select the app module (e.g., <code>app-thunderbird</code> or <code>app-k9mail</code>) in the <strong>Run/Debug Configuration</strong> dropdown</li>
<li>Select build variant you want to work with (Debug/Release) from Build Variants window</li>
<li>Click the <strong>Build</strong> button or press <code>Ctrl+F9</code> (Windows/Linux) or <code>Cmd+F9</code> (macOS)</li>
</ol>
<h3 id="building-from-command-line"><a class="header" href="#building-from-command-line">Building from Command Line</a></h3>
<p>A Gradle wrapper is included in the project, so you can build the project from the command line without installing
Gradle globally. Run the following commands from the root of the project, where <code>./gradlew</code> is the Gradle wrapper script
and the command to <code>build</code> runs tests and other checks, while <code>assemble</code> only compiles the code and packages the APK.</p>
<pre><code class="language-bash"># Build all variants
./gradlew assemble
./gradlew build

# Build debug or release variant
./gradlew assembleDebug
./gradlew assembleRelease

# Build a specific app module
./gradlew :app-thunderbird:assembleDebug
./gradlew :app-k9mail:assembleDebug

# Build a specific library/feature module
./gradlew :module-name:build
</code></pre>
<p>Replace <code>module-name</code> with the actual name of the module you want to build.</p>
<h2 id="-running-the-application"><a class="header" href="#-running-the-application">🚀 Running the Application</a></h2>
<h3 id="running-on-an-emulator"><a class="header" href="#running-on-an-emulator">Running on an Emulator</a></h3>
<ol>
<li><a href="https://developer.android.com/studio/run/managing-avds" title="" target="_blank">Set up an Android Virtual Device (AVD)</a> in Android Studio with a recent API level with Google APIs image.</li>
<li>Select the AVD from the device dropdown.</li>
<li>Click the <strong>Run</strong> button or press <code>Shift+F10</code> (Windows/Linux) or <code>Ctrl+R</code> (macOS)</li>
</ol>
<h3 id="running-on-a-physical-device"><a class="header" href="#running-on-a-physical-device">Running on a Physical Device</a></h3>
<ol>
<li><a href="https://developer.android.com/studio/debug/dev-options" title="" target="_blank">Enable Developer Options and USB Debugging</a> on your device</li>
<li>Connect your device to your computer via USB and confirm trust dialog if prompted</li>
<li>Select your device from the device dropdown and click <strong>Run</strong></li>
</ol>
<h2 id="-running-tests"><a class="header" href="#-running-tests">🧪 Running Tests</a></h2>
<pre><code class="language-bash"># Run all tests across modules
./gradlew test

# Run unit tests for a specific module
./gradlew :module-name:test

# Run instrumented tests (device/emulator required)
./gradlew connectedAndroidTest
</code></pre>
<p>See the <a href="contributing/testing-guide.html">Testing Guide</a> for details.</p>
<h2 id="-checking-code-quality"><a class="header" href="#-checking-code-quality">🔍 Checking Code Quality</a></h2>
<p>Maintaining high code quality is essential for the long-term sustainability of the Thunderbird for Android project. The project uses several tools and practices to ensure code quality:</p>
<ul>
<li><strong>Static Analysis Tools</strong>: Android Lint, Detekt, and Spotless</li>
<li><strong>Code Style Guidelines</strong>: Kotlin style guide and project-specific conventions</li>
<li><strong>Testing</strong>: Unit tests, integration tests, and UI tests</li>
<li><strong>Code Reviews</strong>: Peer review process for all code changes</li>
<li><strong>Continuous Integration</strong>: Automated checks for build success, tests, and code quality</li>
</ul>
<p>To run the basic code quality checks:</p>
<pre><code class="language-bash"># Run lint checks
./gradlew lint

# Run detekt
./gradlew detekt

# Check code formatting
./gradlew spotlessCheck

# Apply code formatting fixes
./gradlew spotlessApply
</code></pre>
<p>See the <a href="contributing/code-quality-guide.html">Code Quality Guide</a> for more details.</p>
<h2 id="-debugging"><a class="header" href="#-debugging">🐛 Debugging</a></h2>
<h3 id="using-the-debugger"><a class="header" href="#using-the-debugger">Using the Debugger</a></h3>
<ol>
<li>Set breakpoints in your code by clicking in the gutter next to the line numbers</li>
<li>Start debugging by clicking the <strong>Debug</strong> button or pressing <code>Shift+F9</code> (Windows/Linux) or <code>Ctrl+D</code> (macOS)</li>
<li>Use the debugger controls to step through code, inspect variables, and evaluate expressions</li>
<li></li>
</ol>
<p>See the <a href="https://developer.android.com/studio/debug" title="" target="_blank">Android Studio Debugger Guide</a> for a detailed description.</p>
<h3 id="logging"><a class="header" href="#logging">Logging</a></h3>
<p>Use the project’s core logging API <code>net.thunderbird.core.logging.Logger</code>, which is provided via dependency injection
(Koin). Avoid logging <strong>personally identifiable information (PII)</strong>.</p>
<p>Example with DI (Koin):</p>
<pre><code class="language-kotlin">private const val TAG = "ExampleActivity"

class ExampleActivity : ComponentActivity() {
    private val logger: Logger by inject()

    fun doSomething() {
        logger.debug(tag = TAG) { "Debug message" }
        
        try {
            // Some code that might throw an exception
        } catch (exception: Exception) {
            logger.error(tag = TAG, throwable = exception) { "An error occurred" }
        }
    }
}
</code></pre>
<h3 id="profiling"><a class="header" href="#profiling">Profiling</a></h3>
<p>Use Android Studio’s built-in <a href="https://developer.android.com/studio/profile/android-profiler" title="" target="_blank">Android Profiler</a> to monitor:</p>
<ul>
<li>CPU usage</li>
<li>Memory allocation</li>
<li>Network activity</li>
</ul>
<p>For performance-sensitive code, also consider Baseline Profiles or Macrobenchmark tests.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-contribution-workflow"><a class="header" href="#-contribution-workflow">🤝 Contribution Workflow</a></h1>
<p>The contribution workflow for the Thunderbird for Android project explains the process of contributing code, from
finding an issue to getting your pull request merged.</p>
<h2 id="-quick-workflow"><a class="header" href="#-quick-workflow">✅ Quick Workflow</a></h2>
<pre><code class="language-markdown">- [ ] Find an issue (or open a bug report)
- [ ] Fork → clone → add upstream remote
- [ ] Create a descriptive branch from `main`
- [ ] Make focused changes + update docs/tests
- [ ] Run `./gradlew check` locally (matches CI)
- [ ] Commit with Conventional Commits (Fix: #123)
- [ ] Push branch to your fork
- [ ] Open a pull request with description/screenshots
- [ ] Respond to review feedback → update branch
- [ ] Once merged: delete branch, sync fork, celebrate 🎉
</code></pre>
<h2 id="-finding-an-issue-to-work-on"><a class="header" href="#-finding-an-issue-to-work-on">🔍 Finding an Issue to Work On</a></h2>
<h3 id="exploring-issues"><a class="header" href="#exploring-issues">Exploring Issues</a></h3>
<p>Before starting work, find an appropriate issue to work on:</p>
<ul>
<li>Browse the <a href="https://github.com/thunderbird/thunderbird-android/issues" title="" target="_blank">GitHub Issues</a> for open issues</li>
<li>Look for issues labeled <a href="https://github.com/thunderbird/thunderbird-android/labels/good%20first%20issue" title="" target="_blank">good first issue</a> if you’re new to the project</li>
<li>Avoid issues labeled <a href="https://github.com/thunderbird/thunderbird-android/labels/unconfirmed" title="" target="_blank">unconfirmed</a> as they are not yet ready for contributions</li>
</ul>
<h3 id="requesting-new-features--ideas"><a class="header" href="#requesting-new-features--ideas">Requesting New Features / Ideas</a></h3>
<p>We don’t track new ideas or feature requests in GitHub Issues. Mozilla connect is where feature proposals, product
decisions, and larger design conversations happen.</p>
<ul>
<li>Start a discussion in <a href="https://connect.mozilla.org/t5/ideas/idb-p/ideas/label-name/thunderbird%20android" title="" target="_blank">Mozilla Connect - Ideas</a></li>
<li>Once a feature is accepted and work is planned, maintainers will create the corresponding GitHub issue(s).</li>
</ul>
<h3 id="reporting-bugs"><a class="header" href="#reporting-bugs">Reporting Bugs</a></h3>
<p>If you’ve found a bug that’s not yet tracked:</p>
<ul>
<li>Open a <a href="https://github.com/thunderbird/thunderbird-android/issues/new/choose" title="" target="_blank">new GitHub issue</a></li>
<li>Use the bug template and provide detailed reproduction steps.</li>
</ul>
<h3 id="discussing-your-plan"><a class="header" href="#discussing-your-plan">Discussing Your Plan</a></h3>
<p>Before coding:</p>
<ol>
<li>Comment on the GitHub issue you want to work on.</li>
<li>Explain your intended approach.</li>
<li>Wait for maintainer feedback to ensure alignment and avoid duplicate work.</li>
</ol>
<h2 id="-forking-and-cloning"><a class="header" href="#-forking-and-cloning">🍴 Forking and Cloning</a></h2>
<p>To contribute code, you’ll need to work with your own fork of the repository:</p>
<ol>
<li>Go to the <a href="https://github.com/thunderbird/thunderbird-android" title="" target="_blank">Thunderbird for Android repository</a></li>
<li>Click the <strong>Fork</strong> button in the top-right corner</li>
<li>Select your GitHub account as the destination for the fork</li>
<li>Wait for GitHub to create your fork</li>
</ol>
<h2 id="-cloning-your-fork"><a class="header" href="#-cloning-your-fork">📥 Cloning Your Fork</a></h2>
<p>After forking, clone your fork to your local machine:</p>
<pre><code class="language-bash"># Clone your fork
git clone https://github.com/YOUR-USERNAME/thunderbird-android.git

# Navigate to the project directory
cd thunderbird-android

# Add the upstream repository as a remote to your fork
git remote add upstream https://github.com/thunderbird/thunderbird-android.git
</code></pre>
<p>Replace <code>YOUR-USERNAME</code> with your GitHub username.</p>
<h2 id="-creating-a-branch"><a class="header" href="#-creating-a-branch">🌿 Creating a Branch</a></h2>
<p>Always create a new branch from the latest <code>main</code>:</p>
<pre><code class="language-bash"># Ensure you're on the main branch
git checkout main

# Pull latest changes
git pull upstream main

# Create a new branch
git checkout -b fix-issue-123
</code></pre>
<p>Use a descriptive branch name that reflects the issue you’re addressing, such as:</p>
<ul>
<li><code>fix-issue-123</code></li>
<li><code>add-feature-xyz</code></li>
<li><code>improve-performance-abc</code></li>
</ul>
<h2 id="-making-changes"><a class="header" href="#-making-changes">💻 Making Changes</a></h2>
<p>When making changes:</p>
<ol>
<li>Follow the <a href="contributing/code-quality-guide.html">Code Quality Guide</a> for styling and tooling.</li>
<li>Keep your changes focused on the specific issue.</li>
<li>Write clear, concise, and well-documented code</li>
<li>Document non-obvious logic and update docs if needed.</li>
<li>Add or update tests (see <a href="contributing/testing-guide.html">Testing Guide</a>)</li>
</ol>
<h3 id="-commit-best-practices"><a class="header" href="#-commit-best-practices">✍️ Commit Best Practices</a></h3>
<ul>
<li>Write clear commit messages following the <a href="contributing/git-commit-guide.html">Git Commit Guide</a></li>
<li>Use <a href="contributing/git-commit-guide.html#-commit-message-format">Conventional Commits</a></li>
<li>Make small, focused commits that address a single concern</li>
<li>Reference the issue number in your commit message (e.g., “Fix #123: Add validation for email input”)</li>
</ul>
<p>Example of a good commit message:</p>
<pre><code class="language-git">fix(email): add validation for email input

Add regex pattern for email validation.
Display error message for invalid emails.
Add unit tests for validation logic.
Fixes #123
</code></pre>
<h2 id="-testing-and-checks"><a class="header" href="#-testing-and-checks">🧪 Testing and Checks</a></h2>
<p>Before submitting your changes:</p>
<ol>
<li>
<p>Run the existing tests to ensure you haven’t broken anything:</p>
<pre><code class="language-bash">./gradlew test
</code></pre>
</li>
<li>
<p>Write new tests for your changes:</p>
<ul>
<li>Unit tests for business logic</li>
<li>Integration tests for component interactions</li>
<li>UI tests for user interface changes</li>
</ul>
</li>
<li>
<p>Ensure all tests pass:</p>
<pre><code class="language-bash">./gradlew check
</code></pre>
</li>
<li>
<p>Run lint checks to ensure code quality:</p>
<pre><code class="language-bash">./gradlew lint
</code></pre>
</li>
</ol>
<p>For more detailed information about testing, see the <a href="contributing/testing-guide.html">Testing Guide</a>.</p>
<h2 id="-pushing-changes"><a class="header" href="#-pushing-changes">📤 Pushing Changes</a></h2>
<p>Once your changes are ready:</p>
<pre><code class="language-bash"># Push your branch to your fork
git push origin your-branch-name
</code></pre>
<p>If you rebased:</p>
<pre><code class="language-bash">git push --force-with-lease origin your-branch-name
</code></pre>
<h2 id="-submitting-a-pull-request"><a class="header" href="#-submitting-a-pull-request">📬 Submitting a Pull Request</a></h2>
<p>To submit your changes for review:</p>
<ol>
<li>Go to the <a href="https://github.com/thunderbird/thunderbird-android" title="" target="_blank">Thunderbird for Android repository</a></li>
<li>Click <strong>Pull requests</strong> -&gt; <strong>New pull request</strong> -&gt; <strong>compare across forks</strong></li>
<li>Set:
<ul>
<li>Base repo: <code>thunderbird/thunderbird-android</code></li>
<li>Base branch: <code>main</code></li>
<li>Head repo: your fork &amp; branch</li>
</ul>
</li>
<li>Select your fork and branch as the source</li>
<li>Click <strong>Create pull request</strong></li>
</ol>
<h3 id="pull-request-description"><a class="header" href="#pull-request-description">Pull Request Description</a></h3>
<p>Write a clear and concise description for your pull request:</p>
<ol>
<li>Reference the issue number (e.g., “Fixes #123”, “Resolves #456”)</li>
<li>Summarize the changes you made</li>
<li>Explain your approach and any important decisions</li>
<li>Include screenshots or videos for UI changes</li>
<li>Mention any related issues or pull requests</li>
</ol>
<p>Example:</p>
<pre><code class="language-markdown">## Title
fix(email): add validation for email input

## Description
Fixes #123

This PR adds email validation to the login form. It:
- Implements regex-based validation for email inputs
- Shows error messages for invalid emails
- Adds unit tests for the validation logic

## Screenshots
[Screenshot of error message]

## Testing
1. Enter an invalid email (e.g., "test@")
2. Verify that an error message appears
3. Enter a valid email
4. Verify that the error message disappears
</code></pre>
<h2 id="-code-review-process"><a class="header" href="#-code-review-process">👀 Code Review Process</a></h2>
<p>After submitting your pull request:</p>
<ol>
<li>Automated checks will run to verify your changes once approved by a maintainer.</li>
<li>Maintainers and other contributors will review your code.</li>
<li>They may suggest changes.</li>
<li>Respond to feedback and make necessary changes.</li>
<li>Push additional commits to your branch as needed.</li>
<li>Once approved, a maintainer will merge your pull request.</li>
</ol>
<p>👉 For expectations and etiquette, see <a href="contributing/code-review-guide.html">Code Review Guide</a>.</p>
<h2 id="-keeping-your-fork-updated"><a class="header" href="#-keeping-your-fork-updated">🔄 Keeping Your Fork Updated</a></h2>
<p>To keep your fork in sync with the main repository:</p>
<pre><code class="language-bash"># Fetch changes from the upstream repository
git fetch upstream

# Checkout your local main branch
git checkout main

# Merge changes from upstream/main into your local main branch
git merge upstream/main

# Push the updated main branch to your fork
git push origin main
</code></pre>
<p>If you’re working on a branch and need to update it with the latest changes from main:</p>
<pre><code class="language-bash"># Checkout your branch
git checkout your-branch-name

# Rebase your branch on the latest upstream main
git rebase upstream/main

# Force push the updated branch to your fork
git push --force-with-lease origin your-branch-name
</code></pre>
<h2 id="-iterative-development"><a class="header" href="#-iterative-development">🔁 Iterative Development</a></h2>
<p>Most pull requests go through several rounds of feedback and changes:</p>
<ol>
<li>Submit initial implementation</li>
<li>Receive feedback</li>
<li>Make changes</li>
<li>Request re-review</li>
<li>Repeat until approved</li>
</ol>
<h2 id="-after-your-pull-request-is-merged"><a class="header" href="#-after-your-pull-request-is-merged">📝 After Your Pull Request is Merged</a></h2>
<p>After your pull request is merged:</p>
<ol>
<li>
<p>Delete your branch on GitHub.</p>
</li>
<li>
<p>Update your local repository:</p>
<pre><code class="language-bash">git checkout main
git pull upstream main
git push origin main
</code></pre>
</li>
<li>
<p>Delete your local branch:</p>
<pre><code class="language-bash">git branch -d your-branch-name
</code></pre>
</li>
<li>
<p>Celebrate your contribution! 🎉</p>
</li>
</ol>
<h2 id="-common-issues-and-solutions"><a class="header" href="#-common-issues-and-solutions">🚫 Common Issues and Solutions</a></h2>
<h3 id="merge-conflicts"><a class="header" href="#merge-conflicts">Merge Conflicts</a></h3>
<p>If your branch has conflicts with the main branch:</p>
<pre><code class="language-bash">git fetch upstream
git checkout fix-issue-123
git rebase upstream/main
# resolve conflicts, then
git add .
git rebase --continue
git push --force-with-lease origin fix-issue-123
</code></pre>
<h3 id="failed-ci-checks"><a class="header" href="#failed-ci-checks">Failed CI Checks</a></h3>
<p>If continuous integration checks fail:</p>
<ol>
<li>Check the CI logs to understand the failure.</li>
<li>Fix the issues locally.</li>
<li>Commit and push your changes.</li>
<li>CI checks will automatically run again.</li>
</ol>
<h2 id="-contribution-etiquette"><a class="header" href="#-contribution-etiquette">🙏 Contribution Etiquette</a></h2>
<ul>
<li>Be respectful and professional in all interactions.</li>
<li>Follow the <a href="https://www.mozilla.org/en-US/about/governance/policies/participation/" title="" target="_blank">Mozilla Community Participation Guidelines</a></li>
<li>Be patient with the review process.</li>
<li>Help review other contributors’ pull requests.</li>
<li>Ask questions if you’re unsure about something.</li>
<li>Thank others for their help and feedback.</li>
</ul>
<p>👉 See <a href="contributing/code-review-guide.html">Code review guide</a> for more details.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-development-guide"><a class="header" href="#-development-guide">🏗️ Development Guide</a></h1>
<p>This document summarizes project-specific conventions for developers.</p>
<p>For full details, see:</p>
<ul>
<li><a href="contributing/../architecture/README.html">Architecture</a> - modules, layering, offline-first</li>
<li><a href="contributing/code-quality-guide.html">Code Quality Guide</a> - style, static analysis, security, performance</li>
<li><a href="contributing/testing-guide.html">Testing Guide</a> - test strategy and frameworks</li>
<li><a href="contributing/code-review-guide.html">Code Review Guide</a> – review expectations</li>
</ul>
<h2 id="-modules"><a class="header" href="#-modules">📦 Modules</a></h2>
<ul>
<li>Follow <a href="contributing/../architecture/module-organization.html">Module Organization</a> and <a href="contributing/../architecture/module-structure.html">Module Structure</a></li>
<li>Place new code in <code>feature:*</code>, <code>core:*</code>, or <code>library:*</code> modules</li>
<li><strong>Do not</strong> add new code in <code>legacy:*</code> modules</li>
<li>Keep <strong>API/impl separation</strong> in all modules</li>
</ul>
<h2 id="-architecture"><a class="header" href="#-architecture">🏛️ Architecture</a></h2>
<ul>
<li>Follow <a href="contributing/../architecture/README.html">Architecture</a></li>
<li>Dependencies must flow in <strong>one direction only</strong></li>
<li>UI built with <strong>Jetpack Compose</strong> + <strong>MVI pattern</strong></li>
<li>Domain logic implemented in <strong>Use Cases</strong></li>
<li>Data handled via <strong>Repository pattern</strong></li>
</ul>
<h2 id="-dependency-injection"><a class="header" href="#-dependency-injection">⚙️ Dependency Injection</a></h2>
<ul>
<li>Use <a href="https://insert-koin.io/" title="" target="_blank">Koin</a> with constructor injection</li>
<li>Avoid static singletons and service locators</li>
</ul>
<h2 id="-testing"><a class="header" href="#-testing">🧪 Testing</a></h2>
<ul>
<li>Follow the <a href="contributing/testing-guide.html">Testing Guide</a> for frameworks and strategy.</li>
<li>Project conventions:
<ul>
<li>Name the object under test <code>testSubject</code></li>
<li>Prefer <strong>fakes</strong> over mocks when possible</li>
<li>Use descriptive test names and AAA (Arrange–Act–Assert) pattern</li>
</ul>
</li>
</ul>
<h2 id="-code-style"><a class="header" href="#-code-style">🎨 Code Style</a></h2>
<ul>
<li>Follow the <a href="contributing/code-quality-guide.html">Code Quality Guide</a> for formatting and tooling.</li>
<li>Code style quick reminders
<ul>
<li>Prefer immutability (<code>val</code> over <code>var</code>)</li>
<li>Use extension functions for utilities</li>
<li>Keep functions small and focused</li>
</ul>
</li>
</ul>
<h2 id="dos-and-donts"><a class="header" href="#dos-and-donts">Do’s and Don’ts</a></h2>
<ul>
<li>✅ Write modular, testable code with clear boundaries</li>
<li>✅ Document non-obvious logic and decisions (link ADRs when appropriate)</li>
<li>✅ Keep module boundaries clean</li>
<li>✅ Add or update tests for new/changed code</li>
<li>✅ Run Spotless, Detekt, and Lint checks locally before committing</li>
<li>❌ Don’t commit new code to <code>legacy:*</code> modules, unless strictly necessary</li>
<li>❌ Don’t bypass the architecture and layering (e.g., UI calling data sources directly)</li>
<li>❌ Don’t introduce circular dependencies between modules</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-code-quality-guide"><a class="header" href="#-code-quality-guide">🔍 Code Quality Guide</a></h1>
<p>This document provides comprehensive guidelines for maintaining high code quality in the Thunderbird for Android
project. Following these guidelines ensures that the codebase remains:</p>
<ul>
<li><strong>Maintainable</strong>: Easy to understand, modify, and extend</li>
<li><strong>Reliable</strong>: Functions correctly and consistently</li>
<li><strong>Efficient</strong>: Uses resources effectively</li>
<li><strong>Secure</strong>: Protects user data and privacy</li>
<li><strong>Testable</strong>: Is verified through automated tests</li>
</ul>
<h2 id="-static-analysis-tools"><a class="header" href="#-static-analysis-tools">🛠️ Static Analysis Tools</a></h2>
<p>We use static analysis tools to automatically detect code quality issues and enforce standards.</p>
<h3 id="android-lint"><a class="header" href="#android-lint">Android Lint</a></h3>
<p>Android Lint checks for potential bugs, optimization opportunities, and Android-specific issues:</p>
<pre><code class="language-bash"># Run lint checks for all modules
./gradlew lint

# Run lint checks for a specific module
./gradlew :module-name:lint
</code></pre>
<p>Common issues detected:</p>
<ul>
<li>Unused resources</li>
<li>Accessibility issues</li>
<li>Performance optimizations</li>
<li>Internationalization problems</li>
<li>Security vulnerabilities</li>
</ul>
<h4 id="configuration"><a class="header" href="#configuration">Configuration</a></h4>
<p>The project’s lint configuration is in <code>config/lint/lint.xml</code>. You can customize lint rules for specific modules by
adding a <code>lint</code> block to the module’s <code>build.gradle.kts</code> file:</p>
<pre><code class="language-kotlin">android {
    lint {
        abortOnError = false
        warningsAsErrors = false
        
        // Ignore specific issues
        disable += listOf("InvalidPackage", "MissingTranslation")
        // Enable specific issues
        enable += listOf("RtlHardcoded", "RtlCompat", "RtlEnabled")
    }
}
</code></pre>
<h3 id="detekt"><a class="header" href="#detekt">Detekt</a></h3>
<p><a href="https://detekt.dev/" title="" target="_blank">Detekt</a> analyzes Kotlin code for code smells, complexity issues, and potential bugs:</p>
<pre><code class="language-bash"># Run detekt for all modules
./gradlew detekt

# Run detekt for a specific module
./gradlew :module-name:detekt
</code></pre>
<p>Detekt checks for:</p>
<ul>
<li>Code complexity (cyclomatic complexity, long methods, etc.)</li>
<li>Potential bugs (empty blocks, unreachable code, etc.)</li>
<li>Code style issues (naming conventions, formatting, etc.)</li>
<li>Performance issues (inefficient collection operations, etc.)</li>
</ul>
<h4 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h4>
<p>The project’s Detekt configuration is defined in the <code>config/detekt/detekt.yml</code> file. This file specifies which rules
to apply and their severity levels. The detekt plugin is configured in the
<code>build-plugin/src/main/kotlin/thunderbird.quality.detekt.gradle.kts</code> file.</p>
<h3 id="spotless"><a class="header" href="#spotless">Spotless</a></h3>
<p><a href="https://github.com/diffplug/spotless" title="" target="_blank">Spotless</a> ensures consistent code formatting across the codebase:</p>
<pre><code class="language-bash"># Check if code formatting meets standards
./gradlew spotlessCheck

# Apply automatic formatting fixes
./gradlew spotlessApply
</code></pre>
<p>Spotless enforces:</p>
<ul>
<li>Consistent indentation</li>
<li>Line endings</li>
<li>Import ordering</li>
<li>Whitespace usage</li>
</ul>
<h4 id="configuration-2"><a class="header" href="#configuration-2">Configuration</a></h4>
<p>The project’s Spotless plugin is configured in the
<code>build-plugin/src/main/kotlin/thunderbird.quality.spotless.gradle.kts</code> file. We use ktlint for Kotlin formatting.
The rules are defined in the <code>.editorconfig</code> file and as editorconfig overrides in the Spotless configuration.</p>
<pre><code class="language-kotlin">configure&lt;SpotlessExtension&gt; {
    kotlin {
        target(
            "src/*/java/*.kt",
            "src/*/kotlin/*.kt",
            "src/*/java/**/*.kt",
            "src/*/kotlin/**/*.kt",
        )

        ktlint(libs.versions.ktlint.get())
            .setEditorConfigPath("${project.rootProject.projectDir}/.editorconfig")
            .editorConfigOverride(
                mapOf(
                    "ktlint_code_style" to "intellij_idea",
                    "ktlint_standard_function-signature" to "disabled",
                ),
            )
    }
}
</code></pre>
<p>For Markdown we use Flexmark and no further configuration is needed.</p>
<h2 id="-code-style-guidelines"><a class="header" href="#-code-style-guidelines">📝 Code Style Guidelines</a></h2>
<h3 id="kotlin-style-guide"><a class="header" href="#kotlin-style-guide">Kotlin Style Guide</a></h3>
<p>The project follows the <a href="https://kotlinlang.org/docs/coding-conventions.html" title="" target="_blank">Kotlin style guide</a> with some project-specific adaptations:</p>
<ol>
<li><strong>Naming Conventions</strong>:
<ul>
<li>Use <code>camelCase</code> for variables, functions, and methods</li>
<li>Use <code>PascalCase</code> for classes, interfaces, enums and type parameters</li>
<li>Use <code>UPPER_SNAKE_CASE</code> for constants and enum constants</li>
<li>Prefix interface implementations with <code>Default</code> or a specific name, e.g.:</li>
<li><code>DefaultEmailRepository</code> implements <code>EmailRepository</code></li>
<li><code>InMemoryCache</code> implements <code>Cache</code></li>
</ul>
</li>
<li><strong>Formatting</strong>:
<ul>
<li>Use 4 spaces for indentation</li>
<li>Limit line length to 120 characters</li>
<li>Use <code>./gradlew spotlessApply</code> to enforce formatting automatically</li>
</ul>
</li>
<li><strong>Comments</strong>:
<ul>
<li>Use KDoc comments for public APIs</li>
<li>Include a summary, parameter descriptions, and return value description</li>
<li>Document exceptions that might be thrown</li>
</ul>
</li>
<li><strong>File Organization</strong>:
<ul>
<li>One class per file (with exceptions for related small classes)</li>
<li>Package structure should reflect the module structure</li>
<li>Imports should be organized alphabetically</li>
</ul>
</li>
</ol>
<h3 id="kotlin-best-practices"><a class="header" href="#kotlin-best-practices">Kotlin Best Practices</a></h3>
<ul>
<li>Prefer <code>val</code> (immutable) over <code>var</code> when possible</li>
<li>Use null-safety (<code>?.</code>, <code>?:</code>, <code>requireNotNull</code>, <code>checkNotNull</code>)</li>
<li>Use extension functions to enhance existing classes</li>
<li>Leverage Kotlin’s functional programming features (<code>map</code>, <code>filter</code>, etc.) for cleaner code</li>
<li>Use <code>data classes</code> for model objects</li>
<li>Implement ‘sealed classes’ for representing finite sets of options</li>
<li>Use <code>coroutines</code> for asynchronous operations</li>
<li>Use <code>flow</code> for reactive programming</li>
</ul>
<h3 id="android-best-practices"><a class="header" href="#android-best-practices">Android Best Practices</a></h3>
<ul>
<li>Follow the <a href="https://developer.android.com/topic/architecture" title="" target="_blank">Android app architecture guidelines</a></li>
<li>Use Jetpack libraries when appropriate</li>
<li>Manage lifecycle properly (<code>ViewModel</code>, <code>LifecycleOwner</code>)</li>
<li>Handle configuration changes (rotation, locale, dark mode)</li>
<li>Optimize for different screen sizes and orientations</li>
<li>Follow Material 3 design guidelines</li>
</ul>
<h2 id="-security-practices"><a class="header" href="#-security-practices">🔒 Security Practices</a></h2>
<p>Security is critical. Always:</p>
<ul>
<li>Validate all input</li>
<li>Avoid logging sensitive data</li>
<li>Use HTTPS/TLS for all network traffic</li>
<li>Store secrets securely (e.g., Android Keystore, EncryptedSharedPreferences)</li>
<li>Apply least privilege to permissions</li>
<li>Follow Android’s <a href="https://developer.android.com/topic/security/best-practices" title="" target="_blank">security best practices</a></li>
</ul>
<h2 id="-testing-1"><a class="header" href="#-testing-1">🧪 Testing</a></h2>
<p>Comprehensive testing is a critical aspect of code quality.</p>
<p>Key expectations:</p>
<ul>
<li>Write tests for new/changed code</li>
<li>Use meaningful, deterministic tests</li>
<li>Follow Arrange–Act–Assert pattern</li>
<li>Maintain high coverage</li>
</ul>
<p>👉 See <a href="contributing/testing-guide.html">Testing Guide</a> for frameworks, patterns, and CI coverage rules.</p>
<h2 id="-continuous-integration"><a class="header" href="#-continuous-integration">🔄 Continuous Integration</a></h2>
<p>The project uses GitHub Actions for continuous integration. Each pull request triggers automated checks for:</p>
<ul>
<li>Build success</li>
<li>Test execution</li>
<li>Lint issues</li>
<li>Detekt issues</li>
<li>Spotless formatting</li>
</ul>
<p>The CI configuration is defined in the <code>.github/workflows</code> directory. The main workflow file is <code>android.yml</code>, which
defines the CI pipeline for Android builds.</p>
<p>👉 See <a href="contributing/code-review-guide.html">Code Review Guide</a> for PR expectations and etiquette.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-code-review-guide"><a class="header" href="#-code-review-guide">👁️ Code Review Guide</a></h1>
<p>This guide outlines best practices for creating and reviewing pull requests (PRs) in the Thunderbird for Android
project. It is intended to help both authors and reviewers ensure high-quality contributions.</p>
<h3 id="-quick-pr-checklist-for-authors"><a class="header" href="#-quick-pr-checklist-for-authors">✅ Quick PR checklist (for authors)</a></h3>
<p>Paste this into your PR to self-check:</p>
<pre><code class="language-markdown">- [ ] Focused scope (&lt; ~800 LOC); clear description and rationale
- [ ] UI changes: screenshots/videos; accessibility (TalkBack, contrast, touch targets)
- [ ] Tests added/updated; CI green (see [Testing Guide](testing-guide.md))
- [ ] Architecture: business logic outside UI; module API/impl respected; DI via constructor/Koin
- [ ] Performance: no main-thread blocking; Compose recompositions reasonable; hot paths allocation-lean
- [ ] Security/privacy: inputs validated; no PII in logs; TLS; secure storage; permission changes documented
- [ ] i18n: No new localizable strings unless justified; translations policy followed
- [ ] Release train: feature flags set; uplift label + risk/impact (if applicable)
- [ ] Docs/CHANGELOG updated; issues linked (Fixes #123); PR title/commits clear
</code></pre>
<h2 id="-for-code-authors-selfreview-checklist"><a class="header" href="#-for-code-authors-selfreview-checklist">🧑‍💻 For Code Authors (self‑review checklist)</a></h2>
<ol>
<li><strong>Scope and clarity</strong>
<ul>
<li>Keep the PR focused on a single concern; split large or mixed changes.</li>
<li>Keep PRs small (aim for &lt;~ 800 lines of code (LOC))</li>
<li>Provide a clear description: problem, approach, rationale, alternatives considered.</li>
<li>For UI changes: include screenshots/videos for UI changes and note any UX impacts.</li>
<li>Use Draft PRs for early feedback</li>
</ul>
</li>
<li><strong>Tests</strong>
<ul>
<li>Include tests matching the change type (unit/integration/UI).</li>
<li>Use AAA pattern and use assertK. Prefer fakes over mocks.</li>
<li>Name tests descriptively; cover edge cases and error conditions.</li>
<li>See the <a href="contributing/testing-guide.html">Testing Guide</a> for frameworks and best practises.</li>
</ul>
</li>
<li><strong>Architecture &amp; module boundaries</strong>
<ul>
<li>Follow modular rules: API vs implementation separation; no leaking implementation across module boundaries.</li>
<li>Only depend on <code>:feature:foo:api</code> externally; <code>:feature:foo:impl</code> is internal.</li>
<li>Respect MVI/Compose patterns in the UI layer; keep business logic out of UI implementation.</li>
<li>Prefer constructor injection with Koin; keep constructors simple and dependencies explicit.</li>
</ul>
</li>
<li><strong>Code quality &amp; style</strong>
<ul>
<li>Keep functions small, clear naming, avoid duplication.</li>
<li>Add KDoc for public API.</li>
<li>Run Spotless, Detekt and Lint locally.</li>
<li>Follow the <a href="contributing/code-quality-guide.html">Code Quality Guide</a></li>
</ul>
</li>
<li><strong>Performance &amp; threading</strong>
<ul>
<li>Use coroutines with appropriate dispatchers; avoid blocking the main thread.</li>
<li>Watch allocations in hot paths, avoid unnecessary recompositions in Compose.</li>
<li>For critical changes, check baseline profiling or startup metrics.</li>
</ul>
</li>
<li><strong>Security &amp; privacy</strong>
<ul>
<li>Validate inputs, avoid logging Personally Identifiable Information (PII).</li>
<li>Use TLS and safe storage APIs.</li>
<li>Review permission use and document your rationale to them in the PR description.</li>
</ul>
</li>
<li><strong>Accessibility</strong>
<ul>
<li>Provide <code>contentDescription</code> and TalkBack support.</li>
<li>Ensure sufficient contrast, touch targets and dynamic text sizing (up to 200%).</li>
</ul>
</li>
<li><strong>i18n</strong>
<ul>
<li>Follow strings policy: don’t modify translations here; avoid late string changes; see <a href="contributing/managing-strings.html">managing strings</a>.</li>
<li>No string concatenation with localized text; use placeholders.</li>
</ul>
</li>
<li><strong>Feature flags &amp; release train awareness</strong>
<ul>
<li>Gate incomplete features behind flags aligned with branch rules <a href="contributing/../ci/RELEASE.html#feature-flags">Release - Feature Flags</a>.</li>
<li>For uplifts: add label and risk/impact notes <a href="contributing/../ci/RELEASE.html#branch-uplifts">Release - Branch uplifts</a>.</li>
</ul>
</li>
<li><strong>Documentation &amp; metadata</strong>
<ul>
<li>Update relevant docs, CHANGELOG entries and add context as needed.</li>
<li>Link relevant issues using GitHub keywords so they auto-close on merge (<code>Fixes #123</code>, <code>Resolves #456</code>).</li>
<li>For commit format, see the <a href="contributing/git-commit-guide.html">Git Commit Guide</a></li>
</ul>
</li>
<li><strong>CI status</strong>
<ul>
<li>Ensure CI is green</li>
<li>Fix issues or request re-run if failures are unrelated/flaky.</li>
</ul>
</li>
</ol>
<h2 id="-for-code-reviewers-what-to-look-for"><a class="header" href="#-for-code-reviewers-what-to-look-for">👀 For Code Reviewers (what to look for)</a></h2>
<ol>
<li><strong>Correctness &amp; requirements</strong>
<ul>
<li>Does the change solve the stated problem? Any edge cases missed? Are invariants upheld?</li>
</ul>
</li>
<li><strong>Architecture &amp; boundaries</strong>
<ul>
<li>Adheres to module API/impl separation and project architecture (UI: Compose/MVI, Domain, Data).</li>
<li>No cross‑module leaks; dependencies flow in the right direction.</li>
</ul>
</li>
<li><strong>Readability &amp; maintainability</strong>
<ul>
<li>Code is easy to follow; good names; small functions; comments where necessary; public APIs documented.</li>
</ul>
</li>
<li><strong>Test quality</strong>
<ul>
<li>Adequate tests exist and are meaningful.</li>
<li>Negative/error paths covered.</li>
<li>Tests are deterministic and prefer fakes.</li>
</ul>
</li>
<li><strong>Performance</strong>
<ul>
<li>No obvious inefficiencies; avoids allocations on hot paths.</li>
<li>Background work is appropriate.</li>
<li>Compose recomposition reasonable.</li>
</ul>
</li>
<li><strong>Security, privacy, and permissions</strong>
<ul>
<li>No new vulnerabilities; safe defaults; least privilege permissions.</li>
<li>Secrets not committed; logs avoid personal identifiable information.</li>
<li>Permission rationale provided if applicable.</li>
</ul>
</li>
<li><strong>Accessibility &amp; i18n</strong>
<ul>
<li>Accessible UI; strings externalized; no hard‑coded locales.</li>
<li>Respects translations policy, only english source files.</li>
</ul>
</li>
<li><strong>Consistency &amp; style</strong>
<ul>
<li>Matches existing patterns.</li>
<li>Formatting and static analysis clean (Spotless/Detekt/Lint).</li>
</ul>
</li>
<li><strong>Release train considerations</strong>
<ul>
<li>Feature flags set correctly for target branch</li>
<li>Consider if an uplift is necessary.</li>
</ul>
</li>
<li><strong>CI status</strong>
<ul>
<li>CI is green -&gt; good to merge.</li>
<li>If failures are unrelated or flaky, do a re-run OR leave a note.</li>
<li>Don’t merge with failing checks!</li>
</ul>
</li>
</ol>
<h2 id="-review-etiquette"><a class="header" href="#-review-etiquette">🤝 Review etiquette</a></h2>
<ul>
<li>Be kind, specific, and actionable.</li>
<li>Prefer questions over directives. Explain trade‑offs.</li>
<li>Use severity tags if appropriate to weight your comments:
<ul>
<li>Nit: trivial style/readability; non-blocking.</li>
<li>Suggestion: improves design/maintainability; author’s call.</li>
<li>Blocking: must be addressed for correctness, safety, or architecture.</li>
</ul>
</li>
<li>Avoid scope creep and request follow‑ups for non‑critical issues.</li>
<li>Acknowledge good practices and improvements.</li>
<li>When disagreeing, provide reasoning and seek consensus.</li>
<li>Use GitHub suggestions for trivial fixes where possible.</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="git-commit-guide"><a class="header" href="#git-commit-guide">Git Commit Guide</a></h1>
<p>Use <a href="https://www.conventionalcommits.org/" title="" target="_blank">Conventional Commits</a> to write consistent and meaningful commit messages.
This makes your work easier to review, track, and maintain for everyone involved in the project.</p>
<h2 id="-commit-message-format"><a class="header" href="#-commit-message-format">✍️ Commit Message Format</a></h2>
<pre><code class="language-git">&lt;type&gt;(&lt;scope&gt;): &lt;description&gt;

&lt;body&gt;

&lt;footer(s)&gt;
</code></pre>
<p>Components:</p>
<ul>
<li><code>&lt;type&gt;</code>: The <a href="contributing/git-commit-guide.html#-commit-types">type of change</a> being made (e.g., feat, fix, docs).</li>
<li><code>&lt;scope&gt;</code> <strong>(optional)</strong>: The <a href="contributing/git-commit-guide.html#optional-scope">scope</a> indicates the area of the codebase affected by the change (e.g., auth, ui).</li>
<li><code>&lt;description&gt;</code>: Short description of the change (50 characters or less)</li>
<li><code>&lt;body&gt;</code> <strong>(optional)</strong>: Explain what changed and why, include context if helpful.</li>
<li><code>&lt;footer(s)&gt;</code> <strong>(optional)</strong>: Include issue references, breaking changes, etc.</li>
</ul>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<p>Basic:</p>
<pre><code class="language-git">feat: add QR code scanner
</code></pre>
<p>With scope:</p>
<pre><code class="language-git">feat(auth): add login functionality
</code></pre>
<p>With body and issue reference:</p>
<pre><code class="language-git">fix(api): handle null response from login endpoint

Checks for missing tokens to prevent app crash during login.

Fixes #123
</code></pre>
<h3 id="-commit-types"><a class="header" href="#-commit-types">🏷️ Commit Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Use for…</th><th>Example</th></tr></thead><tbody>
<tr><td><code>feat</code></td><td>New features</td><td><code>feat(camera): add zoom support</code></td></tr>
<tr><td><code>fix</code></td><td>Bug fixes</td><td><code>fix(auth): handle empty username crash</code></td></tr>
<tr><td><code>docs</code></td><td>Documentation only</td><td><code>docs(readme): update setup instructions</code></td></tr>
<tr><td><code>style</code></td><td>Code style (no logic changes)</td><td><code>style: reformat settings screen</code></td></tr>
<tr><td><code>refactor</code></td><td>Code changes (no features/fixes)</td><td><code>refactor(nav): simplify stack setup</code></td></tr>
<tr><td><code>test</code></td><td>Adding/editing tests</td><td><code>test(api): add unit test for login</code></td></tr>
<tr><td><code>chore</code></td><td>Tooling, CI, dependencies</td><td><code>chore(ci): update GitHub Actions config</code></td></tr>
<tr><td><code>revert</code></td><td>Reverting previous commits</td><td><code>revert: remove feature flag</code></td></tr>
</tbody></table>
</div>
<h3 id="optional-scope"><a class="header" href="#optional-scope">📍Optional Scope</a></h3>
<p>The <strong>scope</strong> is optional but recommended for clarity, especially for large changes or or when multiple areas of the
codebase are involved.</p>
<div class="table-wrapper"><table><thead><tr><th>Scope</th><th>Use for…</th><th>Example</th></tr></thead><tbody>
<tr><td><code>auth</code></td><td>Authentication</td><td><code>feat(auth): add login functionality</code></td></tr>
<tr><td><code>settings</code></td><td>User settings</td><td><code>feat(settings): add dark mode toggle</code></td></tr>
<tr><td><code>build</code></td><td>Build system</td><td><code>fix(build): improve build performance</code></td></tr>
<tr><td><code>ui</code></td><td>UI/theme</td><td><code>refactor(ui): split theme into modules</code></td></tr>
<tr><td><code>deps</code></td><td>Dependencies</td><td><code>chore(deps): bump Kotlin to 2.0.0</code></td></tr>
</tbody></table>
</div>
<h2 id="-best-practices"><a class="header" href="#-best-practices">🧠 Best Practices</a></h2>
<h3 id="1-one-commit-one-purpose"><a class="header" href="#1-one-commit-one-purpose">1. One Commit, One Purpose</a></h3>
<ul>
<li>✅ Each commit should represent a single logical change or addition to the codebase.</li>
<li>❌ Don’t mix unrelated changes together (e.g., fixing a bug and updating docs, or changing a style and )
adding a feature).</li>
</ul>
<h3 id="2-keep-it-manageable"><a class="header" href="#2-keep-it-manageable">2. Keep It Manageable</a></h3>
<ul>
<li>✅ Break up large changes into smaller, more manageable commits.</li>
<li>✅ If a commit changes more than 200 lines of code, consider breaking it up.</li>
<li>❌ Avoid massive, hard-to-review commits.</li>
</ul>
<h3 id="3-keep-it-working"><a class="header" href="#3-keep-it-working">3. Keep It Working</a></h3>
<ul>
<li>✅ Each commit should leave the codebase in a buildable and testable state.</li>
<li>❌ Never commit broken code or failing tests.</li>
</ul>
<h3 id="4-think-about-reviewers-and-future-you"><a class="header" href="#4-think-about-reviewers-and-future-you">4. Think About Reviewers (and Future You)</a></h3>
<ul>
<li>✅ Write messages for your teammates and future self, assuming they have no context.</li>
<li>✅ Explain non-obvious changes or decisions in the message body.</li>
<li>✅ Consider the commit as a documentation tool.</li>
<li>❌ Avoid jargon, acronyms, or vague messages like <code>update stuff</code>.</li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<ul>
<li>Use <a href="contributing/git-commit-guide.html#-conventional-commits">Conventional Commits</a> for consistency.</li>
<li>Keep commit messages short, structured, and focused.</li>
<li>Make each commit purposeful and self-contained.</li>
<li>Write commits that make collaboration and future development easier for everyone—including you.</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-testing-guide"><a class="header" href="#-testing-guide">🧪 Testing Guide</a></h1>
<p>This document outlines the testing practices and guidelines for the Thunderbird for Android project.</p>
<p><strong>Key Testing Principles:</strong></p>
<ul>
<li>Follow the Arrange-Act-Assert (AAA) pattern</li>
<li>Use descriptive test names</li>
<li>Prefer fake implementations over mocks</li>
<li>Name the object under test as <code>testSubject</code></li>
<li>Use <a href="https://github.com/willowtreeapps/assertk" title="" target="_blank">AssertK</a> for assertions</li>
</ul>
<h2 id="-test-structure"><a class="header" href="#-test-structure">📐 Test Structure</a></h2>
<h3 id="-arrange-act-assert-pattern"><a class="header" href="#-arrange-act-assert-pattern">🔍 Arrange-Act-Assert Pattern</a></h3>
<p>Tests in this project should follow the Arrange-Act-Assert (AAA) pattern:</p>
<ol>
<li><strong>Arrange</strong>: Set up the test conditions and inputs</li>
<li><strong>Act</strong>: Perform the action being tested</li>
<li><strong>Assert</strong>: Verify the expected outcomes</li>
</ol>
<p>Example:</p>
<pre><code class="language-kotlin">@Test
fun `example test using AAA pattern`() {
    // Arrange
    val input = "test input"
    val expectedOutput = "expected result"
    val testSubject = SystemUnderTest()

    // Act
    val result = testSubject.processInput(input)

    // Assert
    assertThat(result).isEqualTo(expectedOutput)
}
</code></pre>
<p>Use comments to clearly separate these sections in your tests:</p>
<pre><code class="language-kotlin">// Arrange
// Act
// Assert
</code></pre>
<h3 id="-test-naming"><a class="header" href="#-test-naming">📝 Test Naming</a></h3>
<p>Use descriptive test names that clearly indicate what is being tested. For JVM tests, use backticks:</p>
<pre><code class="language-kotlin">@Test
fun `method should return expected result when given valid input`() {
    // Test implementation
}
</code></pre>
<p>Note: Android instrumentation tests do not support backticks in test names. For these tests, use camelCase instead:</p>
<pre><code class="language-kotlin">@Test
fun methodShouldReturnExpectedResultWhenGivenValidInput() {
    // Test implementation
}
</code></pre>
<h2 id="-test-implementation"><a class="header" href="#-test-implementation">💻 Test Implementation</a></h2>
<h3 id="-fakes-over-mocks"><a class="header" href="#-fakes-over-mocks">🎭 Fakes over Mocks</a></h3>
<p>In this project, we prefer using fake implementations over mocks:</p>
<ul>
<li>✅ <strong>Preferred</strong>: Create fake/test implementations of interfaces or classes</li>
<li>❌ <strong>Avoid</strong>: Using mocking libraries to create mock objects</li>
</ul>
<p>Fakes provide better test reliability and are more maintainable in the long run. They also make tests more readable
and less prone to breaking when implementation details change.</p>
<p>Mocks can lead to brittle tests that are tightly coupled to the implementation details, making them harder to maintain.
They also negatively impact test performance, particularly during test initialization. Which can quickly become overwhelming
when an excessive number of tests includes mock implementations.</p>
<p>Example of a fake implementation:</p>
<pre><code class="language-kotlin">// Interface
interface DataRepository {
    fun getData(): List&lt;String&gt;
}

// Fake implementation for testing
class FakeDataRepository(
    // Allow passing initial data during construction
    initialData: List&lt;String&gt; = emptyList()
) : DataRepository {
    // Mutable property to allow changing data between tests
    var dataToReturn = initialData

    override fun getData(): List&lt;String&gt; {
        return dataToReturn
    }
}

// In test
@Test
fun `processor should transform data correctly`() {
    // Arrange
    val fakeRepo = FakeDataRepository(listOf("item1", "item2"))
    val testSubject = DataProcessor(fakeRepo)

    // Act
    val result = testSubject.process()

    // Assert
    assertThat(result).containsExactly("ITEM1", "ITEM2")
}
</code></pre>
<h3 id="-naming-conventions"><a class="header" href="#-naming-conventions">📋 Naming Conventions</a></h3>
<p>When writing tests, use the following naming conventions:</p>
<ul>
<li>Name the object under test as <code>testSubject</code> (not “sut” or other abbreviations)</li>
<li>Name fake implementations with a “Fake” prefix (e.g., <code>FakeDataRepository</code>)</li>
<li>Use descriptive variable names that clearly indicate their purpose</li>
</ul>
<h3 id="-assertions"><a class="header" href="#-assertions">✅ Assertions</a></h3>
<p>Use <a href="https://github.com/willowtreeapps/assertk" title="" target="_blank">AssertK</a> for assertions in tests:</p>
<pre><code class="language-kotlin">@Test
fun `example test`() {
    // Arrange
    val list = listOf("apple", "banana")

    // Act
    val result = list.contains("apple")

    // Assert
    assertThat(result).isTrue()
    assertThat(list).contains("banana")
}
</code></pre>
<p>Note: You’ll need to import the appropriate <a href="https://github.com/willowtreeapps/assertk" title="" target="_blank">AssertK</a> assertions:</p>
<ul>
<li><code>assertk.assertThat</code> for the base assertion function</li>
<li>Functions from the <code>assertk.assertions</code> namespace for specific assertion types (e.g., <code>import assertk.assertions.isEqualTo</code>, <code>import assertk.assertions.contains</code>, <code>import assertk.assertions.isTrue</code>, etc.)</li>
</ul>
<h2 id="-test-types"><a class="header" href="#-test-types">🧮 Test Types</a></h2>
<p>This section describes the different types of tests we use in the project. Each type serves a specific purpose in our testing strategy, and together they help ensure the quality and reliability of our codebase.</p>
<h3 id="-unit-tests"><a class="header" href="#-unit-tests">🔬 Unit Tests</a></h3>
<blockquote>
<p><strong>Unit tests verify that individual components work correctly in isolation.</strong></p>
</blockquote>
<p><strong>What to Test:</strong></p>
<ul>
<li>Single units of functionality</li>
<li>Individual methods or functions</li>
<li>Classes in isolation</li>
<li>Business logic</li>
<li>Edge cases and error handling</li>
</ul>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li>Independent (no external dependencies)</li>
<li>No reliance on external resources</li>
<li>Uses fake implementations for dependencies</li>
</ul>
<p><strong>Frameworks:</strong></p>
<ul>
<li>JUnit 4</li>
<li><a href="https://github.com/willowtreeapps/assertk" title="" target="_blank">AssertK</a> for assertions</li>
<li><a href="https://robolectric.org/" title="" target="_blank">Robolectric</a> (for Android framework classes)</li>
</ul>
<p><strong>Location:</strong></p>
<ul>
<li>Tests should be in the same module as the code being tested</li>
<li>Should be in the <code>src/test</code> directory or <code>src/{platformTarget}Test</code> for Kotlin Multiplatform</li>
<li>Tests should be in the same package as the code being tested</li>
</ul>
<p><strong>Contributor Expectations:</strong></p>
<ul>
<li>✅ All new code should be covered by unit tests</li>
<li>✅ Add tests that reproduce bugs when fixing issues</li>
<li>✅ Follow the AAA pattern (Arrange-Act-Assert)</li>
<li>✅ Use descriptive test names</li>
<li>✅ Prefer fake implementations over mocks</li>
</ul>
<h3 id="-integration-tests"><a class="header" href="#-integration-tests">🔌 Integration Tests</a></h3>
<blockquote>
<p><strong>Integration tests verify that components work correctly together.</strong></p>
</blockquote>
<p><strong>What to Test:</strong></p>
<ul>
<li>Interactions between components</li>
<li>Communication between layers</li>
<li>Data flow across multiple units</li>
<li>Component integration points</li>
</ul>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li>Tests multiple components together</li>
<li>May use real implementations when appropriate</li>
<li>Focuses on component boundaries</li>
</ul>
<p><strong>Frameworks:</strong></p>
<ul>
<li>JUnit 4 (for tests in <code>src/test</code>)</li>
<li><a href="https://github.com/willowtreeapps/assertk" title="" target="_blank">AssertK</a> for assertions</li>
<li><a href="https://robolectric.org/" title="" target="_blank">Robolectric</a> (for Android framework classes in <code>src/test</code>)</li>
<li>Espresso (for UI testing in <code>src/androidTest</code>)</li>
</ul>
<p><strong>Location:</strong></p>
<ul>
<li>Preferably in the <code>src/test</code> or <code>src/commonTest</code>, <code>src/{platformTarget}Test</code> for Kotlin Multiplatform</li>
<li>Only use <code>src/androidTest</code>, when there’s a specific need for Android dependencies</li>
</ul>
<p><strong>Why prefer <code>test</code> over <code>androidTest</code>:</strong></p>
<ul>
<li>JUnit tests run faster (on JVM instead of emulator/device)</li>
<li>Easier to set up and maintain</li>
<li>Better integration with CI/CD pipelines</li>
<li>Lower resource requirements</li>
<li>Faster feedback during development</li>
</ul>
<p><strong>When to use androidTest:</strong></p>
<ul>
<li>When testing functionality that depends on Android-specific APIs that are not available with Robolectric</li>
<li>When tests need to interact with the Android framework directly</li>
</ul>
<p><strong>Contributor Expectations:</strong></p>
<ul>
<li>✅ Add tests for features involving multiple components</li>
<li>✅ Focus on critical paths and user flows</li>
<li>✅ Be mindful of test execution time</li>
<li>✅ Follow the AAA pattern</li>
<li>✅ Use descriptive test names</li>
</ul>
<h3 id="-ui-tests"><a class="header" href="#-ui-tests">📱 UI Tests</a></h3>
<blockquote>
<p><strong>UI tests verify the application from a user’s perspective.</strong></p>
</blockquote>
<p><strong>What to Test:</strong></p>
<ul>
<li>User interface behavior</li>
<li>UI component interactions</li>
<li>Complete user flows</li>
<li>Screen transitions</li>
<li>Input handling and validation</li>
</ul>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li>Tests from user perspective</li>
<li>Verifies visual elements and interactions</li>
<li>Covers end-to-end scenarios</li>
</ul>
<p><strong>Frameworks:</strong></p>
<ul>
<li>Espresso for Android UI testing</li>
<li>Compose UI testing for Jetpack Compose</li>
<li>JUnit 4 as the test runner</li>
</ul>
<p><strong>Location:</strong></p>
<ul>
<li>In the <code>src/test</code> directory for Compose UI tests</li>
<li>In the <code>src/androidTest</code> directory for Espresso tests</li>
</ul>
<p><strong>Contributor Expectations:</strong></p>
<ul>
<li>✅ Add tests for new UI components and screens</li>
<li>✅ Focus on critical user flows</li>
<li>✅ Consider different device configurations</li>
<li>✅ Test both positive and negative scenarios</li>
<li>✅ Follow the AAA pattern</li>
<li>✅ Use descriptive test names</li>
</ul>
<h3 id="-screenshot-tests"><a class="header" href="#-screenshot-tests">📸 Screenshot Tests</a></h3>
<p><strong>⚠️ Work in Progress ⚠️</strong></p>
<blockquote>
<p><strong>Screenshot tests verify the visual appearance of UI components.</strong></p>
</blockquote>
<p><strong>What to Test:</strong></p>
<ul>
<li>Visual appearance of UI components</li>
<li>Layout correctness</li>
<li>Visual regressions</li>
<li>Theme and style application</li>
</ul>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li>Captures visual snapshots</li>
<li>Compares against reference images (<code>golden</code> images)</li>
<li>Detects unintended visual changes</li>
</ul>
<p><strong>Frameworks:</strong></p>
<ul>
<li>JUnit 4 as the test runner</li>
<li>Compose UI testing</li>
<li>Screenshot comparison tools (TBD)</li>
</ul>
<p><strong>Location:</strong></p>
<ul>
<li>Same module as the code being tested</li>
<li>In the <code>src/test</code> directory</li>
</ul>
<p><strong>Contributor Expectations:</strong></p>
<ul>
<li>✅ Add tests for new Composable UI components</li>
<li>✅ Verify correct rendering in different states</li>
<li>✅ Update reference screenshots for intentional changes</li>
</ul>
<h2 id="-test-types-we-dont-currently-have"><a class="header" href="#-test-types-we-dont-currently-have">🚫 Test Types We Don’t Currently Have</a></h2>
<blockquote>
<p><strong>This section helps contributors understand our testing strategy and future plans.</strong></p>
</blockquote>
<p><strong>End-to-End Tests</strong> ✨</p>
<ul>
<li>Full system tests verifying complete user journeys</li>
<li>Tests across multiple screens and features</li>
<li>Validates entire application workflows</li>
</ul>
<p><strong>Performance Tests</strong> ⚡</p>
<ul>
<li>Measures startup time, memory usage, responsiveness</li>
<li>Validates app performance under various conditions</li>
<li>Identifies performance bottlenecks</li>
</ul>
<p><strong>Accessibility Tests</strong> ♿</p>
<ul>
<li>Verifies proper content descriptions</li>
<li>Checks contrast ratios and keyboard navigation</li>
<li>Ensures app is usable by people with disabilities</li>
</ul>
<p><strong>Localization Tests</strong> 🌐</p>
<ul>
<li>Verifies correct translation display</li>
<li>Tests right-to-left language support</li>
<li>Validates date, time, and number formatting</li>
</ul>
<p><strong>Manual Test Scripts</strong> 📝</p>
<ul>
<li>Manual testing by QA team for exploratory testing</li>
<li>Ensures repeatable test execution</li>
<li>Documents expected behavior for manual tests</li>
</ul>
<h2 id="-running-tests-1"><a class="header" href="#-running-tests-1">🏃 Running Tests</a></h2>
<blockquote>
<p><strong>Quick commands to run tests in the project.</strong></p>
</blockquote>
<p>Run all tests:</p>
<pre><code class="language-bash">./gradlew test
</code></pre>
<p>Run tests for a specific module:</p>
<pre><code class="language-bash">./gradlew :module-name:test
</code></pre>
<p>Run Android instrumentation tests:</p>
<pre><code class="language-bash">./gradlew connectedAndroidTest
</code></pre>
<p>Run tests with coverage:</p>
<pre><code class="language-bash">./gradlew testDebugUnitTestCoverage
</code></pre>
<h2 id="-code-coverage"><a class="header" href="#-code-coverage">📊 Code Coverage</a></h2>
<blockquote>
<p><strong>⚠️ Work in Progress ⚠️</strong></p>
<p>This section is currently under development and will be updated with specific code coverage rules and guidelines.</p>
</blockquote>
<p>Code coverage helps us understand how much of our codebase is being tested. While we don’t currently have strict requirements, we aim for high coverage in critical components.</p>
<p><strong>Current Approach:</strong></p>
<ul>
<li>Focus on critical business logic</li>
<li>Prioritize user-facing features</li>
<li>No strict percentage requirements</li>
<li>Quality of tests over quantity</li>
</ul>
<p><strong>Future Guidelines (Coming Soon):</strong></p>
<ul>
<li>Code coverage targets by component type</li>
<li>Coverage report generation instructions</li>
<li>Interpretation guidelines</li>
<li>Exemptions for generated/simple code</li>
<li>CI/CD integration details</li>
</ul>
<p><strong>Remember:</strong> High code coverage doesn’t guarantee high-quality tests. Focus on writing meaningful tests that verify correct behavior, not just increasing coverage numbers.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-translations-2"><a class="header" href="#-translations-2">🌐 Translations</a></h1>
<p>This document explains how you can help translate Thunderbird for Android into your language.</p>
<ul>
<li>All translations for Thunderbird for Android are managed in <a href="https://hosted.weblate.org/projects/tb-android/" title="" target="_blank">Thunderbird for Android Weblate project</a>.</li>
<li>The Source language is <strong>English</strong> (American English, represented as <code>en</code>).</li>
<li>Translations are done only in Weblate, not in this repository.</li>
<li>The Thunderbird team regularly syncs Weblate with the repository to pull in translation updates.</li>
</ul>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>If you are a developer and need to add or manage strings or languages in the codebase, see <a href="contributing/managing-strings.html">managing strings</a>.</p>
</div>
<h2 id="-getting-started-with-weblate"><a class="header" href="#-getting-started-with-weblate">🚀 Getting started with Weblate</a></h2>
<p>Before contributing, familiarize yourself with <a href="https://docs.weblate.org/en/latest/" title="" target="_blank">documentation</a>.</p>
<p>To start translating Thunderbird for Android:</p>
<ol>
<li>Create a <a href="https://hosted.weblate.org/accounts/signup/" title="" target="_blank">Weblate account</a>.</li>
<li>Go to the <a href="https://hosted.weblate.org/projects/tb-android/" title="" target="_blank">Thunderbird for Android Weblate project</a>.</li>
<li>Select your language from the list of languages.</li>
<li>Start translating strings through the Weblate web interface.</li>
</ol>
<h2 id="-translation-rules"><a class="header" href="#-translation-rules">🔑 Translation Rules</a></h2>
<ul>
<li><strong>Translate only on Weblate</strong> - never edit translation directly in Git.</li>
<li><strong>Preserve technical placeholders and formatting:</strong>
<ul>
<li>Keep placeholders like <code>%1$s</code> or <code>%1$d</code> unchanged.</li>
<li>Match punctuation with the source string unless language rules require otherwise.</li>
</ul>
</li>
<li><strong>Don’t change meaning</strong> - if the English source string changes meaning, developers will create a new string key.</li>
</ul>
<h2 id="-tips-for-translators"><a class="header" href="#-tips-for-translators">💡 Tips for Translators</a></h2>
<ul>
<li>Use the <strong>Comments</strong> section in Weblate to ask questions or provide context.</li>
<li>Check regularly for new strings to translate.</li>
<li>Join the <a href="https://matrix.to/#/#tb-mobile-dev:mozilla.org" title="" target="_blank">Matrix channel</a> to connect with other translators and developers.</li>
</ul>
<h2 id="-adding-or-removing-languages"><a class="header" href="#-adding-or-removing-languages">📦 Adding or Removing Languages</a></h2>
<p>Languages included in app builds are decided by the development team based on <strong>translation coverage</strong>.</p>
<ul>
<li>A language must reach at least <strong>70% coverage across all project components</strong> before being shipped.</li>
<li>If coverage falls below <strong>60% for an extended period</strong>, the language may be removed from builds.</li>
<li>These thresholds are evaluated at each release cycle.</li>
</ul>
<p>You can still contribute translations below the 70% threshold in Weblate. Once coverage improves, the language will be
added to future builds.</p>
<h2 id="-becoming-a-reviewer"><a class="header" href="#-becoming-a-reviewer">✅ Becoming a Reviewer</a></h2>
<p>Reviewers help maintain translation quality by approving or correcting contributions.</p>
<p>To propose yourself as a reviewer:</p>
<ol>
<li>
<p>Make consistent contributions for your language in Weblate.</p>
</li>
<li>
<p>Go to the <a href="https://matrix.to/#/#tb-mobile-dev:mozilla.org" title="" target="_blank">Matrix channel</a></p>
</li>
<li>
<p>Post a short message like:</p>
<pre><code class="language-text">Hi, I would like to become a reviewer for [Language Name].
My Weblate username is [Your Username].  
Here is a link to my contributions: [Your Weblate Profile or Component Link].
</code></pre>
</li>
<li>
<p>The Thunderbird team will review your request and grant reviewer rights for that language if appropriate.</p>
</li>
</ol>
<h2 id="-requesting-a-new-language"><a class="header" href="#-requesting-a-new-language">🌍 Requesting a New Language</a></h2>
<p>If your language is not available in Weblate yet, you can request it be added.</p>
<p>To propose a new language:</p>
<ol>
<li>
<p>Go to the <a href="https://matrix.to/#/#tb-mobile-dev:mozilla.org" title="" target="_blank">Matrix channel</a></p>
</li>
<li>
<p>Post a short message like:</p>
<pre><code class="language-text">Hi, I would like to request adding a new language to Thunderbird for Android.  
Language: [Language Name]  
Code: [e.g., fr, pt_BR]
Any special notes: [Optional]
</code></pre>
</li>
<li>
<p>A team member will create the language in Weblate and confirm in the channel.</p>
</li>
<li>
<p>Once it’s available, you can start translating immediately.</p>
</li>
</ol>
<p>Inclusion into the app follows our translation coverage policy, see <a href="contributing/translations.html#-adding-or-removing-languages">Adding or Removing Languages</a>.</p>
<h2 id="-thank-you"><a class="header" href="#-thank-you">🙏 Thank You!</a></h2>
<p>Every translation improves Thunderbird for Android for users worldwide.
We greatly appreciate your help in making the app accessible in more languages!</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-managing-strings--languages"><a class="header" href="#-managing-strings--languages">📝 Managing Strings &amp; Languages</a></h1>
<p>This document explains how developers manage our english <strong>source strings</strong> and add/remove <strong>languages</strong> in the
Thunderbird for Android project.</p>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>Translators: If you want to contribute translations, see <a href="contributing/translations.html">Translations</a>.
This document is developer-focused.</p>
</div>
<h2 id="-approach"><a class="header" href="#-approach">📖 Approach</a></h2>
<ul>
<li>We use Android’s <a href="https://developer.android.com/guide/topics/resources/localization" title="" target="_blank">resource system</a> for localizing strings and Compose Multiplatform Resources for localizing strings in common code (Kotlin Multiplatform).</li>
<li><strong>Source language</strong> is <strong>English</strong> (American English, represented as <code>en</code>).</li>
<li><strong>Source strings</strong> are modified only in this repository (via pull requests).</li>
<li><strong>Translations</strong> are managed exclusively in <a href="https://hosted.weblate.org/projects/tb-android/" title="" target="_blank">Weblate</a> and merged into the repository by the Thunderbird team.</li>
<li><strong>Languages</strong> are added/removed when they reach 70% translation or fall below 60%.</li>
</ul>
<h2 id="-changing-source-strings"><a class="header" href="#-changing-source-strings">🔄 Changing Source Strings</a></h2>
<p>Source strings are always stored in <code>res/values/strings.xml</code> or (<strong>English</strong>, <code>en</code>).</p>
<p>They must be managed carefully to avoid breaking existing translations.</p>
<ul>
<li><strong>Do not edit translation files directly in Git.</strong>
Translations should always be updated in Weblate.</li>
</ul>
<h3 id="-mechanicalglobal-changes"><a class="header" href="#-mechanicalglobal-changes">🔧 Mechanical/Global Changes</a></h3>
<p>If a <strong>mechanical or global change</strong> to translations is required (for example, renaming placeholders or fixing
formatting across all languages):</p>
<ol>
<li>Lock components in Weblate (<a href="https://hosted.weblate.org/projects/tb-android/#repository" title="" target="_blank">maintenance page</a>).</li>
<li>Commit all outstanding changes.</li>
<li>Push Weblate changes (creates a PR).</li>
<li>Merge the Weblate PR.</li>
<li>Apply your mechanical change in a separate PR.</li>
<li>Wait for Weblate sync to propagate your merged PR.</li>
<li>Unlock components in Weblate.</li>
</ol>
<p>This ensures translators do not work on outdated strings and avoids merge conflicts.</p>
<h3 id="-adding-a-string"><a class="header" href="#-adding-a-string">➕ Adding a String</a></h3>
<ol>
<li>Add the new string in the appropriate <code>res/values/strings.xml</code> file.</li>
<li><strong>Do not</strong> add translations.
<ul>
<li>After merge, Weblate will pull the new string.</li>
<li>Translators can then add translations in Weblate.</li>
</ul>
</li>
</ol>
<h3 id="-changing-a-string"><a class="header" href="#-changing-a-string">✏️ Changing a String</a></h3>
<p>There are two kinds of changes to source strings:</p>
<h4 id="-typos-or-grammar-fixes"><a class="header" href="#-typos-or-grammar-fixes">🔤 Typos or Grammar Fixes</a></h4>
<p>Correcting minor errors (spelling, capitalization, punctuation, grammar) in the English source is allowed:</p>
<ul>
<li><strong>Keep the same key</strong> — translations will remain valid.</li>
</ul>
<p>Example:</p>
<ul>
<li>Changing “Recieve” to “Receive” or “email” to “Email”.</li>
</ul>
<h4 id="-changing-meaning"><a class="header" href="#-changing-meaning">🧭 Changing Meaning</a></h4>
<div class="mdbook-alerts mdbook-alerts-caution">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  caution
</p>
<p>Never reuse an existing key for a changed meaning — this would cause translators’ work to become misleading or incorrect.</p>
</div>
<p>If the meaning of the string changes (new wording, different context, updated functionality):</p>
<ol>
<li><strong>Add a new key</strong> with the new string.</li>
<li><strong>Update all references</strong> in the source code to use the new key.</li>
<li><strong>Delete the old key</strong> from <code>res/values/strings.xml</code>.</li>
<li><strong>Delete the old key’s translations</strong> from all <code>res/values-*/strings.xml</code> files.</li>
<li><strong>Build the project</strong> to ensure there are no references to the old key remaining.</li>
</ol>
<p>This ensures there are no stale or misleading translations left behind.</p>
<p>Example:</p>
<ul>
<li>Old: “Check mail now” (<code>action_check_mail</code>)</li>
<li>New: “Sync mail” (<code>action_sync_mail</code>)</li>
</ul>
<p>Steps:</p>
<ul>
<li>Add new key <code>action_sync_mail</code> with value “Sync mail” to <code>res/values/strings.xml</code>.</li>
<li>Update all code references from <code>R.string.action_check_mail</code> to <code>R.string.action_sync_mail</code>.</li>
<li>Remove <code>action_check_mail</code> from <code>res/values/strings.xml</code> and all <code>res/values-*/strings.xml</code></li>
<li>Build the project to ensure no references to <code>action_check_mail</code> remain.</li>
<li>After the next sync, Weblate will prompt translators to provide translations for action_sync_mail.</li>
</ul>
<h3 id="-removing-a-string"><a class="header" href="#-removing-a-string">❌ Removing a String</a></h3>
<ol>
<li><strong>Delete the key</strong> from <code>res/values/strings.xml</code>.</li>
<li><strong>Delete the key’s translations</strong> from all <code>res/values-*/strings.xml</code> files.</li>
<li><strong>Build the project</strong> to ensure there are no references to the removed key remaining.</li>
</ol>
<h2 id="-merging-weblate-prs"><a class="header" href="#-merging-weblate-prs">🔀 Merging Weblate PRs</a></h2>
<p>When merging Weblate-generated PRs:</p>
<ul>
<li>Check plural forms for <strong>cs, lt, sk</strong> locales. Weblate does not handle these correctly (<a href="https://github.com/WeblateOrg/weblate/issues/7520" title="" target="_blank">issue</a>).</li>
<li>Ensure both <code>many</code> and <code>other</code> forms are present.
<ul>
<li>If unsure, reusing values from <code>many</code> or <code>other</code> is acceptable.</li>
</ul>
</li>
</ul>
<h2 id="-managing-languages"><a class="header" href="#-managing-languages">🌍 Managing Languages</a></h2>
<p>We use Gradle’s <a href="https://developer.android.com/reference/tools/gradle-api/8.8/com/android/build/api/dsl/ApplicationAndroidResources#localeFilters%28%29" title="" target="_blank">
<code>androidResources.localeFilters</code></a> to control which languages are bundled.</p>
<p>This must stay in sync with the string array <code>supported_languages</code> so the in-app picker shows only available locales.</p>
<h3 id="-checking-translation-coverage"><a class="header" href="#-checking-translation-coverage">🔎 Checking Translation Coverage</a></h3>
<p>Before adding a language, we require that it is at least <strong>70% translated</strong> in Weblate.</p>
<p>We provide a <strong>Translation CLI</strong> script to check translation coverage:</p>
<pre><code class="language-bash">./scripts/translation --token &lt;weblate-token&gt;

# Specify the low 60% threshold
./scripts/translation --token &lt;weblate-token&gt; --threshold 60
</code></pre>
<ul>
<li>Requires a <a href="https://hosted.weblate.org/accounts/profile/#api" title="" target="_blank">Weblate API token</a></li>
<li>Default threshold is 70% (can be changed with <code>--threshold &lt;N&gt;</code>)</li>
</ul>
<p>For example code integration, run with –print-all:</p>
<pre><code class="language-bash">./scripts/translation --token &lt;weblate-token&gt; --print-all
</code></pre>
<p>This output can be used to update:</p>
<ul>
<li><code>resourceConfigurations</code> in <code>app-k9mail/build.gradle.kts</code> and <code>app-thunderbird/build.gradle.kts</code></li>
<li><code>supported_languages</code> in <code>legacy/core/src/res/values/arrays_general_settings_values.xml</code></li>
</ul>
<h3 id="-removing-a-language"><a class="header" href="#-removing-a-language">➖ Removing a Language</a></h3>
<ol>
<li>Remove language code from <code>androidResources.localeFilters</code> in:
<ul>
<li><code>app-thunderbird/build.gradle.kts</code></li>
<li><code>app-k9mail/build.gradle.kts</code></li>
</ul>
</li>
<li>Remove entry from <code>supported_languages</code> in:
<ul>
<li><code>app/core/src/main/res/values/arrays_general_settings_values.xml</code></li>
</ul>
</li>
</ol>
<h3 id="-adding-a-language"><a class="header" href="#-adding-a-language">➕ Adding a Language</a></h3>
<ol>
<li>Add the code to <code>androidResources.localeFilters</code> in both app modules.</li>
<li>Add entry to <code>supported_languages</code> in:
<ul>
<li><code>app/core/src/main/res/values/arrays_general_settings_values.xml</code></li>
</ul>
</li>
<li>Add corresponding display name in:
<ul>
<li><code>app/ui/legacy/src/main/res/values/arrays_general_settings_strings.xml</code> (sorted by Unicode default collation order).</li>
</ul>
</li>
<li>Ensure indexes match between <code>language_entries</code> and <code>language_values</code>.</li>
</ol>
<div class="mdbook-alerts mdbook-alerts-important">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  important
</p>
<p>The order of entries in language_entries and language_values must match exactly. Incorrect ordering will cause mismatches in the language picker.</p>
</div>
<h2 id="-adding-a-component-to-weblate"><a class="header" href="#-adding-a-component-to-weblate">🧩 Adding a Component to Weblate</a></h2>
<p>When a new module contains translatable strings, a new Weblate component must be created.</p>
<p>Steps:</p>
<ol>
<li>Go to <a href="https://hosted.weblate.org/create/component/?project=3696" title="" target="_blank">Add Component</a>.</li>
<li>Choose <strong>From existing component</strong>.</li>
<li>Name your component.</li>
<li>For <strong>Component</strong>, select <strong>Thunderbird for Android / K-9 Mail/ui-legacy</strong>.</li>
<li>Continue → Select <strong>Specify configuration manually</strong>.</li>
<li>Set file format to <strong>Android String Resource</strong>.</li>
<li>File mask: <code>path/to/module/src/main/res/values-*/strings.xml</code></li>
<li>Base file: <code>path/to/module/src/main/res/values/strings.xml</code></li>
<li>Uncheck <strong>Edit base file</strong>.</li>
<li>License: <strong>Apache License 2.0</strong>.</li>
<li>Save.</li>
</ol>
<h2 id="-language-code-differences"><a class="header" href="#-language-code-differences">⚠️ Language Code Differences</a></h2>
<p>Android sometimes uses codes that differ from Weblate (e.g. Hebrew = <code>iw</code> in Android but <code>he</code> in Weblate).</p>
<p>Automation tools must map between systems.
See <a href="https://github.com/thunderbird/thunderbird-android/blob/main/cli/translation-cli/src/main/kotlin/net/thunderbird/cli/translation/LanguageCodeLoader.kt#L12-L13" title="" target="_blank">LanguageCodeLoader.kt</a> for an example.</p>
<p>You could find a more complete list of differences in the <a href="https://developer.android.com/guide/topics/resources/localization#LocaleCodes" title="" target="_blank">Android documentation</a> and <a href="https://developer.android.com/guide/topics/resources/internationalization" title="" target="_blank">Unicode and internationalization support</a></p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="java-to-kotlin-conversion-guide"><a class="header" href="#java-to-kotlin-conversion-guide">Java to Kotlin Conversion Guide</a></h1>
<p>This guide describes our process for converting Java code to Kotlin.</p>
<h2 id="why-convert-to-kotlin"><a class="header" href="#why-convert-to-kotlin">Why Convert to Kotlin?</a></h2>
<p>Java and Kotlin are compatible languages, but we decided to convert our codebase to Kotlin for the following reasons:</p>
<ul>
<li>Kotlin is more concise and expressive than Java.</li>
<li>Kotlin has better support for null safety.</li>
<li>Kotlin has a number of modern language features that make it easier to write maintainable code.</li>
</ul>
<p>See our <a href="contributing/../architecture/adr/0001-switch-from-java-to-kotlin.html">ADR-0001</a> for more information.</p>
<h2 id="how-to-convert-java-code-to-kotlin"><a class="header" href="#how-to-convert-java-code-to-kotlin">How to Convert Java Code to Kotlin</a></h2>
<ol>
<li>Write tests for any code that is not adequately covered by tests.</li>
<li>Use the “Convert Java File to Kotlin File” action in IntelliJ or Android Studio to convert the Java code.</li>
<li>Fix any issues that prevent the code from compiling after the automatic conversion.</li>
<li>Commit the changes as separate commits:
<ol>
<li>The change of file extension (e.g. <code>example.java</code> -&gt; <code>example.kt</code>).</li>
<li>The conversion of the Java file to Kotlin.</li>
</ol>
<ul>
<li>This can be automated by IntelliJ/Android Studio if you use their VCS integration and enable the option to commit changes separately.</li>
</ul>
</li>
<li>Refactor the code to improve readability and maintainability. This includes:
<ol>
<li>Removing unnecessary code.</li>
<li>Using Kotlin’s standard library functions, language features, null safety and coding conventions.</li>
</ol>
</li>
</ol>
<h2 id="additional-tips"><a class="header" href="#additional-tips">Additional Tips</a></h2>
<ul>
<li>Use <code>when</code> expressions instead of <code>if-else</code> statements.</li>
<li>Use <code>apply</code> and <code>also</code> to perform side effects on objects.</li>
<li>Use <code>@JvmField</code> to expose a Kotlin property as a field in Java.</li>
</ul>
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<ul>
<li><a href="https://kotlinlang.org/docs/coding-conventions.html" title="" target="_blank">Kotlin Coding Conventions</a></li>
<li><a href="https://kotlinlang.org/docs/java-to-kotlin-interop.html" title="" target="_blank">Calling Kotlin from Java</a></li>
<li><a href="https://kotlinlang.org/docs/java-interop.html" title="" target="_blank">Calling Java from Kotlin</a></li>
<li><a href="https://developer.android.com/kotlin?hl=en" title="" target="_blank">Kotlin and Android | Android Developers</a></li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-architecture-1"><a class="header" href="#-architecture-1">🏗️ Architecture</a></h1>
<p>The application follows a modular architecture with clear separation between different layers and components. The architecture is designed to support both the Thunderbird for Android and K-9 Mail applications while maximizing code reuse, maintainability and enable adoption of Kotlin Multiplatform in the future.</p>
<h2 id="-key-architectural-principles"><a class="header" href="#-key-architectural-principles">🔑 Key Architectural Principles</a></h2>
<ul>
<li><strong>🚀 Multi platform Compatibility</strong>: The architecture is designed to support future Kotlin Multiplatform adoption</li>
<li><strong>📱 Offline-First</strong>: The application is designed to work offline with local data storage and synchronization with remote servers</li>
<li><strong>🧩 Modularity</strong>: The application is divided into distinct modules with clear responsibilities</li>
<li><strong>🔀 Separation of Concerns</strong>: Each module focuses on a specific aspect of the application</li>
<li><strong>⬇️ Dependency Inversion</strong>: Higher-level modules do not depend on lower-level modules directly</li>
<li><strong>🎯 Single Responsibility</strong>: Each component has a single responsibility</li>
<li><strong>🔄 API/Implementation Separation</strong>: Clear separation between public APIs and implementation details</li>
<li><strong>🧹 Clean Architecture</strong>: Separation of UI, domain, and data layers</li>
<li><strong>🧪 Testability</strong>: The architecture facilitates comprehensive testing at all levels</li>
</ul>
<h2 id="-architecture-decision-records"><a class="header" href="#-architecture-decision-records">📝 Architecture Decision Records</a></h2>
<p>The <a href="architecture/adr/README.html">Architecture Decision Records</a> document the architectural decisions made during the development of the
project, providing context and rationale for key technical choices. Reading through these decisions will improve your
contributions and ensure long-term maintainability of the project.</p>
<h2 id="-module-structure"><a class="header" href="#-module-structure">📦 Module Structure</a></h2>
<p>The application is organized into several module types:</p>
<ul>
<li><strong>📱 App Modules</strong>: <code>app-thunderbird</code> and <code>app-k9mail</code> - Application entry points</li>
<li><strong>🔄 App Common</strong>: <code>app-common</code> - Shared code between applications</li>
<li><strong>✨ Feature Modules</strong>: <code>feature:*</code> - Independent feature modules</li>
<li><strong>🧰 Core Modules</strong>: <code>core:*</code> - Foundational components and utilities used across multiple features</li>
<li><strong>📚 Library Modules</strong>: <code>library:*</code> - Specific implementations for reuse</li>
<li><strong>🔙 Legacy Modules</strong>: Legacy code being gradually migrated</li>
</ul>
<p>For more details on the module organization and structure, see the <a href="architecture/module-organization.html">Module Organization</a> and
<a href="architecture/module-structure.html">Module Structure</a> documents.</p>
<h2 id="-architectural-patterns"><a class="header" href="#-architectural-patterns">🧩 Architectural Patterns</a></h2>
<p>The architecture follows several key patterns to ensure maintainability, testability, and separation of concerns:</p>
<h3 id="-apiimplementation-separation"><a class="header" href="#-apiimplementation-separation">🔄 API/Implementation Separation</a></h3>
<p>Each module should be split into two main parts: <strong>API</strong> and <strong>implementation</strong>. This separation provides clear
boundaries between what a module exposes to other modules and how it implements its functionality internally:</p>
<ul>
<li><strong>📝 API</strong>: Public interfaces, models, and contracts</li>
<li><strong>⚙️ Implementation</strong>: Concrete implementations of the interfaces</li>
</ul>
<p>This separation provides clear boundaries, improves testability, and enables flexibility.</p>
<p>See <a href="architecture/module-structure.html#-api-module">API Module</a> and
<a href="architecture/module-structure.html#-implementation-module">Implementation Module</a> for more details.</p>
<h3 id="clean-architecture"><a class="header" href="#clean-architecture">Clean Architecture</a></h3>
<p>Thunderbird for Android uses <strong>Clean Architecture</strong> with three main layers (UI, domain, and data) to break down complex
feature implementation into manageable components. Each layer has a specific responsibility:</p>
<pre class="mermaid">graph TD
    subgraph UI[UI Layer]
        UI_COMPONENTS[UI Components]
        VIEW_MODEL[ViewModels]
    end

    subgraph DOMAIN[&quot;Domain Layer&quot;]
        USE_CASE[Use Cases]
        REPO[Repositories]
    end

    subgraph DATA[Data Layer]
        DATA_SOURCE[Data Sources]
        API[API Clients]
        DB[Local Database]
    end

    UI_COMPONENTS --&gt; VIEW_MODEL
    VIEW_MODEL --&gt; USE_CASE
    USE_CASE --&gt; REPO
    REPO --&gt; DATA_SOURCE
    DATA_SOURCE --&gt; API
    DATA_SOURCE --&gt; DB

    classDef ui_layer fill:#d9e9ff,stroke:#000000,color:#000000
    classDef ui_class fill:#4d94ff,stroke:#000000,color:#000000
    classDef domain_layer fill:#d9ffd9,stroke:#000000,color:#000000
    classDef domain_class fill:#33cc33,stroke:#000000,color:#000000
    classDef data_layer fill:#ffe6cc,stroke:#000000,color:#000000
    classDef data_class fill:#ffaa33,stroke:#000000,color:#000000
    
    linkStyle default stroke:#999,stroke-width:2px

    class UI ui_layer
    class UI_COMPONENTS,VIEW_MODEL ui_class
    class DOMAIN domain_layer
    class USE_CASE,REPO domain_class
    class DATA data_layer
    class DATA_SOURCE,API,DB data_class
</pre>
<h4 id="-ui-layer-presentation"><a class="header" href="#-ui-layer-presentation">🖼️ UI Layer (Presentation)</a></h4>
<p>The UI layer is responsible for displaying data to the user and handling user interactions.</p>
<p><strong>Key Components:</strong></p>
<ul>
<li><strong>🎨 <a href="architecture/ui-architecture.html#-screens">Compose UI</a></strong>: Screen components built with Jetpack Compose</li>
<li><strong>🧠 <a href="architecture/ui-architecture.html#-viewmodel">ViewModels</a></strong>: Manage UI state and handle UI events</li>
<li><strong>📊 <a href="architecture/ui-architecture.html#-state">UI State</a></strong>: Immutable data classes representing the UI state</li>
<li><strong>🎮 <a href="architecture/ui-architecture.html#-events">Events</a></strong>: User interactions or system events that trigger state changes</li>
<li><strong>🔔 <a href="architecture/ui-architecture.html#effects">Effects</a></strong>: One-time side effects like navigation or showing messages</li>
</ul>
<p><strong>Pattern: Model-View-Intent (MVI)</strong></p>
<ul>
<li><strong>📋 Model</strong>: UI state representing the current state of the screen</li>
<li><strong>👁️ View</strong>: Compose UI that renders the state</li>
<li><strong>🎮 Event</strong>: User interactions that trigger state changes (equivalent to “Intent” in standard MVI)</li>
<li><strong>🔔 Effect</strong>: One-time side effects like navigation or notifications</li>
</ul>
<h4 id="-domain-layer-business-logic"><a class="header" href="#-domain-layer-business-logic">🧠 Domain Layer (Business Logic)</a></h4>
<p>The domain layer contains the business logic and rules of the application. It is independent of the UI and data layers,
allowing for easy testing and reuse.</p>
<p><strong>Key Components:</strong></p>
<ul>
<li><strong>⚙️ Use Cases</strong>: Encapsulate business logic operations</li>
<li><strong>📋 Domain Models</strong>: Represent business entities</li>
<li><strong>📝 Repository Interfaces</strong>: Define data access contracts</li>
</ul>
<pre class="mermaid">graph TB
    subgraph DOMAIN[Domain Layer]
        USE_CASE[Use Cases]
        MODEL[Domain Models]
        REPO_API[Repository Interfaces]
    end

    subgraph DATA[Data Layer]
        REPO_IMPL[Repository Implementations]
    end

    USE_CASE --&gt; |uses| REPO_API
    USE_CASE --&gt; |uses| MODEL
    REPO_API --&gt; |uses| MODEL
    REPO_IMPL --&gt; |implements| REPO_API
    REPO_IMPL --&gt; |uses| MODEL

    classDef domain_layer fill:#d9ffd9,stroke:#000000,color:#000000
    classDef domain_class fill:#33cc33,stroke:#000000,color:#000000
    classDef data_layer fill:#ffe6cc,stroke:#000000,color:#000000
    classDef data_class fill:#ffaa33,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class DOMAIN domain_layer
    class USE_CASE,REPO_API,MODEL domain_class
    class DATA data_layer
    class REPO_IMPL data_class
</pre>
<h4 id="-data-layer"><a class="header" href="#-data-layer">💾 Data Layer</a></h4>
<p>The data layer is responsible for data retrieval, storage, and synchronization.</p>
<p><strong>Key Components:</strong></p>
<ul>
<li><strong>📦 Repository implementations</strong>: Implement repository interfaces from the domain layer</li>
<li><strong>🔌 Data Sources</strong>: Provide data from specific sources (API, database, preferences)</li>
<li><strong>📄 Data Transfer Objects</strong>: Represent data at the data layer</li>
</ul>
<p><strong>Pattern: Data Source Pattern</strong></p>
<ul>
<li>🔍 Abstracts data sources behind a clean API</li>
<li>Maps data between domain models and data transfer objects</li>
</ul>
<pre class="mermaid">graph TD
    subgraph DOMAIN[Domain Layer]
        REPO_API[Repository]
    end

    subgraph DATA[Data Layer]
        REPO_IMPL[Repository implementations]
        RDS[Remote Data Sources]
        LDS[Local Data Sources]
        MAPPER[Data Mappers]
        DTO[Data Transfer Objects]
    end

    REPO_IMPL --&gt; |implements| REPO_API
    REPO_IMPL --&gt; RDS
    REPO_IMPL --&gt; LDS
    REPO_IMPL --&gt; MAPPER
    RDS --&gt; MAPPER
    LDS --&gt; MAPPER
    MAPPER --&gt; DTO

    classDef domain_layer fill:#d9ffd9,stroke:#000000,color:#000000
    classDef domain_class fill:#33cc33,stroke:#000000,color:#000000
    classDef data_layer fill:#ffe6cc,stroke:#000000,color:#000000
    classDef data_class fill:#ffaa33,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class DOMAIN domain_layer
    class REPO_API domain_class
    class DATA data_layer
    class REPO_IMPL,RDS,LDS,MAPPER,DTO data_class
</pre>
<h3 id="-immutability"><a class="header" href="#-immutability">🔄 Immutability</a></h3>
<p>Immutability means that once an object is created, it cannot be changed. Instead of modifying existing objects, new objects are created with the desired changes. In the context of UI state, this means that each state object represents a complete snapshot of the UI at a specific point in time.</p>
<p><strong>Why is Immutability Important?</strong></p>
<p>Immutability provides several benefits:</p>
<ul>
<li><strong>Predictability</strong>: With immutable state, the UI can only change when a new state object is provided, making the flow of data more predictable and easier to reason about.</li>
<li><strong>Debugging</strong>: Each state change creates a new state object, making it easier to track changes and debug issues by comparing state objects.</li>
<li><strong>Concurrency</strong>: Immutable objects are thread-safe by nature, eliminating many concurrency issues.</li>
<li><strong>Performance</strong>: While creating new objects might seem inefficient, modern frameworks optimize this process, and the benefits of immutability often outweigh the costs.</li>
<li><strong>Time-travel debugging</strong>: Immutability enables storing previous states, allowing developers to “time travel” back to previous application states during debugging.</li>
</ul>
<h2 id="-ui-architecture"><a class="header" href="#-ui-architecture">🎨 UI Architecture</a></h2>
<p>The UI is built using Jetpack Compose with a component-based architecture following our modified Model-View-Intent (MVI) pattern. This architecture provides a unidirectional data flow, clear separation of concerns, and improved testability.</p>
<p>For detailed information about the UI architecture and theming, see the <a href="architecture/ui-architecture.html">UI Architecture</a> and
<a href="architecture/theme-system.html">Theme System</a> documents.</p>
<h2 id="-offline-first-approach"><a class="header" href="#-offline-first-approach">📱 Offline-First Approach</a></h2>
<p>The application implements an offline-first Approach to provide a reliable user experience regardless of network conditions:</p>
<ul>
<li>💾 Local database as the single source of truth</li>
<li>🔄 Background synchronization with remote servers</li>
<li>📋 Operation queueing for network operations</li>
<li>🔀 Conflict resolution for data modified both locally and remotely</li>
</ul>
<h4 id="implementation-approach"><a class="header" href="#implementation-approach">Implementation Approach</a></h4>
<pre class="mermaid">graph LR
    subgraph UI[UI Layer]
        VIEW_MODEL[ViewModel]
    end

    subgraph DOMAIN[Domain Layer]
        USE_CASE[Use Cases]
    end

    subgraph DATA[Data Layer]
        subgraph SYNC[Synchronization]
            SYNC_MANAGER[Sync Manager]
            SYNC_QUEUE[Sync Queue]
        end
        REPO[Repository]
        LOCAL[Local Data Source]
        REMOTE[Remote Data Source]
    end
    
    VIEW_MODEL --&gt; USE_CASE
    USE_CASE --&gt; REPO
    SYNC_MANAGER --&gt; LOCAL
    SYNC_MANAGER --&gt; REMOTE
    SYNC_MANAGER --&gt; SYNC_QUEUE
    REPO --&gt; LOCAL
    REPO --&gt; REMOTE
    REPO --&gt; SYNC_MANAGER
    REPO ~~~ SYNC
    
    classDef ui_layer fill:#d9e9ff,stroke:#000000,color:#000000
    classDef ui_class fill:#4d94ff,stroke:#000000,color:#000000
    classDef domain_layer fill:#d9ffd9,stroke:#000000,color:#000000
    classDef domain_class fill:#33cc33,stroke:#000000,color:#000000
    classDef data_layer fill:#ffe6cc,stroke:#000000,color:#000000
    classDef data_class fill:#ffaa33,stroke:#000000,color:#000000
    classDef sync_layer fill:#e6cce6,stroke:#000000,color:#000000
    classDef sync_class fill:#cc99cc,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class UI ui_layer
    class VIEW_MODEL ui_class
    class DOMAIN domain_layer
    class USE_CASE domain_class
    class DATA data_layer
    class REPO,LOCAL,REMOTE data_class
    class SYNC sync_layer
    class SYNC_MANAGER,SYNC_API,SYNC_QUEUE sync_class
</pre>
<p>The offline-first approach is implemented across all layers of the application:</p>
<ol>
<li><strong>💾 Data Layer</strong>:
<ul>
<li>📊 Local database as the primary data source</li>
<li>🌐 Remote data source for server communication</li>
<li>📦 Repository pattern to coordinate between data sources</li>
<li>🔄 Synchronization manager to handle data syncing</li>
</ul>
</li>
<li><strong>🧠 Domain Layer</strong>:
<ul>
<li>⚙️ Use cases handle both online and offline scenarios</li>
<li>📝 Business logic accounts for potential network unavailability</li>
<li>📋 Domain models represent data regardless of connectivity state</li>
</ul>
</li>
<li><strong>🖼️ UI Layer</strong>:
<ul>
<li>🧠 ViewModels expose UI state that reflects connectivity status</li>
<li>🚦 UI components display appropriate indicators for offline mode</li>
<li>👆 User interactions are designed to work regardless of connectivity</li>
</ul>
</li>
</ol>
<h2 id="-dependency-injection-1"><a class="header" href="#-dependency-injection-1">💉 Dependency Injection</a></h2>
<p>The application uses <a href="https://insert-koin.io/" title="" target="_blank">Koin</a> for dependency injection, with modules organized by feature:</p>
<ul>
<li><strong>📱 App Modules</strong>: Configure application-wide dependencies</li>
<li><strong>🔄 App Common</strong>: Shared dependencies between applications</li>
<li><strong>✨ Feature Modules</strong>: Configure feature-specific dependencies</li>
<li><strong>🧰 Core Modules</strong>: Configure core dependencies</li>
</ul>
<pre><code class="language-kotlin">// Example Koin module for a feature
val featureModule = module {
    viewModel { FeatureViewModel(get()) }
    single&lt;FeatureRepository&gt; { FeatureRepositoryImpl(get(), get()) }
    single&lt;FeatureUseCase&gt; { FeatureUseCaseImpl(get()) }
    single&lt;FeatureApiClient&gt; { FeatureApiClientImpl() }
}
</code></pre>
<h2 id="-cross-cutting-concerns"><a class="header" href="#-cross-cutting-concerns">🔄 Cross-Cutting Concerns</a></h2>
<p>Cross-cutting concerns are aspects of the application that affect multiple features and cannot be cleanly handled
individually for every feature. These concerns require consistent implementation throughout the codebase to ensure
maintainability an reliability.</p>
<p>In Thunderbird for Android, several cross-cutting concerns are implemented as dedicated core modules to provide
standardized solutions that can be reused across the application:</p>
<ul>
<li><strong>⚠️ Error Handling</strong>: Comprehensive error handling (<code>core/outcome</code>) transforms exceptions into domain-specific errors and provides user-friendly feedback.</li>
<li><strong>📋 Logging</strong>: Centralized logging system (<code>core/logging</code>) ensures consistent log formatting, levels, and storage.</li>
<li><strong>🔒 Security</strong>: Modules like <code>core/security</code> handle encryption, authentication, and secure data storage.</li>
</ul>
<p>Work in progress:</p>
<ul>
<li><strong>🔐 Encryption</strong>: The <code>core/crypto</code> module provides encryption and decryption utilities for secure data handling.</li>
<li><strong>📦 Feature Flags</strong>: The <code>core/feature-flags</code> module manages feature toggles and experimental features.</li>
<li><strong>🔄 Synchronization</strong>: The <code>core/sync</code> module manages background synchronization, conflict resolution, and offline-first behavior.</li>
<li><strong>🛠️ Configuration Management</strong>: Centralized handling of application settings and environment-specific configurations.</li>
</ul>
<p>By implementing these concerns as core modules, the application achieves a clean and modular architecture that is easier to maintain and extend.</p>
<h3 id="-error-handling"><a class="header" href="#-error-handling">⚠️ Error Handling</a></h3>
<p>The application implements a comprehensive error handling strategy across all layers. We favor using the Outcome pattern
over exceptions for expected error conditions, while exceptions are reserved for truly exceptional situations that
indicate programming errors or unrecoverable system failures.</p>
<ul>
<li>🧠 <strong>Domain Errors</strong>: Encapsulate business logic errors as sealed classes, ensuring clear representation of specific
error cases.</li>
<li>💾 <strong>Data Errors</strong>: Transform network or database exceptions into domain-specific errors using result patterns in repository implementations.</li>
<li>🖼️ <strong>UI Error Handling</strong>: Provide user-friendly error feedback by:
<ul>
<li>Mapping domain errors to UI state in ViewModels.</li>
<li>Displaying actionable error states in Compose UI components.</li>
<li>Offering retry options for network connectivity issues.</li>
</ul>
</li>
</ul>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>Exceptions should be used sparingly. Favor the Outcome pattern and sealed classes for predictable error conditions to
enhance maintainability and clarity.</p>
</div>
<h4 id="-how-to-implement-error-handling"><a class="header" href="#-how-to-implement-error-handling">🛠️ How to Implement Error Handling</a></h4>
<p>When implementing error handling in your code:</p>
<ol>
<li>
<p><strong>Define domain-specific errors</strong> as sealed classes in your feature’s domain layer:</p>
<pre><code class="language-kotlin">sealed class AccountError {
    data class AuthenticationFailed(val reason: String) : AccountError()
    data class NetworkError(val exception: Exception) : AccountError()
    data class ValidationError(val field: String, val message: String) : AccountError()
}
</code></pre>
</li>
<li>
<p><strong>Use result patterns (Outcome)</strong> instead of exceptions for error handling:</p>
<pre><code class="language-kotlin">// Use the Outcome class for representing success or failure
sealed class Outcome&lt;out T, out E&gt; {
    data class Success&lt;T&gt;(val value: T) : Outcome&lt;T, Nothing&gt;()
    data class Failure&lt;E&gt;(val error: E) : Outcome&lt;Nothing, E&gt;()
}
</code></pre>
</li>
<li>
<p><strong>Transform external errors</strong> into domain errors in your repositories using result patterns:</p>
<pre><code class="language-kotlin">// Return Outcome instead of throwing exceptions
fun authenticate(credentials: Credentials): Outcome&lt;AuthResult, AccountError&gt; {
    return try {
        val result = apiClient.authenticate(credentials)
        Outcome.Success(result)
    } catch (e: HttpException) {
        val error = when (e.code()) {
            401 -&gt; AccountError.AuthenticationFailed("Invalid credentials")
            else -&gt; AccountError.NetworkError(e)
        }
        logger.error(e) { "Authentication failed: ${error::class.simpleName}" }
        Outcome.Failure(error)
    } catch (e: Exception) {
        logger.error(e) { "Authentication failed with unexpected error" }
        Outcome.Failure(AccountError.NetworkError(e))
    }
}
</code></pre>
</li>
<li>
<p><strong>Handle errors in Use Cases</strong> by propagating the Outcome:</p>
<pre><code class="language-kotlin">class LoginUseCase(
    private val accountRepository: AccountRepository,
    private val credentialValidator: CredentialValidator,
) {
    fun execute(credentials: Credentials): Outcome&lt;AuthResult, AccountError&gt; {
        // Validate input first
        val validationResult = credentialValidator.validate(credentials)
        if (validationResult is ValidationResult.Failure) {
            return Outcome.Failure(
                AccountError.ValidationError(
                    field = validationResult.field,
                    message = validationResult.message
                )
            )
        }

        // Proceed with authentication
        return accountRepository.authenticate(credentials)
    }
}
</code></pre>
</li>
<li>
<p><strong>Handle outcomes in ViewModels</strong> and transform them into UI state:</p>
<pre><code class="language-kotlin">viewModelScope.launch {
    val outcome = loginUseCase.execute(credentials)

    when (outcome) {
        is Outcome.Success -&gt; {
            _uiState.update { it.copy(isLoggedIn = true) }
        }
        is Outcome.Failure -&gt; {
            val errorMessage = when (val error = outcome.error) {
                is AccountError.AuthenticationFailed -&gt; 
                    stringProvider.getString(R.string.error_authentication_failed, error.reason)
                is AccountError.NetworkError -&gt; 
                    stringProvider.getString(R.string.error_network, error.exception.message)
                is AccountError.ValidationError -&gt; 
                    stringProvider.getString(R.string.error_validation, error.field, error.message)
            }
            _uiState.update { it.copy(error = errorMessage) }
        }
    }
}
</code></pre>
</li>
<li>
<p><strong>Always log errors</strong> for debugging purposes:</p>
<pre><code class="language-kotlin">// Logging is integrated into the Outcome pattern
fun fetchMessages(): Outcome&lt;List&lt;Message&gt;, MessageError&gt; {
    return try {
        val messages = messageService.fetchMessages()
        logger.info { "Successfully fetched ${messages.size} messages" }
        Outcome.Success(messages)
    } catch (e: Exception) {
        logger.error(e) { "Failed to fetch messages" }
        Outcome.Failure(MessageError.FetchFailed(e))
    }
}
</code></pre>
</li>
<li>
<p><strong>Compose multiple operations</strong> that return Outcomes:</p>
<pre><code class="language-kotlin">fun synchronizeAccount(): Outcome&lt;SyncResult, SyncError&gt; {
    // First operation
    val messagesOutcome = fetchMessages()
    if (messagesOutcome is Outcome.Failure) {
        return Outcome.Failure(SyncError.MessageSyncFailed(messagesOutcome.error))
    }

    // Second operation using the result of the first
    val messages = messagesOutcome.getOrNull()!!
    val folderOutcome = updateFolders(messages)
    if (folderOutcome is Outcome.Failure) {
        return Outcome.Failure(SyncError.FolderUpdateFailed(folderOutcome.error))
    }

    // Return success with combined results
    return Outcome.Success(
        SyncResult(
            messageCount = messages.size,
            folderCount = folderOutcome.getOrNull()!!.size
        )
    )
}
</code></pre>
</li>
</ol>
<h3 id="-logging"><a class="header" href="#-logging">📝 Logging</a></h3>
<p>The application uses a structured logging system with a well-defined API:</p>
<ul>
<li>📊 <strong>Logging Architecture</strong>:
<ul>
<li>Core logging API (<code>core/logging/api</code>) defines interfaces like <code>Logger</code> and <code>LogSink</code></li>
<li>Multiple implementations (composite, console) allow for flexible logging targets</li>
<li>Composite implementation enables logging to multiple sinks simultaneously</li>
</ul>
</li>
<li>🔄 <strong>Logger vs. Sink</strong>:
<ul>
<li><strong>Logger</strong>: The front-facing interface that application code interacts with to create log entries
<ul>
<li>Provides methods for different log levels (verbose, debug, info, warn, error)</li>
<li>Handles the creation of log events with appropriate metadata (timestamp, tag, etc.)</li>
<li>Example: <code>DefaultLogger</code> implements the <code>Logger</code> interface and delegates to a <code>LogSink</code></li>
</ul>
</li>
<li><strong>LogSink</strong>: The back-end component that receives log events and determines how to process them
<ul>
<li>Defines where and how log messages are actually stored or displayed</li>
<li>Filters log events based on configured log levels</li>
<li>Can be implemented in various ways (console output, file storage, remote logging service)</li>
<li>Multiple sinks can be used simultaneously via composite pattern</li>
</ul>
</li>
</ul>
</li>
<li>📋 <strong>Log Levels</strong>:
<ul>
<li><code>VERBOSE</code>: Most detailed log level for debugging</li>
<li><code>DEBUG</code>: Detailed information for diagnosing problems</li>
<li><code>INFO</code>: General information about application flow</li>
<li><code>WARN</code>: Potential issues that don’t affect functionality</li>
<li><code>ERROR</code>: Issues that affect functionality but don’t crash the application</li>
</ul>
</li>
</ul>
<h4 id="-how-to-implement-logging"><a class="header" href="#-how-to-implement-logging">🛠️ How to Implement Logging</a></h4>
<p>When adding logging to your code:</p>
<ol>
<li>
<p><strong>Inject a Logger</strong> into your class:</p>
<pre><code class="language-kotlin">class AccountRepository(
    private val apiClient: ApiClient,
    private val logger: Logger,
) {
    // Repository implementation
}
</code></pre>
</li>
<li>
<p><strong>Choose the appropriate log level</strong> based on the importance of the information:</p>
<ul>
<li>Use <code>verbose</code> for detailed debugging information (only visible in debug builds)</li>
<li>Use <code>debug</code> for general debugging information</li>
<li>Use <code>info</code> for important events that should be visible in production</li>
<li>Use <code>warn</code> for potential issues that don’t affect functionality</li>
<li>Use <code>error</code> for issues that affect functionality</li>
</ul>
</li>
<li>
<p><strong>Use lambda syntax</strong> to avoid string concatenation when logging isn’t needed:</p>
<pre><code class="language-kotlin">// Good - string is only created if this log level is enabled
logger.debug { "Processing message with ID: $messageId" }

// Avoid - string is always created even if debug logging is disabled
logger.debug("Processing message with ID: " + messageId)
</code></pre>
</li>
<li>
<p><strong>Include relevant context</strong> in log messages:</p>
<pre><code class="language-kotlin">logger.info { "Syncing account: ${account.email}, folders: ${folders.size}" }
</code></pre>
</li>
<li>
<p><strong>Log exceptions</strong> with the appropriate level and context:</p>
<pre><code class="language-kotlin">try {
    apiClient.fetchMessages()
} catch (e: Exception) {
    logger.error(e) { "Failed to fetch messages for account: ${account.email}" }
    throw MessageSyncError.FetchFailed(e)
}
</code></pre>
</li>
<li>
<p><strong>Use tags</strong> for better filtering when needed:</p>
<pre><code class="language-kotlin">private val logTag = LogTag("AccountSync")

fun syncAccount() {
    logger.info(logTag) { "Starting account sync for: ${account.email}" }
}
</code></pre>
</li>
</ol>
<h3 id="-security"><a class="header" href="#-security">🔒 Security</a></h3>
<p>Security is a critical aspect of an email client. The application implements:</p>
<ul>
<li>🔐 <strong>Data Encryption</strong>:
<ul>
<li>End-to-end encryption using OpenPGP (via the <code>legacy/crypto-openpgp</code> module)</li>
<li>Classes like <code>EncryptionDetector</code> and <code>OpenPgpEncryptionExtractor</code> handle encrypted emails</li>
<li>Local storage encryption for sensitive data like account credentials</li>
</ul>
</li>
<li>🔑 <strong>Authentication</strong>:
<ul>
<li>Support for various authentication types (OAuth, password, client certificate)</li>
<li>Secure token storage and management</li>
<li>Authentication error handling and recovery</li>
</ul>
</li>
<li>🛡️ <strong>Network Security</strong>:
<ul>
<li>TLS for all network connections with certificate validation</li>
<li>Certificate pinning for critical connections</li>
<li>Protection against MITM attacks</li>
</ul>
</li>
</ul>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>This section is a work in progress. The security architecture is being developed and will be documented in detail
as it evolves.</p>
</div>
<h4 id="-how-to-implement-security"><a class="header" href="#-how-to-implement-security">🛠️ How to Implement Security</a></h4>
<p>When implementing security features in your code:</p>
<ol>
<li>
<p><strong>Never store sensitive data in plain text</strong>:</p>
<pre><code class="language-kotlin">// Bad - storing password in plain text
sharedPreferences.putString("password", password)

// Good - use the secure credential storage
val credentialStorage = get&lt;CredentialStorage&gt;()
credentialStorage.storeCredentials(accountUuid, credentials)
</code></pre>
</li>
<li>
<p><strong>Use encryption for sensitive data</strong>:</p>
<pre><code class="language-kotlin">// For data that needs to be stored encrypted
val encryptionManager = get&lt;EncryptionManager&gt;()
val encryptedData = encryptionManager.encrypt(sensitiveData)
database.storeEncryptedData(encryptedData)
</code></pre>
</li>
<li>
<p><strong>Validate user input</strong> to prevent injection attacks:</p>
<pre><code class="language-kotlin">// Validate input before using it
if (!InputValidator.isValidEmailAddress(userInput)) {
    throw ValidationError("Invalid email address")
}
</code></pre>
</li>
<li>
<p><strong>Use secure network connections</strong>:</p>
<pre><code class="language-kotlin">// The networking modules enforce TLS by default
// Make sure to use the provided clients rather than creating your own
val networkClient = get&lt;NetworkClient&gt;()
</code></pre>
</li>
</ol>
<h2 id="-testing-strategy"><a class="header" href="#-testing-strategy">🧪 Testing Strategy</a></h2>
<p>The architecture supports comprehensive testing:</p>
<ul>
<li><strong>🔬 Unit Tests</strong>: Test individual components in isolation</li>
<li><strong>🔌 Integration Tests</strong>: Test interactions between components</li>
<li><strong>📱 UI Tests</strong>: Test the UI behavior and user flows</li>
</ul>
<p>See the <a href="architecture/../contributing/testing-guide.html">Testing guide</a> document for more details on how to write and run tests
for the application.</p>
<h2 id="-legacy-integration"><a class="header" href="#-legacy-integration">🔙 Legacy Integration</a></h2>
<p>The application includes legacy code that is gradually being migrated to the new architecture:</p>
<ul>
<li><strong>📦 Legacy Modules</strong>: Contain code from the original K-9 Mail application</li>
<li><strong>🔄 Migration Strategy</strong>: Gradual migration to the new architecture</li>
<li><strong>🔌 Integration Points</strong>: Clear interfaces between legacy and new code</li>
</ul>
<p>For more details on the legacy integration, see the <a href="architecture/legacy-module-integration.html">Legacy Integration</a> document.</p>
<h2 id="-user-flows"><a class="header" href="#-user-flows">🔄 User Flows</a></h2>
<p>The <a href="architecture/user-flows.html">User Flows</a> provides visual representations of typical user flows through the application, helping to understand how different components interact.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-module-organization"><a class="header" href="#-module-organization">📦 Module Organization</a></h1>
<p>The Thunderbird for Android project is following a modularization approach, where the codebase is divided into multiple
distinct modules. These modules encapsulate specific functionality and can be developed, tested, and maintained
independently. This modular architecture promotes reusability, scalability, and maintainability of the codebase.</p>
<p>This document outlines the adopted module organization for the Thunderbird for Android project, serving as a guide for
developers to understand the codebase structure and ensure consistent architectural patterns.</p>
<h2 id="-module-overview"><a class="header" href="#-module-overview">📂 Module Overview</a></h2>
<p>The modules are organized into several types, each serving a specific purpose in the overall architecture:</p>
<pre class="mermaid">graph TB
    subgraph APP[App Modules]
        direction TB
        APP_TB[&quot;`**:app-thunderbird**&lt;br&gt;Thunderbird for Android`&quot;]
        APP_K9[&quot;`**:app-k9mail**&lt;br&gt;K-9 Mail`&quot;]
    end

    subgraph COMMON[App Common Module]
        direction TB
        COMMON_APP[&quot;`**:app-common**&lt;br&gt;Integration Code`&quot;]
    end

    subgraph FEATURE[Feature Modules]
        direction TB
        FEATURE_ACCOUNT[&quot;`**:feature:account**`&quot;]
        FEATURE_SETTINGS[&quot;`**:feature:settings**`&quot;]
        FEATURE_ONBOARDING[&quot;`**:feature:onboarding**`&quot;]
        FEATURE_MAIL[&quot;`**:feature:mail**`&quot;]
    end

    subgraph CORE[Core Modules]
        direction TB
        CORE_UI[&quot;`**:core:ui**`&quot;]
        CORE_COMMON[&quot;`**:core:common**`&quot;]
        CORE_ANDROID[&quot;`**:core:android**`&quot;]
        CORE_NETWORK[&quot;`**:core:network**`&quot;]
        CORE_DATABASE[&quot;`**:core:database**`&quot;]
        CORE_TESTING[&quot;`**:core:testing**`&quot;]
    end

    subgraph LIBRARY[Library Modules]
        direction TB
        LIB_AUTH[&quot;`**:library:auth**`&quot;]
        LIB_CRYPTO[&quot;`**:library:crypto**`&quot;]
        LIB_STORAGE[&quot;`**:library:storage**`&quot;]
    end

    subgraph LEGACY[Legacy Modules]
        direction TB
        LEGACY_K9[&quot;`**:legacy**`&quot;]
        LEGACY_MAIL[&quot;`**:mail**`&quot;]
        LEGACY_BACKEND[&quot;`**:backend**`&quot;]
    end

    APP ~~~ COMMON
    COMMON ~~~ FEATURE
    FEATURE ~~~ CORE
    CORE ~~~ LIBRARY
    LIBRARY ~~~ LEGACY

    APP --&gt; |depends on| COMMON
    COMMON --&gt; |depends on| FEATURE
    FEATURE --&gt; |depends on| CORE
    CORE --&gt; |depends on| LIBRARY
    COMMON --&gt; |depends on&lt;br&gt;as legacy bridge| LEGACY

    classDef app fill:#d9e9ff,stroke:#000000,color:#000000
    classDef app_module fill:#4d94ff,stroke:#000000,color:#000000
    classDef common fill:#e6e6e6,stroke:#000000,color:#000000
    classDef common_module fill:#999999,stroke:#000000,color:#000000
    classDef feature fill:#d9ffd9,stroke:#000000,color:#000000
    classDef feature_module fill:#33cc33,stroke:#000000,color:#000000
    classDef core fill:#e6cce6,stroke:#000000,color:#000000
    classDef core_module fill:#cc99cc,stroke:#000000,color:#000000
    classDef library fill:#fff0d0,stroke:#000000,color:#000000
    classDef library_module fill:#ffaa33,stroke:#000000,color:#000000
    classDef legacy fill:#ffe6e6,stroke:#000000,color:#000000
    classDef legacy_module fill:#ff9999,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px
    linkStyle 0,1,2,3,4 stroke-width:0px

    class APP app
    class APP_TB,APP_K9 app_module
    class COMMON common
    class COMMON_APP common_module
    class FEATURE feature
    class FEATURE_ACCOUNT,FEATURE_SETTINGS,FEATURE_ONBOARDING,FEATURE_MAIL feature_module
    class CORE core
    class CORE_UI,CORE_COMMON,CORE_ANDROID,CORE_DATABASE,CORE_NETWORK,CORE_TESTING core_module
    class LIBRARY library
    class LIB_AUTH,LIB_CRYPTO,LIB_STORAGE library_module
    class LEGACY legacy
    class LEGACY_MAIL,LEGACY_BACKEND,LEGACY_K9 legacy_module
</pre>
<h3 id="module-types"><a class="header" href="#module-types">Module Types</a></h3>
<h4 id="-app-modules"><a class="header" href="#-app-modules">📱 App Modules</a></h4>
<p>The App Modules (<code>app-thunderbird</code> and <code>app-k9mail</code>) contain the application-specific code, including:</p>
<ul>
<li>Application entry points and initialization logic</li>
<li>Final dependency injection setup</li>
<li>Navigation configuration</li>
<li>Integration with feature modules solely for that application</li>
<li>App-specific themes and resources (strings, themes, etc.)</li>
</ul>
<h4 id="-app-common-module"><a class="header" href="#-app-common-module">🔄 App Common Module</a></h4>
<p>The <code>app-common</code> module acts as the central hub for shared code between both applications. This module serves as the
primary “glue” that binds various <code>feature</code> modules together, providing a seamless integration point. It also contains:</p>
<ul>
<li>Shared application logic</li>
<li>Feature coordination</li>
<li>Common dependency injection setup</li>
<li>Legacy code bridges and adapters</li>
</ul>
<h5 id="what-should-go-in-app-common"><a class="header" href="#what-should-go-in-app-common">What Should Go in App Common</a></h5>
<p>The app-common module should contain:</p>
<ol>
<li><strong>Shared Application Logic</strong>: Code that’s needed by both app modules but isn’t specific to any one feature.
<ul>
<li>Example: <code>BaseApplication</code> provides common application initialization, language management, and theme setup.</li>
<li>This avoids duplication between app-thunderbird and app-k9mail.</li>
</ul>
</li>
<li><strong>Feature Integration Code</strong>: Code that connects different features together.
<ul>
<li>Example: Code that coordinates between account and mail features.</li>
<li>This maintains separation between features while allowing them to work together.</li>
</ul>
</li>
<li><strong>Common Dependency Injection Setup</strong>: Koin modules that configure dependencies shared by both applications.
<ul>
<li>Example: <code>AppCommonModule</code> includes legacy modules and app-common specific modules.</li>
<li>This ensures consistent dependency configuration across both applications.</li>
</ul>
</li>
<li><strong>Legacy Code Bridges/Adapters</strong>: Implementations of interfaces defined in feature modules that delegate to legacy code.
<ul>
<li>Example: <code>DefaultAccountProfileLocalDataSource</code> implements <code>AccountProfileLocalDataSource</code> from <code>feature:account:core</code> and delegates to legacy account code.</li>
<li>These bridges isolate legacy code and prevent direct dependencies on it from feature modules.</li>
</ul>
</li>
</ol>
<h5 id="what-should-not-go-in-app-common"><a class="header" href="#what-should-not-go-in-app-common">What Should NOT Go in App Common</a></h5>
<p>The following should NOT be placed in app-common:</p>
<ol>
<li><strong>Feature-Specific Business Logic</strong>: Business logic that belongs to a specific feature domain should be in that feature’s module.
<ul>
<li>Example: Mail composition logic should be in <code>feature:mail</code>, not in app-common.</li>
<li>This maintains clear separation of concerns and feature independence.</li>
</ul>
</li>
<li><strong>UI Components</strong>: UI components should be in core:ui or in feature modules.
<ul>
<li>Example: A custom button component should be in core:ui, while a mail-specific UI component should be in feature:mail.</li>
<li>This ensures proper layering and reusability.</li>
</ul>
</li>
<li><strong>Direct Legacy Code</strong>: Legacy code should remain in legacy modules, with app-common providing bridges.
<ul>
<li>Example: Don’t move legacy mail code into app-common; instead, create a bridge in app-common.</li>
<li>This maintains the separation between legacy and modern code.</li>
</ul>
</li>
<li><strong>New Feature Implementations</strong>: New features should be implemented in feature modules, not in app-common.
<ul>
<li>Example: A new calendar feature should be in <code>feature:calendar</code>, not in app-common.</li>
<li>This ensures features can evolve independently.</li>
</ul>
</li>
</ol>
<h5 id="decision-criteria-for-new-contributors"><a class="header" href="#decision-criteria-for-new-contributors">Decision Criteria for New Contributors</a></h5>
<p>When deciding whether code belongs in app-common or a feature module, consider:</p>
<ol>
<li><strong>Is it shared between both applications?</strong> If yes, it might belong in app-common.</li>
<li><strong>Is it specific to a single feature domain?</strong> If yes, it belongs in that feature module.</li>
<li><strong>Does it bridge to legacy code?</strong> If yes, it belongs in app-common.</li>
<li><strong>Does it coordinate between multiple features?</strong> If yes, it might belong in app-common.</li>
<li><strong>Is it a new feature implementation?</strong> If yes, create a new feature module instead.</li>
</ol>
<p>Remember that app-common should primarily contain integration code, shared application logic, and bridges to legacy code. Feature-specific logic should be in feature modules, even if used by both applications.</p>
<h4 id="-feature-modules"><a class="header" href="#-feature-modules">✨ Feature Modules</a></h4>
<p>The <code>feature:*</code> modules are independent and encapsulate distinct user-facing feature domains. They are designed to be
reusable and can be integrated into any application module as needed.</p>
<p>Feature implementation modules (e.g., <code>:feature:account:impl</code>) should ideally not depend directly on other feature
implementation modules. Instead, they should depend on the public <code>:api</code> module of other features (e.g.,
<code>:feature:someOtherFeature:api</code>) to access their functionality through defined contracts, see
<a href="architecture/module-structure.html#-api-module">module structure</a> for more details.</p>
<p>When features are complex, they can be split into smaller sub feature modules, addressing specific aspects or
functionality within a feature domain:</p>
<ul>
<li><code>:feature:account:api</code>: Public interfaces for account management</li>
<li><code>:feature:account:settings:api</code>: Public interfaces for account settings</li>
<li><code>:feature:account:settings:impl</code>: Concrete implementations of account settings</li>
</ul>
<h4 id="-core-modules"><a class="header" href="#-core-modules">🧰 Core Modules</a></h4>
<p>The <code>core:*</code> modules contain foundational functionality used across the application:</p>
<ul>
<li><strong>core:ui</strong>: UI components, themes, and utilities</li>
<li><strong>core:common</strong>: Common utilities and extensions</li>
<li><strong>core:network</strong>: Networking utilities and API client infrastructure</li>
<li><strong>core:database</strong>: Database infrastructure and utilities</li>
<li><strong>core:testing</strong>: Testing utilities</li>
</ul>
<p>Core modules should only contain generic, reusable components that have no specific business logic.
Business objects (e.g., account, mail, etc.) should live in their respective feature modules.</p>
<h4 id="-library-modules"><a class="header" href="#-library-modules">📚 Library Modules</a></h4>
<p>The <code>library:*</code> modules are for specific implementations that might be used across various features or applications.
They could be third-party integrations or complex utilities and eventually shared across multiple projects.</p>
<h4 id="-legacy-modules"><a class="header" href="#-legacy-modules">🔙 Legacy Modules</a></h4>
<p>The <code>legacy:*</code> modules that are still required for the project to function, but don’t follow the new project structure.
These modules should not be used for new development. The goal is to migrate the functionality of these modules to the
new structure over time.</p>
<p>Similarly the <code>mail:*</code> and <code>backend:*</code> modules are legacy modules that contain the old mail and backend implementations.
These modules are being gradually replaced by the new feature modules.</p>
<p>The <code>legacy</code> modules are integrated into the <code>app-common</code> module, allowing them to be used by other parts of the app.
The glue code for bridging legacy code to the new modular architecture is also located in the <code>app-common</code> module. See
<a href="architecture/legacy-module-integration.html">module legacy integration</a> for more details.</p>
<h2 id="-module-dependencies"><a class="header" href="#-module-dependencies">🔗 Module Dependencies</a></h2>
<p>The module dependency diagram below illustrates how different modules interact with each other in the project,
showing the dependencies and integration points between modules:</p>
<ul>
<li><strong>App Modules</strong>: Depend on the App Common module for shared functionality and selectively integrate feature modules</li>
<li><strong>App Common</strong>: Integrates various feature modules to provide a cohesive application</li>
<li><strong>Feature Modules</strong>: Use core modules and libraries for their implementation, may depend on other feature api modules</li>
<li><strong>App-Specific Features</strong>: Some features are integrated directly by specific apps (K-9 Mail or Thunderbird)</li>
</ul>
<p>Rules for module dependencies:</p>
<ul>
<li><strong>One-Way Dependencies</strong>: Modules should not depend on each other in a circular manner</li>
<li><strong>API-Implementation Separation</strong>: Modules should depend on <code>api</code> modules, not <code>implementation</code> modules, see <a href="architecture/module-structure.html#module-structure">module structure</a></li>
<li><strong>Feature Integration</strong>: Features should be integrated through the <code>app-common</code> module, which acts as the central integration hub</li>
<li><strong>Dependency Direction</strong>: Dependencies should flow from app modules to common, then to features, and finally to core and libraries</li>
</ul>
<pre class="mermaid">graph TB
    subgraph APP[App Modules]
        direction TB
        APP_TB[&quot;`**:app-thunderbird**&lt;br&gt;Thunderbird for Android`&quot;]
        APP_K9[&quot;`**:app-k9mail**&lt;br&gt;K-9 Mail`&quot;]
    end

    subgraph COMMON[App Common Module]
        direction TB
        COMMON_APP[&quot;`**:app-common**&lt;br&gt;Integration Code`&quot;]
    end

    subgraph FEATURE[Feature Modules]
        direction TB
        FEATURE_ACCOUNT_API[&quot;`**:feature:account:api**`&quot;]
        FEATURE_ACCOUNT_IMPL[&quot;`**:feature:account:impl**`&quot;]
        FEATURE_SETTINGS_API[&quot;`**:feature:settings:api**`&quot;]
        FEATURE_K9[&quot;`**:feature:k9OnlyFeature:impl**`&quot;]
        FEATURE_TB[&quot;`**:feature:tfaOnlyFeature:impl**`&quot;]
    end

    subgraph CORE[Core Modules]
        direction TB
        CORE_UI_API[&quot;`**:core:ui:api**`&quot;]
        CORE_COMMON_API[&quot;`**:core:common:api**`&quot;]
    end

    subgraph LIBRARY[Library Modules]
        direction TB
        LIB_AUTH[&quot;`**:library:auth**`&quot;]
        LIB_STORAGE[&quot;`**:library:storage**`&quot;]
    end

    APP_K9 --&gt; |depends on| COMMON_APP
    APP_TB --&gt; |depends on| COMMON_APP
    COMMON_APP --&gt; |uses| FEATURE_ACCOUNT_API
    COMMON_APP --&gt; |injects/uses impl of| FEATURE_ACCOUNT_IMPL
    FEATURE_ACCOUNT_IMPL --&gt; FEATURE_ACCOUNT_API
    COMMON_APP --&gt; |uses| FEATURE_SETTINGS_API
    APP_K9 --&gt; |injects/uses impl of| FEATURE_K9
    APP_TB --&gt; |injects/uses impl of| FEATURE_TB
    FEATURE_ACCOUNT_API --&gt; |uses| CORE_UI_API
    FEATURE_SETTINGS_API --&gt; |uses| CORE_COMMON_API
    FEATURE_TB --&gt; |uses| LIB_AUTH
    FEATURE_K9 --&gt; |uses| LIB_STORAGE
    CORE_COMMON_API --&gt; |uses| LIB_STORAGE

    classDef app fill:#d9e9ff,stroke:#000000,color:#000000
    classDef app_module fill:#4d94ff,stroke:#000000,color:#000000
    classDef common fill:#e6e6e6,stroke:#000000,color:#000000
    classDef common_module fill:#999999,stroke:#000000,color:#000000
    classDef feature fill:#d9ffd9,stroke:#000000,color:#000000
    classDef feature_module fill:#33cc33,stroke:#000000,color:#000000
    classDef core fill:#e6cce6,stroke:#000000,color:#000000
    classDef core_module fill:#cc99cc,stroke:#000000,color:#000000
    classDef library fill:#fff0d0,stroke:#000000,color:#000000
    classDef library_module fill:#ffaa33,stroke:#000000,color:#000000
    classDef legacy fill:#ffe6e6,stroke:#000000,color:#000000
    classDef legacy_module fill:#ff9999,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class APP app
    class APP_TB,APP_K9 app_module
    class COMMON common
    class COMMON_APP common_module
    class FEATURE feature
    class FEATURE_ACCOUNT_API,FEATURE_ACCOUNT_IMPL,FEATURE_SETTINGS_API,FEATURE_MAIL feature_module
    class CORE core
    class CORE_UI_API,CORE_COMMON_API core_module
    class LIBRARY library
    class LIB_AUTH,LIB_STORAGE library_module

    classDef featureK9 fill:#ffcccc,stroke:#cc0000,color:#000000
    classDef featureTB fill:#ccccff,stroke:#0000cc,color:#000000
    class FEATURE_K9 featureK9
    class FEATURE_TB featureTB
</pre>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-module-structure-1"><a class="header" href="#-module-structure-1">📦 Module Structure</a></h1>
<p>The Thunderbird for Android project is following a modularization approach, where the codebase is divided into multiple
distinct modules. These modules encapsulate specific functionality and can be developed, tested, and maintained
independently. This modular architecture promotes reusability, scalability, and maintainability of the codebase.</p>
<p>Each module should be split into two main parts: <strong>API</strong> and <strong>implementation</strong>. This separation provides clear
boundaries between what a module exposes to other modules and how it implements its functionality internally.</p>
<p>When a feature is complex, it can be further split into sub modules, allowing for better organization and smaller modules
for distinct functionalities within a feature domain.</p>
<p>This approach promotes:</p>
<ul>
<li><strong>Loose coupling</strong>: Modules interact through well-defined interfaces</li>
<li><strong>Interchangeable implementations</strong>: Different implementations can be swapped without affecting consumers</li>
<li><strong>Improved build times</strong>: Reduces the scope of recompilation when changes are made</li>
<li><strong>Better testability</strong>: Modules can be tested in isolation</li>
<li><strong>Clear ownership</strong>: Teams can own specific modules</li>
</ul>
<h3 id="-api-module"><a class="header" href="#-api-module">📝 API Module</a></h3>
<p>The API module defines the public contract that other modules can depend on. It should be stable, well-documented, and
change infrequently.</p>
<p>The API module contains:</p>
<ul>
<li><strong>Public interfaces</strong>: Contracts that define the module’s capabilities</li>
<li><strong>Data models</strong>: Entities that are part of the public API</li>
<li><strong>Constants and enums</strong>: Shared constants and enumeration types</li>
<li><strong>Extension functions</strong>: Utility functions that extend public types</li>
<li><strong>Navigation definitions</strong>: Navigation routes and arguments</li>
</ul>
<p>The API module should be minimal and focused on defining the contract that other modules can depend on. It should not
contain any implementation details.</p>
<h4 id="naming-convention"><a class="header" href="#naming-convention">Naming Convention</a></h4>
<p>API modules should follow the naming convention:</p>
<ul>
<li><code>feature:&lt;feature-name&gt;:api</code> for feature modules</li>
<li><code>core:&lt;core-name&gt;:api</code> for core modules</li>
</ul>
<h4 id="example-structure-for-a-feature-api-module"><a class="header" href="#example-structure-for-a-feature-api-module">Example structure for a feature API module:</a></h4>
<pre><code class="language-bash">feature:account:api
├── src/main/kotlin/net/thunderbird/feature/account/api
│   ├── AccountManager.kt (interface)
│   ├── Account.kt (entity)
│   ├── AccountNavigation.kt (interface)
│   ├── AccountType.kt (entity)
│   └── AccountExtensions.kt (extension functions)
</code></pre>
<h4 id="api-design-guidelines"><a class="header" href="#api-design-guidelines">API Design Guidelines</a></h4>
<p>When designing APIs, follow these principles:</p>
<ul>
<li><strong>Minimal surface area</strong>: Expose only what is necessary</li>
<li><strong>Immutable data</strong>: Use immutable data structures where possible</li>
<li><strong>Clear contracts</strong>: Define clear method signatures with documented parameters and return values</li>
<li><strong>Error handling</strong>: Define how errors are communicated (exceptions, result types, etc.)</li>
</ul>
<h3 id="-implementation-module"><a class="header" href="#-implementation-module">⚙️ Implementation Module</a></h3>
<p>The implementation module depends on the API module but should not be depended upon by other modules (except for
dependency injection setup).</p>
<p>The implementation module contains:</p>
<ul>
<li><strong>Interface implementations</strong>: Concrete implementations of the interfaces defined in the API module</li>
<li><strong>Internal components</strong>: Classes and functions used internally</li>
<li><strong>Data sources</strong>: Repositories, database access, network clients</li>
<li><strong>UI components</strong>: Screens, composables, and ViewModels</li>
</ul>
<h4 id="naming-convention-1"><a class="header" href="#naming-convention-1">Naming Convention</a></h4>
<p>Implementation modules should follow the naming convention:</p>
<ul>
<li><code>feature:&lt;feature-name&gt;:impl</code> for standard implementations</li>
<li><code>feature:&lt;feature-name&gt;:impl-&lt;variant&gt;</code> for variant-specific implementations</li>
<li><code>core:&lt;core-name&gt;:impl</code> for core module implementations</li>
</ul>
<h4 id="multiple-implementations"><a class="header" href="#multiple-implementations">Multiple Implementations</a></h4>
<p>When multiple implementations are needed, such as for different providers or platforms, they can be placed in separate
modules and named accordingly:</p>
<ul>
<li><code>feature:account:impl-gmail</code> - Gmail-specific implementation</li>
<li><code>feature:account:impl-yahoo</code> - Yahoo-specific implementation</li>
<li><code>feature:account:impl-noop</code> - No-operation implementation for testing</li>
</ul>
<h4 id="example-structure-for-a-variant-implementation"><a class="header" href="#example-structure-for-a-variant-implementation">Example structure for a variant implementation:</a></h4>
<pre><code class="language-bash">feature:account:impl-gmail
├── src/main/kotlin/app/thunderbird/feature/account/gmail
│   └── GmailAccountManager.kt
</code></pre>
<h4 id="clean-architecture-in-implementation-modules"><a class="header" href="#clean-architecture-in-implementation-modules">Clean Architecture in Implementation Modules</a></h4>
<p>A complex feature implementation module should apply <strong>Clean Architecture</strong> principles, separating concerns into:</p>
<ul>
<li><strong>UI Layer</strong>: Compose UI components, ViewModels, and UI state management</li>
<li><strong>Domain Layer</strong>: Use cases, domain models, and business logic</li>
<li><strong>Data Layer</strong>: Repositories, data sources, and data mapping</li>
</ul>
<pre><code class="language-bash">feature:account:impl
├── src/main/kotlin/app/thunderbird/feature/account/impl
│   ├── data/
│   │   ├── repository/
│   │   ├── datasource/
│   │   └── mapper/
│   ├── domain/
│   │   ├── repository/
│   │   ├── entity/
│   │   └── usecase/
│   └── ui/
│       ├── AccountScreen.kt
│       └── AccountViewModel.kt
</code></pre>
<h4 id="implementation-best-practices"><a class="header" href="#implementation-best-practices">Implementation Best Practices</a></h4>
<ul>
<li><strong>Internal visibility</strong>: Use the <code>internal</code> modifier for classes and functions that should not be part of the public API</li>
<li><strong>Encapsulation</strong>: Keep implementation details hidden from consumers</li>
<li><strong>Testability</strong>: Design implementations to be easily testable</li>
<li><strong>Dependency injection</strong>: Use constructor injection for dependencies</li>
<li><strong>Error handling</strong>: Implement robust error handling according to API contracts</li>
<li><strong>Performance</strong>: Consider performance implications of implementations</li>
<li><strong>Logging</strong>: Include appropriate logging for debugging and monitoring</li>
</ul>
<h3 id="-testing-module"><a class="header" href="#-testing-module">🧪 Testing Module</a></h3>
<p>Testing modules provide test implementations, utilities, and frameworks for testing other modules. They are essential for ensuring the quality and correctness of the codebase.</p>
<h4 id="contents"><a class="header" href="#contents">Contents</a></h4>
<p>The testing module contains:</p>
<ul>
<li><strong>Test utilities</strong>: Helper functions and classes for testing</li>
<li><strong>Test frameworks</strong>: Custom test frameworks and extensions</li>
<li><strong>Test fixtures</strong>: Reusable test setups and teardowns</li>
<li><strong>Test matchers</strong>: Custom matchers for assertions</li>
</ul>
<h4 id="naming-convention-2"><a class="header" href="#naming-convention-2">Naming Convention</a></h4>
<p>Testing modules should follow the naming convention:</p>
<ul>
<li><code>feature:&lt;feature-name&gt;:testing</code> for feature-specific test utilities</li>
<li><code>core:&lt;core-name&gt;:testing</code> for core test utilities</li>
<li><code>&lt;module-name&gt;:test</code> for module-specific tests</li>
</ul>
<h4 id="example-structure-for-a-testing-module"><a class="header" href="#example-structure-for-a-testing-module">Example structure for a testing module:</a></h4>
<pre><code class="language-bash">feature:account:testing
├── src/main/kotlin/app/thunderbird/feature/account/testing
│   ├── AccountTestUtils.kt
│   └── AccountTestMatchers.kt
</code></pre>
<h4 id="testing-best-practices"><a class="header" href="#testing-best-practices">Testing Best Practices</a></h4>
<ul>
<li><strong>Reusability</strong>: Create reusable test utilities and data factories</li>
<li><strong>Isolation</strong>: Tests should be isolated and not depend on external systems</li>
<li><strong>Readability</strong>: Tests should be easy to read and understand</li>
<li><strong>Maintainability</strong>: Tests should be easy to maintain and update</li>
<li><strong>Coverage</strong>: Tests should cover all critical paths and edge cases</li>
</ul>
<h3 id="-fake-module"><a class="header" href="#-fake-module">🤖 Fake Module</a></h3>
<p>Fake modules provide alternative implementations of interfaces for testing, development, or demonstration purposes. They are simpler than the real implementations and are designed to be used in controlled environments.</p>
<h4 id="contents-1"><a class="header" href="#contents-1">Contents</a></h4>
<p>The fake module contains:</p>
<ul>
<li><strong>Fake implementations</strong>: Simplified implementations of interfaces</li>
<li><strong>Generic test data</strong>: Basic, reusable sample data for testing and demonstration</li>
<li><strong>In-memory data stores</strong>: In-memory alternatives to real data stores</li>
<li><strong>Controlled behavior</strong>: Implementations with predictable, configurable behavior</li>
<li><strong>Test doubles</strong>: Mocks, stubs, and spies for testing</li>
</ul>
<div class="mdbook-alerts mdbook-alerts-important">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  important
</p>
<p>Fake modules should be limited to the most generic data and implementations. Specific use cases or test setups should be part of the actual test, not the fake module.</p>
</div>
<h4 id="naming-convention-3"><a class="header" href="#naming-convention-3">Naming Convention</a></h4>
<p>Fake modules should follow the naming convention:</p>
<ul>
<li><code>feature:&lt;feature-name&gt;:fake</code> for feature-specific fake implementations</li>
<li><code>core:&lt;core-name&gt;:fake</code> for core fake implementations</li>
</ul>
<h4 id="example-structure-for-a-fake-module"><a class="header" href="#example-structure-for-a-fake-module">Example structure for a fake module:</a></h4>
<pre><code class="language-bash">feature:account:fake
├── src/main/kotlin/app/thunderbird/feature/account/fake
│   ├── FakeAccountRepository.kt
│   ├── FakeAccountDataSource.kt
│   ├── InMemoryAccountStore.kt
│   ├── FakeAccountManager.kt
│   └── data/
│       ├── FakeAccountData.kt
│       └── FakeAccountProfileData.kt
</code></pre>
<h4 id="fake-implementation-best-practices"><a class="header" href="#fake-implementation-best-practices">Fake Implementation Best Practices</a></h4>
<ul>
<li><strong>Simplicity</strong>: Fake implementations should be simpler than real implementations</li>
<li><strong>Deterministic behavior</strong>: Behavior should be predictable and controllable</li>
<li><strong>Configuration</strong>: Allow configuration of behavior for different test scenarios</li>
<li><strong>Visibility</strong>: Make internal state visible for testing assertions</li>
<li><strong>Performance</strong>: Fake implementations should be fast for testing efficiency</li>
<li><strong>Generic test data</strong>: Include basic, reusable test data that can be used across different tests</li>
<li><strong>Realistic but generic data</strong>: Test data should be realistic enough to be useful but generic enough to be reused</li>
<li><strong>Separation of concerns</strong>: Keep specific test scenarios and edge cases in the actual tests, not in the fake module</li>
</ul>
<h3 id="-common-module"><a class="header" href="#-common-module">🔄 Common Module</a></h3>
<p>Common modules provide shared functionality that is used by multiple modules within a feature. They contain
implementation details, utilities, and components that need to be shared between related modules but are not part of
the public API.</p>
<h4 id="contents-2"><a class="header" href="#contents-2">Contents</a></h4>
<p>The common module contains:</p>
<ul>
<li><strong>Shared utilities</strong>: Helper functions and classes used across related modules</li>
<li><strong>Internal implementations</strong>: Implementation details shared between modules</li>
<li><strong>Shared UI components</strong>: Reusable UI components specific to a feature domain</li>
<li><strong>Data repositories</strong>: Shared data storage and access implementations</li>
<li><strong>Constants and resources</strong>: Shared constants, strings, and other resources</li>
</ul>
<h4 id="naming-convention-4"><a class="header" href="#naming-convention-4">Naming Convention</a></h4>
<p>Common modules should follow the naming convention:</p>
<ul>
<li><code>feature:&lt;feature-name&gt;:common</code> for feature-specific common code</li>
<li><code>core:&lt;core-name&gt;:common</code> for core common code</li>
</ul>
<h4 id="example-structure-for-a-common-module"><a class="header" href="#example-structure-for-a-common-module">Example structure for a common module:</a></h4>
<pre><code class="language-bash">feature:account:common
├── src/main/kotlin/net/thunderbird/feature/account/common
│   ├── AccountCommonModule.kt
│   ├── data/
│   │   └── InMemoryAccountStateRepository.kt
│   ├── domain/
│   │   ├── AccountDomainContract.kt
│   │   ├── input/
│   │   │   └── NumberInputField.kt
│   │   └── entity/
│   │       ├── AccountState.kt
│   │       ├── AccountDisplayOptions.kt
│   │       └── AuthorizationState.kt
│   └── ui/
│       ├── WizardNavigationBar.kt
│       └── WizardNavigationBarState.kt
</code></pre>
<h4 id="common-module-best-practices"><a class="header" href="#common-module-best-practices">Common Module Best Practices</a></h4>
<ul>
<li><strong>Internal visibility</strong>: Use the <code>internal</code> modifier for classes and functions that should not be part of the public API</li>
<li><strong>Clear organization</strong>: Organize code into data, domain, and UI packages for better maintainability</li>
<li><strong>Shared contracts</strong>: Define clear interfaces for functionality that will be implemented by multiple modules</li>
<li><strong>Reusable components</strong>: Create UI components that can be reused across different screens within a feature</li>
<li><strong>Stateless where possible</strong>: Design components to be stateless and receive state through parameters</li>
<li><strong>Minimal dependencies</strong>: Keep dependencies to a minimum to avoid transitive dependency issues</li>
<li><strong>Documentation</strong>: Document the purpose and usage of shared components</li>
<li><strong>Avoid leaking implementation details</strong>: Don’t expose implementation details that could create tight coupling</li>
</ul>
<h2 id="-module-dependencies-1"><a class="header" href="#-module-dependencies-1">🔗 Module Dependencies</a></h2>
<p>The module dependency diagram below illustrates how different modules interact with each other in the project, showing
the dependencies and integration points between modules.</p>
<pre class="mermaid">graph TB
    subgraph APP[App Modules]
        direction TB
        APP_TB[&quot;`**:app-thunderbird**&lt;br&gt;Thunderbird for Android`&quot;]
        APP_K9[&quot;`**:app-k9mail**&lt;br&gt;K-9 Mail`&quot;]
    end

    subgraph COMMON[App Common Module]
        direction TB
        COMMON_APP[&quot;`**:app-common**&lt;br&gt;Integration Code`&quot;]
    end

    subgraph FEATURE[Feature]
        direction TB
        FEATURE1[feature:account:api]
        FEATURE2[feature:account:impl]
        FEATURE3[Feature 2]
        FEATURE_K9[Feature K-9 Only]
        FEATURE_TB[Feature TfA Only]
    end

    subgraph CORE[Core]
        direction TB
        CORE1[Core 1]
        CORE2[Core 2]
    end

    subgraph LIBRARY[Library]
        direction TB
        LIB1[Library 1]
        LIB2[Library 2]
    end

    APP_K9 --&gt; |depends on| COMMON_APP
    APP_TB --&gt; |depends on| COMMON_APP
    COMMON_APP --&gt; |integrates| FEATURE1
    COMMON_APP --&gt; |injects| FEATURE2
    FEATURE2 --&gt; FEATURE1
    COMMON_APP --&gt; |integrates| FEATURE3
    APP_K9 --&gt; |integrates| FEATURE_K9
    APP_TB --&gt; |integrates| FEATURE_TB
    FEATURE1 --&gt; |uses| CORE1
    FEATURE3 --&gt; |uses| CORE2
    FEATURE_TB --&gt; |uses| CORE1
    FEATURE_K9 --&gt; |uses| LIB2
    CORE2 --&gt; |uses| LIB1

    classDef app fill:#d9e9ff,stroke:#000000,color:#000000
    classDef app_module fill:#4d94ff,stroke:#000000,color:#000000
    classDef common fill:#e6e6e6,stroke:#000000,color:#000000
    classDef common_module fill:#999999,stroke:#000000,color:#000000
    classDef feature fill:#d9ffd9,stroke:#000000,color:#000000
    classDef feature_module fill:#33cc33,stroke:#000000,color:#000000
    classDef core fill:#e6cce6,stroke:#000000,color:#000000
    classDef core_module fill:#cc99cc,stroke:#000000,color:#000000
    classDef library fill:#fff0d0,stroke:#000000,color:#000000
    classDef library_module fill:#ffaa33,stroke:#000000,color:#000000
    classDef legacy fill:#ffe6e6,stroke:#000000,color:#000000
    classDef legacy_module fill:#ff9999,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class APP app
    class APP_K9,APP_TB app_module
    class COMMON common
    class COMMON_APP common_module
    class FEATURE feature
    class FEATURE1,FEATURE2,FEATURE3 feature_module
    class FEATURE_K9 featureK9
    class FEATURE_TB featureTB
    class CORE core
    class CORE1,CORE2 core_module
    class LIBRARY library
    class LIB1,LIB2 library_module
</pre>
<h3 id="module-interaction-patterns"><a class="header" href="#module-interaction-patterns">Module Interaction Patterns</a></h3>
<ul>
<li><strong>App Modules</strong>: Depend on the App Common module for shared functionality and selectively integrate feature modules</li>
<li><strong>App Common</strong>: Integrates various feature modules to provide a cohesive application</li>
<li><strong>Feature Modules</strong>: Use core modules and libraries for their implementation, may depend on other feature API modules</li>
<li><strong>App-Specific Features</strong>: Some features are integrated directly by specific apps (K-9 Mail or Thunderbird)</li>
</ul>
<h3 id="dependency-rules"><a class="header" href="#dependency-rules">Dependency Rules</a></h3>
<p>These rules must be strictly followed:</p>
<ol>
<li><strong>One-Way Dependencies</strong>:
<ul>
<li>Modules should not depend on each other in a circular manner</li>
<li>Dependencies should form a directed acyclic graph (DAG)</li>
</ul>
</li>
<li><strong>API-Implementation Separation</strong>:
<ul>
<li>Modules should depend only on API modules, not implementation modules</li>
<li>Implementation modules should be referenced only in dependency injection setup</li>
</ul>
</li>
<li><strong>Feature Integration</strong>:
<ul>
<li>Features should be integrated through the App Common module, which acts as a central hub</li>
<li>Direct dependencies between feature implementations should be avoided, or limited to API modules</li>
</ul>
</li>
<li><strong>Dependency Direction</strong>:
<ul>
<li>Dependencies should flow from app modules to common, then to features, and finally to core and libraries</li>
<li>Higher-level modules should depend on lower-level modules, not vice versa</li>
</ul>
</li>
<li><strong>Minimal Dependencies</strong>:
<ul>
<li>Each module should have the minimal set of dependencies required</li>
<li>Avoid unnecessary dependencies that could lead to bloat</li>
</ul>
</li>
</ol>
<h3 id="dependency-management"><a class="header" href="#dependency-management">Dependency Management</a></h3>
<ul>
<li><strong>Explicit Dependencies</strong>: All dependencies should be explicitly declared in the module’s build file</li>
<li><strong>Transitive Dependencies</strong>: Avoid relying on transitive dependencies</li>
<li><strong>Version Management</strong>: Use centralized version management for dependencies</li>
<li><strong>Dependency Visibility</strong>: Use appropriate visibility modifiers to limit access to implementation details</li>
</ul>
<h3 id="dependency-injection"><a class="header" href="#dependency-injection">Dependency Injection</a></h3>
<ul>
<li>Use Koin for dependency injection</li>
<li>Configure module dependencies in dedicated Koin modules</li>
<li>Inject API interfaces, not implementation classes</li>
<li>Use lazy injection where appropriate to improve startup performance</li>
</ul>
<h2 id="-module-granularity"><a class="header" href="#-module-granularity">📏 Module Granularity</a></h2>
<p>Determining the right granularity for modules is crucial for maintainability and scalability. This section provides
guidelines on when to create new modules and how to structure them.</p>
<h3 id="when-to-create-a-new-module"><a class="header" href="#when-to-create-a-new-module">When to Create a New Module</a></h3>
<p>Create a new module when:</p>
<ol>
<li><strong>Distinct Functionality</strong>: The code represents a distinct piece of functionality with clear boundaries</li>
<li><strong>Reusability</strong>: The functionality could be reused across multiple features or applications</li>
<li><strong>Build Performance</strong>: Breaking down large modules improves build performance</li>
<li><strong>Testing</strong>: Isolation improves testability</li>
</ol>
<h3 id="when-to-split-a-module"><a class="header" href="#when-to-split-a-module">When to Split a Module</a></h3>
<p>Split an existing module when:</p>
<ol>
<li><strong>Size</strong>: The module has grown too large (&gt;10,000 lines of code as a rough guideline)</li>
<li><strong>Complexity</strong>: The module has become too complex with many responsibilities</li>
<li><strong>Dependencies</strong>: The module has too many dependencies</li>
<li><strong>Build Time</strong>: The module takes too long to build</li>
</ol>
<h3 id="when-to-keep-modules-together"><a class="header" href="#when-to-keep-modules-together">When to Keep Modules Together</a></h3>
<p>Keep functionality in the same module when:</p>
<ol>
<li><strong>Cohesion</strong>: The functionality is highly cohesive and tightly coupled</li>
<li><strong>Small Size</strong>: The functionality is small and simple</li>
<li><strong>Single Responsibility</strong>: The functionality represents a single responsibility</li>
</ol>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-feature-modules-and-extensions"><a class="header" href="#-feature-modules-and-extensions">📦 Feature Modules and Extensions</a></h1>
<p>The Thunderbird for Android project is organized into multiple feature modules, each encapsulating a specific
functionality of the application. This document provides an overview of the main feature modules, how they are
split into subfeatures, and how the application can be extended with additional features.</p>
<h2 id="-feature-module-best-practices"><a class="header" href="#-feature-module-best-practices">📏 Feature Module Best Practices</a></h2>
<p>When developing new feature modules or extending existing ones, follow these best practices:</p>
<ol>
<li><strong>API-First Design</strong>: Define clear public interfaces before implementation</li>
<li><strong>Single Responsibility</strong>: Each feature module should have a single, well-defined responsibility</li>
<li><strong>Minimal Dependencies</strong>: Minimize dependencies between feature modules</li>
<li><strong>Proper Layering</strong>: Follow Clean Architecture principles within each feature</li>
<li><strong>Testability</strong>: Design features to be easily testable in isolation</li>
<li><strong>Documentation</strong>: Document the purpose and usage of each feature module</li>
<li><strong>Consistent Naming</strong>: Follow the established naming conventions</li>
<li><strong>Feature Flags</strong>: Use feature flags for gradual rollout and A/B testing</li>
<li><strong>Accessibility</strong>: Ensure all features are accessible to all users</li>
<li><strong>Internationalization</strong>: Design features with internationalization in mind</li>
</ol>
<p>By following these guidelines, the Thunderbird for Android application can maintain a clean, modular architecture while
expanding its functionality to meet user needs.</p>
<h2 id="-feature-module-overview"><a class="header" href="#-feature-module-overview">📋 Feature Module Overview</a></h2>
<p>The application is composed of several core feature modules, each responsible for a specific aspect of the
application’s functionality:</p>
<pre class="mermaid">graph TB
    subgraph FEATURE[App Features]
        direction TB
        
        
        subgraph ROW_2[&quot; &quot;]
            direction LR
            SETTINGS[&quot;`**Settings**&lt;br&gt;App configuration`&quot;]
            NOTIFICATION[&quot;`**Notification**&lt;br&gt;Push and alert handling`&quot;]
            SEARCH[&quot;`**Search**&lt;br&gt;Content discovery`&quot;]
            WIDGET[&quot;`**Widget**&lt;br&gt;Home screen components`&quot;]
        end
        
        subgraph ROW_1[&quot; &quot;]
            direction LR
            ACCOUNT[&quot;`**Account**&lt;br&gt;User accounts management`&quot;]
            MAIL[&quot;`**Mail**&lt;br&gt;Email handling and display`&quot;]
            NAVIGATION[&quot;`**Navigation**&lt;br&gt;App navigation and UI components`&quot;]
            ONBOARDING[&quot;`**Onboarding**&lt;br&gt;User setup and introduction`&quot;]
        end
    end

    classDef row fill: #d9ffd9, stroke: #d9ffd9, color: #d9ffd9
    classDef feature fill: #d9ffd9,stroke: #000000, color: #000000
    classDef feature_module fill: #33cc33, stroke: #000000, color:#000000
    
    class ROW_1,ROW_2 row
    class FEATURE feature
    class ACCOUNT,MAIL,NAVIGATION,ONBOARDING,SETTINGS,NOTIFICATION,SEARCH,WIDGET feature_module
</pre>
<h2 id="-feature-module-details"><a class="header" href="#-feature-module-details">🧩 Feature Module Details</a></h2>
<h3 id="-account-module"><a class="header" href="#-account-module">🔑 Account Module</a></h3>
<p>The Account module manages all aspects of email accounts, including setup, configuration, and authentication.</p>
<pre><code class="language-shell">feature:account
├── feature:account:api
├── feature:account:impl
├── feature:account:setup
│   ├── feature:account:setup:api
│   └── feature:account:setup:impl
├── feature:account:settings
│   ├── feature:account:settings:api
│   └── feature:account:settings:impl
├── feature:account:server
│   ├── feature:account:server:api
│   ├── feature:account:server:impl
│   ├── feature:account:server:certificate
│   │   ├── feature:account:server:certificate:api
│   │   └── feature:account:server:certificate:impl
│   ├── feature:account:server:settings
│   │   ├── feature:account:server:settings:api
│   │   └── feature:account:server:settings:impl
│   └── feature:account:server:validation
│       ├── feature:account:server:validation:api
│       └── feature:account:server:validation:impl
├── feature:account:auth
│   ├── feature:account:auth:api
│   ├── feature:account:auth:impl
│   └── feature:account:auth:oauth
│       ├── feature:account:auth:oauth:api
│       └── feature:account:auth:oauth:impl
└── feature:account:storage
    ├── feature:account:storage:api
    ├── feature:account:storage:impl
    └── feature:account:storage:legacy
        ├── feature:account:storage:legacy:api
        └── feature:account:storage:legacy:impl
</code></pre>
<h4 id="subfeatures"><a class="header" href="#subfeatures">Subfeatures:</a></h4>
<ul>
<li><strong>API/Implementation</strong>: Core public interfaces and implementations for account management</li>
<li><strong>Setup</strong>: New account setup wizard functionality
<ul>
<li><strong>API</strong>: Public interfaces for account setup</li>
<li><strong>Implementation</strong>: Concrete implementations of setup flows</li>
</ul>
</li>
<li><strong>Settings</strong>: Account-specific settings management
<ul>
<li><strong>API</strong>: Public interfaces for account settings</li>
<li><strong>Implementation</strong>: Concrete implementations of settings functionality</li>
</ul>
</li>
<li><strong>Server</strong>: Server configuration and management
<ul>
<li><strong>API/Implementation</strong>: Core server management interfaces and implementations</li>
<li><strong>Certificate</strong>: SSL certificate handling</li>
<li><strong>Settings</strong>: Server settings configuration</li>
<li><strong>Validation</strong>: Server connection validation</li>
</ul>
</li>
<li><strong>Auth</strong>: Authentication functionality
<ul>
<li><strong>API/Implementation</strong>: Core authentication interfaces and implementations</li>
<li><strong>OAuth</strong>: OAuth-specific authentication implementation</li>
</ul>
</li>
<li><strong>Storage</strong>: Account data persistence
<ul>
<li><strong>API/Implementation</strong>: Core storage interfaces and implementations</li>
<li><strong>Legacy</strong>: Legacy storage implementation</li>
</ul>
</li>
</ul>
<h3 id="-mail-module"><a class="header" href="#-mail-module">📧 Mail Module</a></h3>
<p>The Mail module handles core email functionality, including message display, composition, and folder management.</p>
<pre><code class="language-shell">feature:mail
├── feature:mail:api
├── feature:mail:impl
├── feature:mail:account
│   ├── feature:mail:account:api
│   └── feature:mail:account:impl
├── feature:mail:folder
│   ├── feature:mail:folder:api
│   └── feature:mail:folder:impl
├── feature:mail:compose
│   ├── feature:mail:compose:api
│   └── feature:mail:compose:impl
└── feature:mail:message
    ├── feature:mail:message:api
    ├── feature:mail:message:impl
    ├── feature:mail:message:view
    │   ├── feature:mail:message:view:api
    │   └── feature:mail:message:view:impl
    └── feature:mail:message:list
        ├── feature:mail:message:list:api
        └── feature:mail:message:list:impl
</code></pre>
<h4 id="subfeatures-1"><a class="header" href="#subfeatures-1">Subfeatures:</a></h4>
<ul>
<li><strong>API/Implementation</strong>: Core public interfaces and implementations for mail functionality</li>
<li><strong>Account</strong>: Mail-specific account interfaces and implementations
<ul>
<li><strong>API</strong>: Public interfaces for mail account integration</li>
<li><strong>Implementation</strong>: Concrete implementations of mail account functionality</li>
</ul>
</li>
<li><strong>Folder</strong>: Email folder management
<ul>
<li><strong>API</strong>: Public interfaces for folder operations</li>
<li><strong>Implementation</strong>: Concrete implementations of folder management</li>
</ul>
</li>
<li><strong>Compose</strong>: Email composition functionality
<ul>
<li><strong>API</strong>: Public interfaces for message composition</li>
<li><strong>Implementation</strong>: Concrete implementations of composition features</li>
</ul>
</li>
<li><strong>Message</strong>: Message handling and display
<ul>
<li><strong>API/Implementation</strong>: Core message handling interfaces and implementations</li>
<li><strong>View</strong>: Individual message viewing functionality</li>
<li><strong>List</strong>: Message list display and interaction</li>
</ul>
</li>
</ul>
<h3 id="-navigation-module"><a class="header" href="#-navigation-module">🧭 Navigation Module</a></h3>
<p>The Navigation module provides UI components for navigating through the application.</p>
<pre><code class="language-shell">feature:navigation
├── feature:navigation:api
├── feature:navigation:impl
└── feature:navigation:drawer
    ├── feature:navigation:drawer:api
    ├── feature:navigation:drawer:impl
    ├── feature:navigation:drawer:dropdown
    │   ├── feature:navigation:drawer:dropdown:api
    │   └── feature:navigation:drawer:dropdown:impl
    └── feature:navigation:drawer:siderail
        ├── feature:navigation:drawer:siderail:api
        └── feature:navigation:drawer:siderail:impl
</code></pre>
<h4 id="subfeatures-2"><a class="header" href="#subfeatures-2">Subfeatures:</a></h4>
<ul>
<li><strong>API/Implementation</strong>: Core public interfaces and implementations for navigation</li>
<li><strong>Drawer</strong>: Navigation drawer functionality
<ul>
<li><strong>API/Implementation</strong>: Core drawer interfaces and implementations</li>
<li><strong>Dropdown</strong>: Dropdown-style navigation implementation</li>
<li><strong>Siderail</strong>: Side rail navigation implementation</li>
</ul>
</li>
</ul>
<h3 id="-onboarding-module"><a class="header" href="#-onboarding-module">🚀 Onboarding Module</a></h3>
<p>The Onboarding module guides new users through the initial setup process.</p>
<pre><code class="language-shell">feature:onboarding
├── feature:onboarding:api
├── feature:onboarding:impl
├── feature:onboarding:main
│   ├── feature:onboarding:main:api
│   └── feature:onboarding:main:impl
├── feature:onboarding:welcome
│   ├── feature:onboarding:welcome:api
│   └── feature:onboarding:welcome:impl
├── feature:onboarding:permissions
│   ├── feature:onboarding:permissions:api
│   └── feature:onboarding:permissions:impl
└── feature:onboarding:migration
    ├── feature:onboarding:migration:api
    ├── feature:onboarding:migration:impl
    ├── feature:onboarding:migration:thunderbird
    │   ├── feature:onboarding:migration:thunderbird:api
    │   └── feature:onboarding:migration:thunderbird:impl
    └── feature:onboarding:migration:noop
        ├── feature:onboarding:migration:noop:api
        └── feature:onboarding:migration:noop:impl
</code></pre>
<h4 id="subfeatures-3"><a class="header" href="#subfeatures-3">Subfeatures:</a></h4>
<ul>
<li><strong>API/Implementation</strong>: Core public interfaces and implementations for onboarding</li>
<li><strong>Main</strong>: Main onboarding flow
<ul>
<li><strong>API</strong>: Public interfaces for the main onboarding process</li>
<li><strong>Implementation</strong>: Concrete implementations of the onboarding flow</li>
</ul>
</li>
<li><strong>Welcome</strong>: Welcome screens and initial user experience
<ul>
<li><strong>API</strong>: Public interfaces for welcome screens</li>
<li><strong>Implementation</strong>: Concrete implementations of welcome screens</li>
</ul>
</li>
<li><strong>Permissions</strong>: Permission request handling
<ul>
<li><strong>API</strong>: Public interfaces for permission management</li>
<li><strong>Implementation</strong>: Concrete implementations of permission requests</li>
</ul>
</li>
<li><strong>Migration</strong>: Data migration from other apps
<ul>
<li><strong>API/Implementation</strong>: Core migration interfaces and implementations</li>
<li><strong>Thunderbird</strong>: Thunderbird-specific migration implementation</li>
<li><strong>Noop</strong>: No-operation implementation for testing</li>
</ul>
</li>
</ul>
<h3 id="-settings-module"><a class="header" href="#-settings-module">⚙️ Settings Module</a></h3>
<p>The Settings module provides interfaces for configuring application behavior.</p>
<pre><code class="language-shell">feature:settings
├── feature:settings:api
├── feature:settings:impl
├── feature:settings:import
│   ├── feature:settings:import:api
│   └── feature:settings:import:impl
└── feature:settings:ui
    ├── feature:settings:ui:api
    └── feature:settings:ui:impl
</code></pre>
<h4 id="subfeatures-4"><a class="header" href="#subfeatures-4">Subfeatures:</a></h4>
<ul>
<li><strong>API/Implementation</strong>: Core public interfaces and implementations for settings</li>
<li><strong>Import</strong>: Settings import functionality
<ul>
<li><strong>API</strong>: Public interfaces for settings import</li>
<li><strong>Implementation</strong>: Concrete implementations of import functionality</li>
</ul>
</li>
<li><strong>UI</strong>: Settings user interface components
<ul>
<li><strong>API</strong>: Public interfaces for settings UI</li>
<li><strong>Implementation</strong>: Concrete implementations of settings screens</li>
</ul>
</li>
</ul>
<h3 id="-notification-module"><a class="header" href="#-notification-module">🔔 Notification Module</a></h3>
<p>The Notification module handles push notifications and alerts for new emails and events.</p>
<pre><code class="language-shell">feature:notification
├── feature:notification:api
├── feature:notification:impl
├── feature:notification:email
│   ├── feature:notification:email:api
│   └── feature:notification:email:impl
└── feature:notification:push
    ├── feature:notification:push:api
    └── feature:notification:push:impl
</code></pre>
<h4 id="subfeatures-5"><a class="header" href="#subfeatures-5">Subfeatures:</a></h4>
<ul>
<li><strong>API/Implementation</strong>: Core public interfaces and implementations for notifications</li>
<li><strong>Email</strong>: Email-specific notification handling
<ul>
<li><strong>API</strong>: Public interfaces for email notifications</li>
<li><strong>Implementation</strong>: Concrete implementations of email alerts</li>
</ul>
</li>
<li><strong>Push</strong>: Push notification handling
<ul>
<li><strong>API</strong>: Public interfaces for push notifications</li>
<li><strong>Implementation</strong>: Concrete implementations of push notification processing</li>
</ul>
</li>
</ul>
<h3 id="-search-module"><a class="header" href="#-search-module">🔍 Search Module</a></h3>
<p>The Search module provides functionality for searching through emails and contacts.</p>
<pre><code class="language-shell">feature:search
├── feature:search:api
├── feature:search:impl
├── feature:search:email
│   ├── feature:search:email:api
│   └── feature:search:email:impl
├── feature:search:contact
│   ├── feature:search:contact:api
│   └── feature:search:contact:impl
└── feature:search:ui
    ├── feature:search:ui:api
    └── feature:search:ui:impl
</code></pre>
<h4 id="subfeatures-6"><a class="header" href="#subfeatures-6">Subfeatures:</a></h4>
<ul>
<li><strong>API/Implementation</strong>: Core public interfaces and implementations for search functionality</li>
<li><strong>Email</strong>: Email-specific search capabilities
<ul>
<li><strong>API</strong>: Public interfaces for email search</li>
<li><strong>Implementation</strong>: Concrete implementations of email search</li>
</ul>
</li>
<li><strong>Contact</strong>: Contact search functionality
<ul>
<li><strong>API</strong>: Public interfaces for contact search</li>
<li><strong>Implementation</strong>: Concrete implementations of contact search</li>
</ul>
</li>
<li><strong>UI</strong>: Search user interface components
<ul>
<li><strong>API</strong>: Public interfaces for search UI</li>
<li><strong>Implementation</strong>: Concrete implementations of search screens</li>
</ul>
</li>
</ul>
<h3 id="-widget-module"><a class="header" href="#-widget-module">📱 Widget Module</a></h3>
<p>The Widget module provides home screen widgets for quick access to email functionality.</p>
<pre><code class="language-shell">feature:widget
├── feature:widget:api
├── feature:widget:impl
├── feature:widget:message-list
│   ├── feature:widget:message-list:api
│   └── feature:widget:message-list:impl
├── feature:widget:message-list-glance
│   ├── feature:widget:message-list-glance:api
│   └── feature:widget:message-list-glance:impl
├── feature:widget:shortcut
│   ├── feature:widget:shortcut:api
│   └── feature:widget:shortcut:impl
└── feature:widget:unread
    ├── feature:widget:unread:api
    └── feature:widget:unread:impl
</code></pre>
<h4 id="subfeatures-7"><a class="header" href="#subfeatures-7">Subfeatures:</a></h4>
<ul>
<li><strong>API/Implementation</strong>: Core public interfaces and implementations for widgets</li>
<li><strong>Message List</strong>: Email list widget
<ul>
<li><strong>API</strong>: Public interfaces for message list widget</li>
<li><strong>Implementation</strong>: Concrete implementations of message list widget</li>
</ul>
</li>
<li><strong>Message List Glance</strong>: Glanceable message widget
<ul>
<li><strong>API</strong>: Public interfaces for glance widget</li>
<li><strong>Implementation</strong>: Concrete implementations of glance widget</li>
</ul>
</li>
<li><strong>Shortcut</strong>: App shortcut widgets
<ul>
<li><strong>API</strong>: Public interfaces for shortcut widgets</li>
<li><strong>Implementation</strong>: Concrete implementations of shortcut widgets</li>
</ul>
</li>
<li><strong>Unread</strong>: Unread message counter widget
<ul>
<li><strong>API</strong>: Public interfaces for unread counter widget</li>
<li><strong>Implementation</strong>: Concrete implementations of unread counter widget</li>
</ul>
</li>
</ul>
<h2 id="-supporting-feature-modules"><a class="header" href="#-supporting-feature-modules">🔄 Supporting Feature Modules</a></h2>
<p>In addition to the core email functionality, the application includes several supporting feature modules:</p>
<h3 id="-autodiscovery-module"><a class="header" href="#-autodiscovery-module">🔎 Autodiscovery Module</a></h3>
<p>The Autodiscovery module automatically detects email server settings.</p>
<h4 id="subfeatures-8"><a class="header" href="#subfeatures-8">Subfeatures:</a></h4>
<ul>
<li><strong>API</strong> (<code>feature:autodiscovery:api</code>): Public interfaces</li>
<li><strong>Autoconfig</strong> (<code>feature:autodiscovery:autoconfig</code>): Automatic configuration</li>
<li><strong>Service</strong> (<code>feature:autodiscovery:service</code>): Service implementation</li>
<li><strong>Demo</strong> (<code>feature:autodiscovery:demo</code>): Demonstration implementation</li>
</ul>
<h3 id="-funding-module"><a class="header" href="#-funding-module">💰 Funding Module</a></h3>
<p>The Funding module handles in-app financial contributions and funding options.</p>
<h4 id="subfeatures-9"><a class="header" href="#subfeatures-9">Subfeatures:</a></h4>
<ul>
<li><strong>API</strong> (<code>feature:funding:api</code>): Public interfaces</li>
<li><strong>Google Play</strong> (<code>feature:funding:googleplay</code>): Google Play billing integration</li>
<li><strong>Link</strong> (<code>feature:funding:link</code>): External funding link handling</li>
<li><strong>Noop</strong> (<code>feature:funding:noop</code>): No-operation implementation</li>
</ul>
<h3 id="-migration-module"><a class="header" href="#-migration-module">🔄 Migration Module</a></h3>
<p>The Migration module handles data migration between different email clients.</p>
<h4 id="subfeatures-10"><a class="header" href="#subfeatures-10">Subfeatures:</a></h4>
<ul>
<li><strong>Provider</strong> (<code>feature:migration:provider</code>): Migration data providers</li>
<li><strong>QR Code</strong> (<code>feature:migration:qrcode</code>): QR code-based migration</li>
<li><strong>Launcher</strong> (<code>feature:migration:launcher</code>): Migration launcher
<ul>
<li><strong>API</strong> (<code>feature:migration:launcher:api</code>): Launcher interfaces</li>
<li><strong>Noop</strong> (<code>feature:migration:launcher:noop</code>): No-operation implementation</li>
<li><strong>Thunderbird</strong> (<code>feature:migration:launcher:thunderbird</code>): Thunderbird-specific implementation</li>
</ul>
</li>
</ul>
<h3 id="-telemetry-module"><a class="header" href="#-telemetry-module">📊 Telemetry Module</a></h3>
<p>The Telemetry module handles usage analytics and reporting.</p>
<h4 id="subfeatures-11"><a class="header" href="#subfeatures-11">Subfeatures:</a></h4>
<ul>
<li><strong>API</strong> (<code>feature:telemetry:api</code>): Public interfaces</li>
<li><strong>Noop</strong> (<code>feature:telemetry:noop</code>): No-operation implementation</li>
<li><strong>Glean</strong> (<code>feature:telemetry:glean</code>): Mozilla Glean integration</li>
</ul>
<h2 id="-extending-with-additional-features"><a class="header" href="#-extending-with-additional-features">🔌 Extending with Additional Features</a></h2>
<p>The modular architecture of Thunderbird for Android allows for easy extension with additional features. To give you an
idea how the app could be extended when building a new feature, here are some theoretical examples along with their
structure:</p>
<h3 id="-calendar-feature"><a class="header" href="#-calendar-feature">📅 Calendar Feature</a></h3>
<p>A Calendar feature could be added to integrate calendar functionality with email.</p>
<pre><code class="language-shell">feature:calendar
├── feature:calendar:api
├── feature:calendar:impl
├── feature:calendar:event
│   ├── feature:calendar:event:api
│   └── feature:calendar:event:impl
└── feature:calendar:sync
    ├── feature:calendar:sync:api
    └── feature:calendar:sync:impl
</code></pre>
<h3 id="-appointments-feature"><a class="header" href="#-appointments-feature">🗓️ Appointments Feature</a></h3>
<p>An Appointments feature could manage meetings and appointments.</p>
<pre><code class="language-shell">feature:appointment
├── feature:appointment:api
├── feature:appointment:impl
├── feature:appointment:scheduler
│   ├── feature:appointment:scheduler:api
│   └── feature:appointment:scheduler:impl
└── feature:appointment:notification
    ├── feature:appointment:notification:api
    └── feature:appointment:notification:impl
</code></pre>
<h2 id="-feature-relationships"><a class="header" href="#-feature-relationships">🔗 Feature Relationships</a></h2>
<p>Features in the application interact with each other through well-defined APIs. The diagram below illustrates the
relationships between different features:</p>
<pre class="mermaid">graph TB
    subgraph CORE[Core Features]
        ACCOUNT[Account]
        MAIL[Mail]
    end

    subgraph EXTENSIONS[Potential Extensions]
        CALENDAR[Calendar]
        APPOINTMENT[Appointments]
    end

    MAIL --&gt; |uses| ACCOUNT

    CALENDAR --&gt; |integrates with| MAIL
    CALENDAR --&gt; |uses| ACCOUNT
    APPOINTMENT --&gt; |uses| ACCOUNT
    APPOINTMENT --&gt; |integrates with| CALENDAR
    APPOINTMENT --&gt; |uses| MAIL

    linkStyle default stroke:#999,stroke-width:2px

    classDef core fill:#e8c8ff,stroke:#000000,color:#000000
    classDef core_module fill:#c090ff,stroke:#000000,color:#000000
    classDef extension fill:#d0e0ff,stroke:#000000,color:#000000
    classDef extension_module fill:#8090ff,stroke:#000000,color:#000000
    class CORE core
    class ACCOUNT,MAIL,NAVIGATION,SETTINGS core_module
    class EXTENSIONS extension
    class CALENDAR,TODO,SYNC,NOTES,APPOINTMENT extension_module
</pre>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-ui-architecture-1"><a class="header" href="#-ui-architecture-1">🎨 UI Architecture</a></h1>
<p>The UI is built using Jetpack Compose with a component-based architecture following a modified Model-View-Intent (MVI) pattern. While we refer to it as MVI, our implementation uses “Events” instead of “Intents” for user interactions and “Actions” for use case calls. This architecture provides a unidirectional data flow, clear separation of concerns, and improved testability.</p>
<h2 id="-component-hierarchy"><a class="header" href="#-component-hierarchy">📱 Component Hierarchy</a></h2>
<p>The UI components are organized in a hierarchical structure:</p>
<pre class="mermaid">graph TD
    subgraph UI_ARCHITECTURE[&quot;UI Architecture&quot;]
        SCREENS[Screens]
        COMPONENTS[Components]
        DESIGN[Design System Components]
        THEME[Theme]
    end

    SCREENS --&gt; COMPONENTS
    COMPONENTS --&gt; DESIGN
    DESIGN --&gt; THEME

    classDef ui_layer fill:#d9e9ff,stroke:#000000,color:#000000
    classDef screen fill:#99ccff,stroke:#000000,color:#000000
    classDef component fill:#99ff99,stroke:#000000,color:#000000
    classDef design fill:#ffcc99,stroke:#000000,color:#000000
    classDef theme fill:#ffff99,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class UI_ARCHITECTURE ui_layer
    class SCREENS screen
    class COMPONENTS component
    class DESIGN design
    class THEME theme
</pre>
<h3 id="-screens"><a class="header" href="#-screens">🖥️ Screens</a></h3>
<ul>
<li>Top-level composables that represent a full screen in the application</li>
<li>Typically associated with a specific route in the navigation graph</li>
<li>Responsible for orchestrating components and managing screen-level state</li>
<li>Connected to ViewModels that handle interaction logic and state management</li>
</ul>
<p>Example:</p>
<pre><code class="language-kotlin">@Composable
fun AccountSettingsScreen(
    viewModel: AccountSettingsViewModel = koinViewModel(),
    onNavigateNext: () -&gt; Unit,
    onNavigateBack: () -&gt; Unit,
) {
    val (state, dispatch) = viewModel.observe { effect -&gt;
        when (effect) {
            AccountSettingsEffect.NavigateNext -&gt; onNavigateNext()
            AccountSettingsEffect.NavigateBack -&gt; onNavigateBack()
        }
    }

    AccountSettingsContent(
        state = state.value,
        onEvent = dispatch,
    )
}
</code></pre>
<h3 id="-components"><a class="header" href="#-components">🧩 Components</a></h3>
<ul>
<li>Reusable UI elements that encapsulate specific functionality</li>
<li>Can be composed of multiple smaller components</li>
<li>Follow a clear input-output model with immutable state passed in and events emitted out</li>
<li>Designed to be reusable across different screens</li>
</ul>
<p>Example:</p>
<pre><code class="language-kotlin">@Composable
fun AccountSettingsContent(
    state: AccountSettingsState,
    onEvent: (AccountSettingsEvent) -&gt; Unit,
) {
    Scaffold(
        topBar = {
            TopAppBar(
                title = stringResource(R.string.account_settings_title),
                onNavigateBack = { onEvent(AccountSettingsEvent.BackClicked) },
            )
        },
    ) {
        when {
            state.isLoading -&gt; LoadingIndicator()
            state.error != null -&gt; ErrorView(
                message = state.error,
                onRetryClicked = { onEvent(AccountSettingsEvent.RetryClicked) }
            )
            state.settings != null -&gt; AccountSettingsForm(
                settings = state.settings,
                onSettingChanged = { setting, value -&gt; 
                    onEvent(AccountSettingsEvent.SettingChanged(setting, value))
                },
                onSaveClicked = { onEvent(AccountSettingsEvent.SaveClicked) }
            )
        }
    }
}
</code></pre>
<h3 id="-design-system-components"><a class="header" href="#-design-system-components">🎨 Design System Components</a></h3>
<ul>
<li>Foundational UI elements that implement the design system</li>
<li>Consistent visual language across the application</li>
<li>Encapsulate styling, theming, and behavior from Material Design 3</li>
<li>Located in the <code>core:ui:compose:designsystem</code> module for reuse across features</li>
<li>Built using the <a href="architecture/design-system.html">Atomic Design Methodology</a></li>
</ul>
<p>Example:</p>
<pre><code class="language-kotlin">@Composable
fun PrimaryButton(
    text: String,
    onClick: () -&gt; Unit,
    modifier: Modifier = Modifier,
    enabled: Boolean = true,
    buttonStyle: ButtonStyle = ButtonStyle.Primary,
) {
    Button(
        onClick = onClick,
        modifier = modifier,
        enabled = enabled,
        colors = buttonStyle.colors(),
        shape = MaterialTheme.shapes.medium,
    ) {
        Text(text = text)
    }
}
</code></pre>
<h3 id="-theme"><a class="header" href="#-theme">🎭 Theme</a></h3>
<ul>
<li>Defines colors, typography, shapes, and other design tokens</li>
<li>Supports light and dark modes</li>
<li>Provides consistent visual appearance across the application</li>
<li>Implemented using Material Design 3 theming system</li>
<li>Located in the <code>core:ui:compose:theme2</code> module for reuse across features</li>
<li>Provides a <code>ThunderbirdTheme2</code> and a <code>K9MailTheme2</code> composable that wraps the MaterialTheme with custom color schemes, typography, and shapes</li>
<li>Uses Jetpack Compose’s <code>CompositionLocalProvider</code> as a theme provider to make theme components available throughout the app</li>
</ul>
<p>For a more detailed explanation of the theming system, including the theme provider implementation, see
<a href="architecture/theme-system.html">Theme System</a>.</p>
<h2 id="-unidirectional-data-flow"><a class="header" href="#-unidirectional-data-flow">📊 Unidirectional Data Flow</a></h2>
<p>The UI architecture follows a unidirectional data flow pattern, which is a fundamental concept that ensures data moves
in a single, well-defined direction throughout the application. This architectural approach creates a predictable and
maintainable system by enforcing a strict flow of information.</p>
<h3 id="-what-is-unidirectional-data-flow"><a class="header" href="#-what-is-unidirectional-data-flow">🔄 What is Unidirectional Data Flow?</a></h3>
<p>Unidirectional data flow is a design pattern where:</p>
<ol>
<li>Data travels in one direction only</li>
<li>State changes are predictable and traceable</li>
<li>Components have clear, single responsibilities</li>
<li>The UI is a pure function of the application state</li>
</ol>
<p>In our implementation, the flow follows this cycle:</p>
<ol>
<li><strong>User Interaction</strong>: The user interacts with the UI (e.g., clicks a button)</li>
<li><strong>Event Dispatch</strong>: The UI captures this interaction as an Event and dispatches it to the ViewModel</li>
<li><strong>Event Processing</strong>: The ViewModel processes the Event and determines what Action to take</li>
<li><strong>Action Execution</strong>: The ViewModel executes an Action, typically by calling a Use Case</li>
<li><strong>Domain Logic</strong>: The Use Case performs business logic, often involving repositories</li>
<li><strong>Result Return</strong>: The Use Case returns a Result to the ViewModel</li>
<li><strong>State Update</strong>: The ViewModel updates the State based on the Result</li>
<li><strong>UI Rendering</strong>: The UI observes the State change and re-renders accordingly</li>
<li><strong>Effect Handling</strong>: For one-time actions like navigation, the ViewModel emits an Effect that the UI handles</li>
</ol>
<p>This cycle ensures that data flows in a single direction: UI → ViewModel → Domain → ViewModel → UI.</p>
<pre class="mermaid">flowchart LR
    User([User]) --&gt; |Interaction| UI
    UI --&gt; |Event| ViewModel
    ViewModel --&gt; |Action| Domain
    Domain --&gt; |Result| ViewModel
    ViewModel --&gt; |State| UI
    ViewModel --&gt; |Effect| UI
    UI --&gt; |Render| User
</pre>
<h3 id="-benefits-of-unidirectional-data-flow"><a class="header" href="#-benefits-of-unidirectional-data-flow">🌟 Benefits of Unidirectional Data Flow</a></h3>
<p>Unidirectional data flow provides numerous advantages over bidirectional or unstructured data flow patterns:</p>
<ol>
<li>
<p><strong>Predictability</strong>: Since data flows in only one direction, the system behavior becomes more predictable and easier to reason about.</p>
</li>
<li>
<p><strong>Debugging</strong>: Tracing issues becomes simpler because you can follow the data flow from source to destination without worrying about circular dependencies.</p>
</li>
<li>
<p><strong>State Management</strong>: With a single source of truth (the ViewModel’s state), there’s no risk of inconsistent state across different parts of the application.</p>
</li>
<li>
<p><strong>Testability</strong>: Each component in the flow can be tested in isolation with clear inputs and expected outputs.</p>
</li>
<li>
<p><strong>Separation of Concerns</strong>: Each component has a well-defined responsibility:</p>
<ul>
<li>UI: Render state and capture user interactions</li>
<li>ViewModel: Process events, update state, and emit effects</li>
<li>Domain: Execute business logic</li>
</ul>
</li>
<li>
<p><strong>Scalability</strong>: The pattern scales well as the application grows because new features can follow the same consistent pattern.</p>
</li>
<li>
<p><strong>Maintainability</strong>: Code is easier to maintain because changes in one part of the flow don’t unexpectedly affect other parts.</p>
</li>
<li>
<p><strong>Concurrency</strong>: Reduces race conditions and timing issues since state updates happen in a controlled, sequential manner.</p>
</li>
</ol>
<p>We leverage unidirectional data flow in our MVI implementation to ensure that the UI remains responsive, predictable,
and easy to test.</p>
<h2 id="-model-view-intent-mvi"><a class="header" href="#-model-view-intent-mvi">🔄 Model-View-Intent (MVI)</a></h2>
<p>The UI layer follows the Model-View-Intent (MVI) pattern (with our Events/Effects/Actions adaptation as noted above), which
provides a unidirectional data flow and clear separation between UI state and UI logic.</p>
<pre class="mermaid">graph LR
    subgraph UI[UI Layer]
        VIEW[View]
        VIEW_MODEL[ViewModel]
    end

    subgraph DOMAIN[Domain Layer]
        USE_CASE[Use Cases]
    end

    VIEW --&gt; |Events| VIEW_MODEL
    VIEW_MODEL --&gt; |State| VIEW
    VIEW_MODEL --&gt; |Effects| VIEW
    VIEW_MODEL --&gt; |Actions| USE_CASE
    USE_CASE --&gt; |Results| VIEW_MODEL

    classDef ui_layer fill:#d9e9ff,stroke:#000000,color:#000000
    classDef view fill:#7fd3e0,stroke:#000000,color:#000000
    classDef view_model fill:#cc99ff,stroke:#000000,color:#000000
    classDef domain_layer fill:#d9ffd9,stroke:#000000,color:#000000
    classDef use_case fill:#99ffcc,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class UI ui_layer
    class VIEW view
    class VIEW_MODEL view_model
    class DOMAIN domain_layer
    class USE_CASE use_case
</pre>
<p><strong>Key components</strong>:</p>
<ul>
<li><strong>👁️ <a href="architecture/ui-architecture.html#-view">View</a></strong>: Renders the UI based on the current state and sends user events to the ViewModel</li>
<li><strong>🧠 <a href="architecture/ui-architecture.html#-viewmodel">ViewModel</a></strong>: Processes user events, converting them into actions and sending them to the Domain Layer. It also maps the results to a state and sends state updates to the UI.</li>
<li><strong>🧪 <a href="architecture/ui-architecture.html#-use-cases">Use Cases</a></strong>: Encapsulate business logic and interact with repositories to perform data operations. They return results to the ViewModel, which updates the state.</li>
</ul>
<p><strong>Unidirectional Data flow</strong>:</p>
<ul>
<li><strong>📊 <a href="architecture/ui-architecture.html#-state">State</a></strong>: Immutable representation of the UI state. States are the single source of truth for the UI and represent everything that can be displayed on the screen.</li>
<li><strong>🎮 <a href="architecture/ui-architecture.html#-events">Events</a></strong>: User interactions or system events that are passed to the ViewModel to be processed. Events trigger state changes or side effects.</li>
<li><strong>🔔 <a href="architecture/ui-architecture.html#-effects">Effects</a></strong>: One-time side effects that don’t belong in the state, such as navigation actions, showing toasts, etc.</li>
<li><strong>⚡ <a href="architecture/ui-architecture.html#-actions">Actions</a></strong>: Operations triggered by the ViewModel to interact with the domain layer.</li>
<li><strong>📊 <a href="architecture/ui-architecture.html#-results">Results</a></strong>: Responses from the domain layer that are processed by the ViewModel to update the state.</li>
</ul>
<h3 id="-components-1"><a class="header" href="#-components-1">🧩 Components</a></h3>
<p>The MVI architecture is implemented using the following components:</p>
<h4 id="-view"><a class="header" href="#-view">👁️ View</a></h4>
<ul>
<li>Represents the UI layer in the MVI pattern</li>
<li>Composed of Jetpack Compose components (Screens, Components, etc.)</li>
<li>Responsible for rendering the UI state and capturing user interactions</li>
<li>Sends events to the ViewModel and receives state updates</li>
<li>Purely presentational with no business logic</li>
</ul>
<p>In our architecture, the View is implemented using Jetpack Compose and consists of:</p>
<ol>
<li><strong>Screen Composables</strong>: Top-level composables that represent a full screen</li>
<li><strong>Content Composables</strong>: Composables that render the UI based on the state</li>
<li><strong>Component Composables</strong>: Reusable UI elements</li>
</ol>
<p>Example of a View implementation:</p>
<pre><code class="language-kotlin">// Screen Composable (part of the View)
@Composable
internal fun AccountSettingsScreen(
    onNavigateNext: () -&gt; Unit,
    onNavigateBack: () -&gt; Unit,
    viewModel: AccountSettingsViewModel = koinViewModel(),
) {
    // Observe state and handle effects
    val (state, dispatch) = viewModel.observe { effect -&gt;
        when (effect) {
            AccountSettingsEffect.NavigateNext -&gt; onNavigateNext()
            AccountSettingsEffect.NavigateBack -&gt; onNavigateBack()
        }
    }

    // Content Composable (also part of the View)
    AccountSettingsContent(
        state = state.value,
        onEvent = dispatch,
    )
}

// Content Composable (part of the View)
@Composable
private fun AccountSettingsContent(
    state: AccountSettingsState,
    onEvent: (AccountSettingsEvent) -&gt; Unit,
) {
    // Render UI based on state
    when {
        state.isLoading -&gt; LoadingIndicator()
        state.error != null -&gt; ErrorView(
            message = state.error,
            onRetryClicked = { onEvent(AccountSettingsEvent.RetryClicked) }
        )
        state.settings != null -&gt; AccountSettingsForm(
            settings = state.settings,
            onSettingChanged = { setting, value -&gt; 
                onEvent(AccountSettingsEvent.SettingChanged(setting, value))
            },
            onSaveClicked = { onEvent(AccountSettingsEvent.SaveClicked) }
        )
    }
}
</code></pre>
<p>The View is responsible for:</p>
<ul>
<li>Rendering the UI based on the current state</li>
<li>Capturing user interactions and converting them to events</li>
<li>Sending events to the ViewModel</li>
<li>Handling side effects (like navigation)</li>
<li>Maintaining a clear separation from business logic</li>
</ul>
<h4 id="-viewmodel"><a class="header" href="#-viewmodel">🧠 ViewModel</a></h4>
<ul>
<li>Acts as the mediator between the View and the Domain layer</li>
<li>Processes events from the View and updates state</li>
<li>Coordinates with use cases for business logic</li>
<li>Exposes state as a StateFlow for the View to observe</li>
<li>Emits side effects for one-time actions like navigation</li>
</ul>
<p>The ViewModel is implemented using the <code>BaseViewModel</code> class, which provides the core functionality for the MVI pattern:</p>
<pre><code class="language-kotlin">abstract class BaseViewModel&lt;STATE, EVENT, EFFECT&gt;(
    initialState: STATE,
) : ViewModel(),
    UnidirectionalViewModel&lt;STATE, EVENT, EFFECT&gt; {

    private val _state = MutableStateFlow(initialState)
    override val state: StateFlow&lt;STATE&gt; = _state.asStateFlow()

    private val _effect = MutableSharedFlow&lt;EFFECT&gt;()
    override val effect: SharedFlow&lt;EFFECT&gt; = _effect.asSharedFlow()

    /**
     * Updates the [STATE] of the ViewModel.
     */
    protected fun updateState(update: (STATE) -&gt; STATE) {
        _state.update(update)
    }

    /**
     * Emits a side effect.
     */
    protected fun emitEffect(effect: EFFECT) {
        viewModelScope.launch {
            _effect.emit(effect)
        }
    }
}
</code></pre>
<p>Example of a ViewModel implementation:</p>
<pre><code class="language-kotlin">class AccountViewModel(
    private val getAccount: GetAccount,
    private val updateAccount: UpdateAccount,
) : BaseViewModel&lt;AccountState, AccountEvent, AccountEffect&gt;(
    initialState = AccountState()
) {
    // Handle events from the UI
    override fun event(event: AccountEvent) {
        when (event) {
            is AccountEvent.LoadAccount -&gt; loadAccount(event.accountId)
            is AccountEvent.UpdateAccount -&gt; saveAccount(event.account)
            is AccountEvent.BackClicked -&gt; emitEffect(AccountEffect.NavigateBack)
        }
    }

    // Load account data
    private fun loadAccount(accountId: String) {
        viewModelScope.launch {
            // Update state to show loading
            updateState { it.copy(isLoading = true) }

            // Call use case to get account
            val account = getAccount(accountId)

            // Update state with account data
            updateState { 
                it.copy(
                    isLoading = false,
                    account = account
                )
            }
        }
    }

    // Save account changes
    private fun saveAccount(account: Account) {
        viewModelScope.launch {
            // Update state to show loading
            updateState { it.copy(isLoading = true) }

            // Call use case to update account
            val result = updateAccount(account)

            // Handle result
            if (result.isSuccess) {
                updateState { it.copy(isLoading = false) }
                emitEffect(AccountEffect.NavigateBack)
            } else {
                updateState { 
                    it.copy(
                        isLoading = false,
                        error = "Failed to save account"
                    )
                }
            }
        }
    }
}
</code></pre>
<h4 id="-use-cases"><a class="header" href="#-use-cases">🧪 Use Cases</a></h4>
<ul>
<li>Encapsulate business logic in the domain layer</li>
<li>Follow the single responsibility principle</li>
<li>Independent of UI and framework concerns</li>
<li>Can be easily tested in isolation</li>
<li>Invoked by ViewModels through Actions</li>
<li>Implemented using the <code>operator fun invoke</code> pattern for cleaner, more concise code</li>
</ul>
<p>Use Cases represent the business logic of the application and are part of the domain layer. They encapsulate specific operations that the application can perform, such as creating an account, fetching data, or updating settings. Use cases should be implemented using the <code>operator fun invoke</code> pattern, which allows them to be called like functions.</p>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>Use Cases are only required when there needs to be business logic (such as validation, transformation, or complex operations). For simple CRUD operations or direct data access with no additional logic, ViewModels can use repositories directly. This approach reduces unnecessary abstraction layers while still maintaining clean architecture principles.</p>
</div>
<p>Example of a Use Case:</p>
<pre><code class="language-kotlin">// Use Case interface using operator fun invoke pattern
fun interface CreateAccount {
    suspend operator fun invoke(accountState: AccountState): AccountCreatorResult
}

// Use Case implementation
class CreateAccountImpl(
    private val accountCreator: AccountCreator,
    private val accountValidator: AccountValidator,
) : CreateAccount {

    override suspend operator fun invoke(accountState: AccountState): AccountCreatorResult {
        // Validate account data
        val validationResult = accountValidator.validate(accountState)
        if (validationResult is ValidationResult.Failure) {
            return AccountCreatorResult.Error.Validation(validationResult.errors)
        }

        // Create account
        return try {
            val accountUuid = accountCreator.createAccount(accountState)
            AccountCreatorResult.Success(accountUuid)
        } catch (e: Exception) {
            AccountCreatorResult.Error.Creation(e.message ?: "Unknown error")
        }
    }
}
</code></pre>
<p>Use Cases are typically:</p>
<ul>
<li>Injected into ViewModels</li>
<li>Invoked in response to user events</li>
<li>Responsible for orchestrating repositories and other domain services</li>
<li>Returning results that the ViewModel can use to update the UI state</li>
</ul>
<p>The separation of Use Cases from ViewModels allows for:</p>
<ul>
<li>Better testability of business logic</li>
<li>Reuse of business logic across different features</li>
<li>Clear separation of concerns</li>
<li>Easier maintenance and evolution of the codebase</li>
</ul>
<h3 id="data-flow-components"><a class="header" href="#data-flow-components">Data Flow Components</a></h3>
<h4 id="-state"><a class="header" href="#-state">📊 State</a></h4>
<ul>
<li>Immutable data classes representing the UI state</li>
<li>Single source of truth for the UI</li>
<li>Exposed as a StateFlow from the ViewModel</li>
<li>Rendered by Compose UI components</li>
</ul>
<p><strong>Example: State in Action</strong></p>
<p>Here’s a complete example showing how state is defined, updated, and consumed:</p>
<pre><code class="language-kotlin">// 1. Define the state
data class AccountSettingsState(
    val isLoading: Boolean = false,
    val settings: AccountSettings? = null,
    val error: String? = null,
)

// 2. Update state in ViewModel
class AccountSettingsViewModel(
    private val getSettings: GetAccountSettings,
) : BaseViewModel&lt;AccountSettingsState, AccountSettingsEvent, AccountSettingsEffect&gt;(
    initialState = AccountSettingsState(isLoading = true)
) {
    init {
        loadSettings()
    }

    private fun loadSettings() {
        viewModelScope.launch {
            try {
                val settings = getSettings()
                // Update state with loaded settings
                updateState { it.copy(isLoading = false, settings = settings, error = null) }
            } catch (e: Exception) {
                // Update state with error
                updateState { it.copy(isLoading = false, settings = null, error = e.message) }
            }
        }
    }

    override fun event(event: AccountSettingsEvent) {
        when (event) {
            is AccountSettingsEvent.RetryClicked -&gt; {
                // Update state to show loading and retry
                updateState { it.copy(isLoading = true, error = null) }
                loadSettings()
            }
            // Handle other events...
        }
    }
}

// 3. Consume state in UI
@Composable
fun AccountSettingsContent(
    state: AccountSettingsState,
    onEvent: (AccountSettingsEvent) -&gt; Unit,
) {
    when {
        state.isLoading -&gt; {
            // Show loading UI
            CircularProgressIndicator(
                modifier = Modifier.align(Alignment.Center)
            )
        }
        state.error != null -&gt; {
            // Show error UI
            ErrorView(
                message = state.error,
                onRetryClicked = { onEvent(AccountSettingsEvent.RetryClicked) }
            )
        }
        state.settings != null -&gt; {
            // Show settings form
            AccountSettingsForm(
                settings = state.settings,
                onSettingChanged = { setting, value -&gt; 
                    onEvent(AccountSettingsEvent.SettingChanged(setting, value))
                }
            )
        }
    }
}
</code></pre>
<h4 id="-events"><a class="header" href="#-events">🎮 Events</a></h4>
<ul>
<li>Represent user interactions or system events</li>
<li>Passed from the UI to the ViewModel</li>
<li>Trigger state updates or side effects</li>
</ul>
<p><strong>Example: Events in Action</strong></p>
<p>Here’s a complete example showing how events are defined, dispatched, and handled:</p>
<pre><code class="language-kotlin">// 1. Define events
sealed interface AccountSettingsEvent {
    data class SettingChanged(val setting: Setting, val value: Any) : AccountSettingsEvent
    data object SaveClicked : AccountSettingsEvent
    data object RetryClicked : AccountSettingsEvent
    data object BackClicked : AccountSettingsEvent
}

// 2. Handle events in ViewModel
class AccountSettingsViewModel(
    private val saveSettings: SaveAccountSettings,
) : BaseViewModel&lt;AccountSettingsState, AccountSettingsEvent, AccountSettingsEffect&gt;(
    initialState = AccountSettingsState()
) {
    override fun event(event: AccountSettingsEvent) {
        when (event) {
            is AccountSettingsEvent.SettingChanged -&gt; {
                // Update state with new setting value
                updateState { state -&gt;
                    val updatedSettings = state.settings?.copy() ?: return@updateState state
                    updatedSettings.updateSetting(event.setting, event.value)
                    state.copy(settings = updatedSettings)
                }
            }
            is AccountSettingsEvent.SaveClicked -&gt; saveAccountSettings()
            is AccountSettingsEvent.RetryClicked -&gt; loadSettings()
            is AccountSettingsEvent.BackClicked -&gt; 
                emitEffect(AccountSettingsEffect.NavigateBack)
        }
    }

    private fun saveAccountSettings() {
        viewModelScope.launch {
            updateState { it.copy(isLoading = true) }

            val result = saveSettings(state.value.settings!!)

            if (result.isSuccess) {
                emitEffect(AccountSettingsEffect.ShowMessage("Settings saved"))
                emitEffect(AccountSettingsEffect.NavigateBack)
            } else {
                updateState { it.copy(
                    isLoading = false,
                    error = "Failed to save settings"
                )}
            }
        }
    }

    // Other methods...
}

// 3. Dispatch events from UI
@Composable
fun AccountSettingsContent(
    state: AccountSettingsState,
    onEvent: (AccountSettingsEvent) -&gt; Unit,
) {
    Column(modifier = Modifier.padding(16.dp)) {
        if (state.settings != null) {
            // Setting fields
            for (setting in state.settings.items) {
                SettingItem(
                    setting = setting,
                    onValueChanged = { newValue -&gt;
                        // Dispatch SettingChanged event
                        onEvent(AccountSettingsEvent.SettingChanged(setting, newValue))
                    }
                )
            }

            // Save button
            Button(
                onClick = { 
                    // Dispatch SaveClicked event
                    onEvent(AccountSettingsEvent.SaveClicked) 
                },
                modifier = Modifier.align(Alignment.End)
            ) {
                Text("Save")
            }
        }

        // Back button
        TextButton(
            onClick = { 
                // Dispatch BackClicked event
                onEvent(AccountSettingsEvent.BackClicked) 
            }
        ) {
            Text("Back")
        }
    }
}
</code></pre>
<h4 id="-effects"><a class="header" href="#-effects">🔔 Effects</a></h4>
<ul>
<li>Represent one-time side effects that don’t belong in the state</li>
<li>Emitted by the ViewModel to trigger navigation, show messages, or perform other one-time actions</li>
<li>Handled by the UI layer (Screen composables) to execute the appropriate action</li>
<li>Implemented using Kotlin’s <code>SharedFlow</code> for asynchronous, non-blocking delivery</li>
</ul>
<p>Effects are essential for handling actions that should happen only once and shouldn’t be part of the UI state. Common use cases for effects include:</p>
<ul>
<li>Navigation (e.g., navigating to another screen)</li>
<li>Showing transient UI elements (e.g., snackbars, toasts)</li>
<li>Playing sounds or haptic feedback</li>
<li>Triggering system actions (e.g., sharing content, opening URLs)</li>
</ul>
<p><strong>Example: Effects in Action</strong></p>
<p>Here’s a simplified example showing how effects are defined, emitted, and handled:</p>
<pre><code class="language-kotlin">// 1. Define effects
sealed interface AccountSettingsEffect {
    data object NavigateBack : AccountSettingsEffect
    data class ShowMessage(val message: String) : AccountSettingsEffect
}

// 2. Emit effects from ViewModel
class AccountSettingsViewModel : BaseViewModel&lt;AccountSettingsState, AccountSettingsEvent, AccountSettingsEffect&gt;(
    initialState = AccountSettingsState()
) {
    override fun event(event: AccountSettingsEvent) {
        when (event) {
            is AccountSettingsEvent.SaveClicked -&gt; {
                // Save settings and show success message
                emitEffect(AccountSettingsEffect.ShowMessage("Settings saved"))
                emitEffect(AccountSettingsEffect.NavigateBack)
            }
            is AccountSettingsEvent.BackClicked -&gt; 
                emitEffect(AccountSettingsEffect.NavigateBack)
        }
    }
}

// 3. Handle effects in UI
@Composable
fun AccountSettingsScreen(
    onNavigateBack: () -&gt; Unit,
    viewModel: AccountSettingsViewModel = koinViewModel(),
) {
    val snackbarHostState = remember { SnackbarHostState() }

    val (state, dispatch) = viewModel.observe { effect -&gt;
        when (effect) {
            AccountSettingsEffect.NavigateBack -&gt; onNavigateBack()
            is AccountSettingsEffect.ShowMessage -&gt; {
                CoroutineScope(Dispatchers.Main).launch {
                    snackbarHostState.showSnackbar(effect.message)
                }
            }
        }
    }

    // Screen content with snackbar host...
}
</code></pre>
<h4 id="-actions"><a class="header" href="#-actions">⚡ Actions</a></h4>
<ul>
<li>Represent calls to domain layer use cases</li>
<li>Triggered by the ViewModel in response to events</li>
<li>Bridge between UI and domain layers</li>
<li>Execute business logic and return results to the ViewModel</li>
</ul>
<p>Example:</p>
<pre><code class="language-kotlin">// In a domain layer repository interface
interface AccountRepository {
    suspend fun getAccount(accountId: String): Account
    suspend fun updateAccount(account: Account): Result&lt;Unit&gt;
    suspend fun deleteAccount(accountId: String): Result&lt;Unit&gt;
}

// Use case with operator fun invoke pattern (recommended approach)
// In a domain layer use case interface
fun interface UpdateAccount {
    suspend operator fun invoke(account: Account): Result&lt;Unit&gt;
}

// Use case implementation
class UpdateAccountImpl(
    private val accountRepository: AccountRepository
) : UpdateAccount {
    override suspend operator fun invoke(account: Account): Result&lt;Unit&gt; {
        return accountRepository.updateAccount(account)
    }
}

// In the ViewModel
class AccountSettingsViewModel(
    private val updateAccount: UpdateAccount,
) : BaseViewModel&lt;AccountSettingsState, AccountSettingsEvent, AccountSettingsEffect&gt;(
    initialState = AccountSettingsState()
) {
    // Event handler
    override fun event(event: AccountSettingsEvent) {
        when (event) {
            is AccountSettingsEvent.SaveClicked -&gt; saveAccount() // Triggers an action
        }
    }

    // Action
    private fun saveAccount() {
        viewModelScope.launch {
            updateState { it.copy(isLoading = true) }

            // Call to domain layer use case (the action) using invoke operator
            val result = updateAccount(currentAccount)

            when (result) {
                is Result.Success -&gt; {
                    updateState { it.copy(isLoading = false) }
                    emitEffect(AccountSettingsEffect.NavigateBack)
                }
                is Result.Error -&gt; {
                    updateState { 
                        it.copy(
                            isLoading = false,
                            error = result.message
                        )
                    }
                }
            }
        }
    }
}
</code></pre>
<h4 id="-results-outcomes"><a class="header" href="#-results-outcomes">📊 Results (Outcomes)</a></h4>
<ul>
<li>Represent the outcome of actions executed by use cases</li>
<li>Can be success or error</li>
<li>Used by the ViewModel to update the state or emit effects</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-kotlin">// Result types for account creation
sealed interface AccountCreatorResult {
    data class Success(val accountUuid: String) : AccountCreatorResult

    sealed interface Error : AccountCreatorResult {
        data class Validation(val errors: List&lt;ValidationError&gt;) : Error
        data class Creation(val message: String) : Error
        data class Network(val exception: NetworkException) : Error
    }
}

// In ViewModel
private fun handleResult(result: AccountCreatorResult) {
    when (result) {
        is AccountCreatorResult.Success -&gt; {
            // Update state with success
            updateState { it.copy(isLoading = false, error = null) }
            // Emit navigation effect
            emitEffect(Effect.NavigateNext(AccountUuid(result.accountUuid)))
        }
        is AccountCreatorResult.Error -&gt; {
            // Update state with error
            updateState { it.copy(isLoading = false, error = result) }
            // Optionally emit effect for error handling
            when (result) {
                is AccountCreatorResult.Error.Network -&gt; 
                    emitEffect(Effect.ShowNetworkError(result.exception))
                else -&gt; { /* Handle other errors */ }
            }
        }
    }
}
</code></pre>
<h2 id="-navigation"><a class="header" href="#-navigation">🧭 Navigation</a></h2>
<p>The application uses the Jetpack Navigation Compose library for navigation between screens:</p>
<ul>
<li><strong>📱 Navigation Graph</strong>: Defines the screens and their relationships</li>
<li><strong>🔗 Navigation Arguments</strong>: Type-safe arguments passed between destinations</li>
<li><strong>🔙 Back Stack Management</strong>: Handles the navigation back stack</li>
<li><strong>↩️ Deep Linking</strong>: Supports deep linking to specific screens</li>
</ul>
<h3 id="navigation-setup"><a class="header" href="#navigation-setup">Navigation Setup</a></h3>
<p>To set up navigation in the app, you need to:</p>
<ol>
<li>Define route constants</li>
<li>Create a NavHost with composable destinations</li>
<li>Handle navigation callbacks in screens</li>
<li>Use ViewModels to emit navigation effects</li>
</ol>
<p>Example:</p>
<pre><code class="language-kotlin">// Define route constants
private const val ROUTE_HOME = "home"
private const val ROUTE_SETTINGS = "settings"
private const val ROUTE_DETAILS = "details/{itemId}"

@Composable
fun AppNavHost(
    onFinish: () -&gt; Unit,
) {
    val navController = rememberNavController()

    NavHost(
        navController = navController,
        startDestination = ROUTE_HOME,
    ) {
        composable(route = ROUTE_HOME) {
            HomeScreen(
                onNavigateToSettings = { navController.navigate(ROUTE_SETTINGS) },
                onNavigateToDetails = { itemId -&gt; 
                    navController.navigate("details/$itemId") 
                },
                viewModel = koinViewModel(),
            )
        }

        composable(route = ROUTE_SETTINGS) {
            SettingsScreen(
                onBack = { navController.popBackStack() },
                onFinish = onFinish,
                viewModel = koinViewModel(),
            )
        }

        composable(
            route = ROUTE_DETAILS,
            arguments = listOf(
                navArgument("itemId") { type = NavType.StringType }
            )
        ) { backStackEntry -&gt;
            val itemId = backStackEntry.arguments?.getString("itemId") ?: ""
            DetailsScreen(
                itemId = itemId,
                onBack = { navController.popBackStack() },
                viewModel = koinViewModel(),
            )
        }
    }
}
</code></pre>
<h3 id="navigation-in-screens"><a class="header" href="#navigation-in-screens">Navigation in Screens</a></h3>
<p>In your screen composables, you handle navigation by observing effects from the ViewModel:</p>
<pre><code class="language-kotlin">@Composable
fun HomeScreen(
    onNavigateToSettings: () -&gt; Unit,
    onNavigateToDetails: (String) -&gt; Unit,
    viewModel: HomeViewModel,
) {
    val (state, dispatch) = viewModel.observe { effect -&gt;
        when (effect) {
            is HomeEffect.NavigateToSettings -&gt; onNavigateToSettings()
            is HomeEffect.NavigateToDetails -&gt; onNavigateToDetails(effect.itemId)
        }
    }

    // Screen content
}
</code></pre>
<h3 id="navigation-in-viewmodels"><a class="header" href="#navigation-in-viewmodels">Navigation in ViewModels</a></h3>
<p>In your ViewModels, you emit navigation effects:</p>
<pre><code class="language-kotlin">class HomeViewModel : BaseViewModel&lt;HomeState, HomeEvent, HomeEffect&gt;(
    initialState = HomeState()
) {
    override fun event(event: HomeEvent) {
        when (event) {
            is HomeEvent.SettingsClicked -&gt; emitEffect(HomeEffect.NavigateToSettings)
            is HomeEvent.ItemClicked -&gt; emitEffect(HomeEffect.NavigateToDetails(event.itemId))
        }
    }
}
</code></pre>
<h2 id="-complete-end-to-end-example"><a class="header" href="#-complete-end-to-end-example">🔄 Complete End-to-End Example</a></h2>
<p>Here’s a complete example of how all the components work together in a real-world scenario, using the CreateAccount feature:</p>
<h3 id="1-define-the-contract"><a class="header" href="#1-define-the-contract">1. Define the Contract</a></h3>
<p>First, define the contract that specifies the State, Events, and Effects:</p>
<pre><code class="language-kotlin">interface CreateAccountContract {

    interface ViewModel : UnidirectionalViewModel&lt;State, Event, Effect&gt;

    data class State(
        override val isLoading: Boolean = true,
        override val error: Error? = null,
    ) : LoadingErrorState&lt;Error&gt;

    sealed interface Event {
        data object CreateAccount : Event
        data object OnBackClicked : Event
    }

    sealed interface Effect {
        data class NavigateNext(val accountUuid: AccountUuid) : Effect
        data object NavigateBack : Effect
    }
}
</code></pre>
<h3 id="2-implement-the-viewmodel"><a class="header" href="#2-implement-the-viewmodel">2. Implement the ViewModel</a></h3>
<p>Next, implement the ViewModel that handles events, updates state, and emits effects:</p>
<pre><code class="language-kotlin">class CreateAccountViewModel(
    private val createAccount: CreateAccount,
    private val accountStateRepository: AccountStateRepository,
    initialState: State = State(),
) : BaseViewModel&lt;State, Event, Effect&gt;(initialState),
    CreateAccountContract.ViewModel {

    override fun event(event: Event) {
        when (event) {
            Event.CreateAccount -&gt; createAccount()
            Event.OnBackClicked -&gt; maybeNavigateBack()
        }
    }

    private fun createAccount() {
        val accountState = accountStateRepository.getState()

        viewModelScope.launch {
            updateState { it.copy(isLoading = true, error = null) }

            when (val result = createAccount(accountState)) {
                is AccountCreatorResult.Success -&gt; showSuccess(AccountUuid(result.accountUuid))
                is AccountCreatorResult.Error -&gt; showError(result)
            }
        }
    }

    private fun showSuccess(accountUuid: AccountUuid) {
        updateState {
            it.copy(
                isLoading = false,
                error = null,
            )
        }

        viewModelScope.launch {
            delay(WizardConstants.CONTINUE_NEXT_DELAY)
            navigateNext(accountUuid)
        }
    }

    private fun showError(error: AccountCreatorResult.Error) {
        updateState {
            it.copy(
                isLoading = false,
                error = error,
            )
        }
    }

    private fun maybeNavigateBack() {
        if (!state.value.isLoading) {
            navigateBack()
        }
    }

    private fun navigateBack() {
        viewModelScope.coroutineContext.cancelChildren()
        emitEffect(Effect.NavigateBack)
    }

    private fun navigateNext(accountUuid: AccountUuid) {
        viewModelScope.coroutineContext.cancelChildren()
        emitEffect(Effect.NavigateNext(accountUuid))
    }
}
</code></pre>
<h3 id="3-create-the-screen-composable"><a class="header" href="#3-create-the-screen-composable">3. Create the Screen Composable</a></h3>
<p>Then, create the screen composable that observes the ViewModel and handles effects:</p>
<pre><code class="language-kotlin">@Composable
internal fun CreateAccountScreen(
    onNext: (AccountUuid) -&gt; Unit,
    onBack: () -&gt; Unit,
    viewModel: ViewModel,
    brandNameProvider: BrandNameProvider,
    modifier: Modifier = Modifier,
) {
    val (state, dispatch) = viewModel.observe { effect -&gt;
        when (effect) {
            Effect.NavigateBack -&gt; onBack()
            is Effect.NavigateNext -&gt; onNext(effect.accountUuid)
        }
    }

    LaunchedEffect(key1 = Unit) {
        dispatch(Event.CreateAccount)
    }

    BackHandler {
        dispatch(Event.OnBackClicked)
    }

    Scaffold(
        topBar = {
            AppTitleTopHeader(
                title = brandNameProvider.brandName,
            )
        },
        bottomBar = {
            WizardNavigationBar(
                onNextClick = {},
                onBackClick = {
                    dispatch(Event.OnBackClicked)
                },
                state = WizardNavigationBarState(
                    showNext = false,
                    isBackEnabled = state.value.error != null,
                ),
            )
        },
        modifier = modifier,
    ) { innerPadding -&gt;
        CreateAccountContent(
            state = state.value,
            contentPadding = innerPadding,
        )
    }
}
</code></pre>
<h3 id="4-create-the-content-composable"><a class="header" href="#4-create-the-content-composable">4. Create the Content Composable</a></h3>
<p>Finally, create the content composable that renders the UI based on the state:</p>
<pre><code class="language-kotlin">@Composable
private fun CreateAccountContent(
    state: State,
    contentPadding: PaddingValues,
    modifier: Modifier = Modifier,
) {
    Box(
        modifier = modifier
            .fillMaxSize()
            .padding(contentPadding),
    ) {
        when {
            state.isLoading -&gt; {
                CircularProgressIndicator(
                    modifier = Modifier.align(Alignment.Center),
                )
            }
            state.error != null -&gt; {
                ErrorView(
                    error = state.error,
                    modifier = Modifier.align(Alignment.Center),
                )
            }
        }
    }
}
</code></pre>
<h3 id="5-add-to-navigation"><a class="header" href="#5-add-to-navigation">5. Add to Navigation</a></h3>
<p>Add the screen to the navigation graph:</p>
<pre><code class="language-kotlin">NavHost(
    navController = navController,
    startDestination = ROUTE_HOME,
) {
    // Other composables...

    composable(route = NESTED_NAVIGATION_CREATE_ACCOUNT) {
        CreateAccountScreen(
            onNext = { accountUuid -&gt; onFinish(AccountSetupRoute.AccountSetup(accountUuid.value)) },
            onBack = { navController.popBackStack() },
            viewModel = koinViewModel&lt;CreateAccountViewModel&gt;(),
            brandNameProvider = koinInject(),
        )
    }
}
</code></pre>
<p>This example demonstrates the complete flow from UI to ViewModel to Domain and back, showing how all the components work together in a real-world scenario.</p>
<h2 id="-component-interactions-and-state-changes"><a class="header" href="#-component-interactions-and-state-changes">🔄 Component Interactions and State Changes</a></h2>
<p>Understanding how components interact and how state changes flow through the system is crucial for working with our MVI architecture. Here’s a detailed explanation of the interaction flow:</p>
<pre class="mermaid">sequenceDiagram
    participant User
    participant View
    participant ViewModel
    participant UseCase
    participant Repository

    User-&gt;&gt;View: User Interaction
    View-&gt;&gt;ViewModel: Event
    ViewModel-&gt;&gt;ViewModel: Process Event
    ViewModel-&gt;&gt;UseCase: Action (Execute Use Case)
    UseCase-&gt;&gt;Repository: Data Operation
    Repository--&gt;&gt;UseCase: Result
    UseCase--&gt;&gt;ViewModel: Result
    ViewModel-&gt;&gt;ViewModel: Update State
    ViewModel--&gt;&gt;View: New State
    View--&gt;&gt;User: UI Update

    Note over ViewModel,View: Side Effect (if needed)
    ViewModel-&gt;&gt;View: Effect
    View-&gt;&gt;User: One-time Action (e.g., Navigation)
</pre>
<h3 id="interaction-flow"><a class="header" href="#interaction-flow">Interaction Flow</a></h3>
<ol>
<li><strong>User Interaction</strong>: The user interacts with the UI (e.g., clicks a button, enters text)</li>
<li><strong>Event Dispatch</strong>: The View captures this interaction and dispatches an Event to the ViewModel</li>
<li><strong>Event Processing</strong>: The ViewModel processes the Event and determines what action to take</li>
<li><strong>Action Execution</strong>: The ViewModel executes an Action, typically by calling a Use Case</li>
<li><strong>Domain Logic</strong>: The Use Case executes business logic, often involving repositories or other domain services</li>
<li><strong>Result Handling</strong>: The Use Case returns a result to the ViewModel</li>
<li><strong>State Update</strong>: The ViewModel updates its State based on the result</li>
<li><strong>UI Update</strong>: The View observes the State change and updates the UI accordingly</li>
<li><strong>Side Effects (if needed)</strong>: For one-time actions like navigation, the ViewModel emits an Effect that the View handles</li>
</ol>
<h3 id="state-changes"><a class="header" href="#state-changes">State Changes</a></h3>
<p>State changes follow a unidirectional flow:</p>
<ol>
<li><strong>State Immutability</strong>: The State is an immutable data class that represents the entire UI state</li>
<li><strong>Single Source of Truth</strong>: The ViewModel is the single source of truth for the State</li>
<li><strong>State Updates</strong>: Only the ViewModel can update the State, using the <code>updateState</code> method</li>
<li><strong>State Observation</strong>: The View observes the State using <code>collectAsStateWithLifecycle()</code> and recomposes when it changes</li>
<li><strong>State Rendering</strong>: The View renders the UI based on the current State</li>
</ol>
<p>Example of state changes in the ViewModel:</p>
<pre><code class="language-kotlin">// Initial state
val initialState = AccountSettingsState(isLoading = false, settings = null, error = null)

// Update state to show loading
updateState { it.copy(isLoading = true, error = null) }

// Update state with loaded settings
updateState { it.copy(isLoading = false, settings = loadedSettings, error = null) }

// Update state to show error
updateState { it.copy(isLoading = false, error = "Failed to load settings") }
</code></pre>
<h3 id="component-responsibilities"><a class="header" href="#component-responsibilities">Component Responsibilities</a></h3>
<p>Each component has specific responsibilities in the interaction flow:</p>
<ol>
<li><strong>View</strong>:
<ul>
<li>Render UI based on State</li>
<li>Capture user interactions</li>
<li>Dispatch Events to ViewModel</li>
<li>Handle Effects (e.g., navigation)</li>
</ul>
</li>
<li><strong>ViewModel</strong>:
<ul>
<li>Process Events</li>
<li>Execute Actions (Use Cases)</li>
<li>Update State</li>
<li>Emit Effects</li>
</ul>
</li>
<li><strong>Use Cases</strong>:
<ul>
<li>Execute business logic</li>
<li>Coordinate with repositories and domain services</li>
<li>Return results to ViewModel</li>
</ul>
</li>
<li><strong>Repositories</strong>:
<ul>
<li>Provide data access</li>
<li>Handle data operations</li>
<li>Return data to Use Cases</li>
</ul>
</li>
</ol>
<p>This clear separation of responsibilities ensures that each component focuses on its specific role, making the codebase more maintainable, testable, and scalable.</p>
<h2 id="-accessibility"><a class="header" href="#-accessibility">♿ Accessibility</a></h2>
<p>The UI is designed with accessibility in mind:</p>
<ul>
<li><strong>🔍 Content Scaling</strong>: Support for font scaling and dynamic text sizes</li>
<li><strong>🎙️ Screen Readers</strong>: Semantic properties for screen reader support</li>
<li><strong>🎯 Touch Targets</strong>: Appropriately sized touch targets</li>
<li><strong>🎨 Color Contrast</strong>: Sufficient color contrast for readability</li>
<li><strong>⌨️ Keyboard Navigation</strong>: Support for keyboard navigation</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-theming"><a class="header" href="#-theming">🎭 Theming</a></h1>
<p>This document provides a detailed explanation of the theming system used in our applications. It covers the theme
architecture, components, customization, and usage.</p>
<ul>
<li><strong>✨ Material Design 3</strong>: Based on Material Design 3 principles</li>
<li><strong>🎨 Colors</strong>: Custom color schemes with light and dark modes
<ul>
<li><strong>🌓 Dark Mode</strong>: Full support for light and dark themes</li>
<li><strong>🌈 Dynamic Color</strong>: Support for dynamic color based on system settings</li>
</ul>
</li>
<li><strong>🪜 Elevations</strong>: Consistent elevation system for shadows</li>
<li><strong>🖼️ Images</strong>: Images and icons consistent with the theme</li>
<li><strong>🔶 Shapes</strong>: Customizable shape system for components</li>
<li><strong>📐 Sizes</strong>: Standardized sizes for components</li>
<li><strong>📏 Spacings</strong>: Consistent spacing system for layout</li>
<li><strong>🅰️ Typography</strong>: Consistent typography system</li>
</ul>
<h2 id="-theme-architecture"><a class="header" href="#-theme-architecture">📱 Theme Architecture</a></h2>
<p>Our theme architecture is designed with several key principles in mind:</p>
<ol>
<li><strong>Consistency</strong>: Provide a unified look and feel across all applications while allowing for brand-specific customization</li>
<li><strong>Flexibility</strong>: Support different visual identities for different applications (Thunderbird, K-9 Mail) using the same underlying system</li>
<li><strong>Extensibility</strong>: Enable easy addition of new theme components or modification of existing ones</li>
<li><strong>Maintainability</strong>: Centralize theme definitions to simplify updates and changes</li>
<li><strong>Material Design Compatibility</strong>: Build on top of Material Design 3 while extending it with our specific needs</li>
</ol>
<p>The theming system follows a hierarchical structure:</p>
<pre class="mermaid">graph TD
    subgraph APP_THEMES[&quot;App-Specific Themes&quot;]
        TB_THEME[ThunderbirdTheme2]
        K9_THEME[K9MailTheme2]
    end

    subgraph MAIN[&quot;Main Theme&quot;]
        MAIN_THEME[MainTheme]
        THEME_CONFIG[ThemeConfig]
    end

    subgraph MATERIAL[&quot;Material Design 3&quot;]
        MAT_THEME[MaterialTheme]
    end

    TB_THEME --&gt; |uses| MAIN_THEME
    TB_THEME --&gt; |defines| THEME_CONFIG
    K9_THEME --&gt; |uses| MAIN_THEME
    K9_THEME --&gt; |defines| THEME_CONFIG
    THEME_CONFIG --&gt; |configures| MAIN_THEME
    MAIN_THEME --&gt; |wraps| MAT_THEME

    classDef app_theme fill:#d9ffd9,stroke:#000000,color:#000000
    classDef main_theme fill:#d9e9ff,stroke:#000000,color:#000000
    classDef material fill:#ffe6cc,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class TB_THEME,K9_THEME app_theme
    class MAIN_THEME,THEME_CONFIG main_theme
    class MAT_THEME material
</pre>
<h3 id="-architecture-layers"><a class="header" href="#-architecture-layers">🏗️ Architecture Layers</a></h3>
<p>The theme system consists of three main layers:</p>
<ol>
<li><strong>App-Specific Themes Layer</strong>: The top layer contains theme implementations for specific applications (ThunderbirdTheme2, K9MailTheme2). Each app theme:
<ul>
<li>Defines its own brand colors, logos, and other app-specific visual elements</li>
<li>Creates a ThemeConfig with these customizations</li>
<li>Uses the MainTheme as its foundation</li>
</ul>
</li>
<li><strong>Main Theme Layer</strong>: The middle layer provides our extended theming system:
<ul>
<li>MainTheme: A composable function that sets up the theme environment</li>
<li>ThemeConfig: A data class that holds all theme components</li>
<li>This layer extends Material Design with additional components like custom spacings, elevations, and app-specific colors</li>
</ul>
</li>
<li><strong>Material Design Layer</strong>: The foundation layer is Material Design 3:
<ul>
<li>Provides the base theming system (colors, typography, shapes)</li>
<li>Ensures compatibility with standard Material components</li>
<li>Our MainTheme wraps MaterialTheme and converts our theme components to Material 3 format when needed</li>
</ul>
</li>
</ol>
<h3 id="-data-flow"><a class="header" href="#-data-flow">🔄 Data Flow</a></h3>
<p>The theme data flows through the system as follows:</p>
<ol>
<li>App-specific themes (ThunderbirdTheme2, K9MailTheme2) define their visual identity through a ThemeConfig</li>
<li>ThemeConfig is passed to MainTheme, which:
<ul>
<li>Selects the appropriate color scheme based on dark/light mode</li>
<li>Configures system bars (status bar, navigation bar)</li>
<li>Provides all theme components through CompositionLocal providers</li>
<li>Converts our theme components to Material 3 format and configures MaterialTheme</li>
</ul>
</li>
<li>Composables access theme properties through the MainTheme object</li>
<li>Material components automatically use the Material 3 theme derived from our theme</li>
</ol>
<h3 id="-benefits"><a class="header" href="#-benefits">🌟 Benefits</a></h3>
<p>This architecture provides several benefits:</p>
<ul>
<li><strong>Separation of Concerns</strong>: Each layer has a specific responsibility</li>
<li><strong>Code Reuse</strong>: Common theme logic is shared between applications</li>
<li><strong>Customization</strong>: Each application can have its own visual identity</li>
<li><strong>Consistency</strong>: All applications share the same theming structure and components</li>
<li><strong>Extensibility</strong>: New theme components can be added without changing the overall architecture</li>
<li><strong>Compatibility</strong>: Works with both our custom components and standard Material components</li>
</ul>
<h2 id="-theme-components"><a class="header" href="#-theme-components">🧩 Theme Components</a></h2>
<p>The theming system consists of several components that work together to provide a comprehensive and consistent visual experience across the application. Each component is responsible for a specific aspect of the UI design.</p>
<h3 id="-themeconfig"><a class="header" href="#-themeconfig">🔧 ThemeConfig</a></h3>
<p>The <code>ThemeConfig</code> is the central configuration class that holds all theme components. It serves as a container for all theme-related settings and is passed to the <code>MainTheme</code> composable.</p>
<pre><code class="language-kotlin">data class ThemeConfig(
    val colors: ThemeColorSchemeVariants,
    val elevations: ThemeElevations,
    val images: ThemeImageVariants,
    val shapes: ThemeShapes,
    val sizes: ThemeSizes,
    val spacings: ThemeSpacings,
    val typography: ThemeTypography,
)
</code></pre>
<p>The <code>ThemeConfig</code> allows for:</p>
<ul>
<li>Centralized management of all theme components</li>
<li>Easy switching between light and dark themes</li>
<li>Simplified theme customization for different applications</li>
<li>Consistent theme application throughout the app</li>
</ul>
<h3 id="-themecolorscheme"><a class="header" href="#-themecolorscheme">🎨 ThemeColorScheme</a></h3>
<p>The <code>ThemeColorScheme</code> defines all colors used in the application. It extends Material Design 3’s color system with additional colors specific to our applications.</p>
<pre><code class="language-kotlin">data class ThemeColorScheme(
    // Material 3 colors
    val primary: Color,
    val onPrimary: Color,
    val primaryContainer: Color,
    val onPrimaryContainer: Color,
    val secondary: Color,
    val onSecondary: Color,
    val secondaryContainer: Color,
    val onSecondaryContainer: Color,
    val tertiary: Color,
    val onTertiary: Color,
    val tertiaryContainer: Color,
    val onTertiaryContainer: Color,
    val error: Color,
    val onError: Color,
    val errorContainer: Color,
    val onErrorContainer: Color,
    val surfaceDim: Color,
    val surface: Color,
    val surfaceBright: Color,
    val onSurface: Color,
    val onSurfaceVariant: Color,
    val surfaceContainerLowest: Color,
    val surfaceContainerLow: Color,
    val surfaceContainer: Color,
    val surfaceContainerHigh: Color,
    val surfaceContainerHighest: Color,
    val inverseSurface: Color,
    val inverseOnSurface: Color,
    val inversePrimary: Color,
    val outline: Color,
    val outlineVariant: Color,
    val scrim: Color,

    // Extra colors
    val info: Color,
    val onInfo: Color,
    val infoContainer: Color,
    val onInfoContainer: Color,
    val success: Color,
    val onSuccess: Color,
    val successContainer: Color,
    val onSuccessContainer: Color,
    val warning: Color,
    val onWarning: Color,
    val warningContainer: Color,
    val onWarningContainer: Color,
)
</code></pre>
<p>The color scheme is organized into:</p>
<ul>
<li><strong>Base colors</strong>: Primary, secondary, and tertiary colors that define the app’s brand identity</li>
<li><strong>Surface colors</strong>: Colors for backgrounds, cards, and other surfaces</li>
<li><strong>Content colors</strong>: Colors for text and icons that appear on various backgrounds (prefixed with “on”)</li>
<li><strong>Container colors</strong>: Colors for containers like buttons, chips, and other interactive elements</li>
<li><strong>Utility colors</strong>: Colors for specific purposes like errors, outlines, and scrims</li>
</ul>
<p>Colors are provided in variants for both light and dark themes through the <code>ThemeColorSchemeVariants</code> class:</p>
<pre><code class="language-kotlin">data class ThemeColorSchemeVariants(
    val light: ThemeColorScheme,
    val dark: ThemeColorScheme,
)
</code></pre>
<h3 id="-themeelevations"><a class="header" href="#-themeelevations">🪜 ThemeElevations</a></h3>
<p>The <code>ThemeElevations</code> component defines standard elevation values used throughout the application to create a consistent sense of depth and hierarchy.</p>
<pre><code class="language-kotlin">data class ThemeElevations(
    val level0: Dp,
    val level1: Dp,
    val level2: Dp,
    val level3: Dp,
    val level4: Dp,
    val level5: Dp,
)
</code></pre>
<p>Typical usage includes:</p>
<ul>
<li><strong>level0</strong>: For elements that are flush with their background (0dp)</li>
<li><strong>level1</strong>: For subtle elevation like dividers (1dp)</li>
<li><strong>level2</strong>: For cards, buttons in their resting state (3dp)</li>
<li><strong>level3</strong>: For floating action buttons, navigation drawers (6dp)</li>
<li><strong>level4</strong>: For dialogs, bottom sheets (8dp)</li>
<li><strong>level5</strong>: For modal surfaces that should appear prominently (12dp)</li>
</ul>
<h3 id="-themeimages"><a class="header" href="#-themeimages">🖼️ ThemeImages</a></h3>
<p>The <code>ThemeImages</code> component stores references to app-specific images like logos, icons, and illustrations.</p>
<pre><code class="language-kotlin">data class ThemeImages(
    val logo: Int, // Resource ID
    // ... other image resources
)
</code></pre>
<p>These images can have light and dark variants through the <code>ThemeImageVariants</code> class:</p>
<pre><code class="language-kotlin">data class ThemeImageVariants(
    val light: ThemeImages,
    val dark: ThemeImages,
)
</code></pre>
<h3 id="-themeshapes"><a class="header" href="#-themeshapes">🔶 ThemeShapes</a></h3>
<p>The <code>ThemeShapes</code> component defines the corner shapes used for UI elements throughout the application.</p>
<pre><code class="language-kotlin">data class ThemeShapes(
    val extraSmall: CornerBasedShape,
    val small: CornerBasedShape,
    val medium: CornerBasedShape,
    val large: CornerBasedShape,
    val extraLarge: CornerBasedShape,
)
</code></pre>
<p>These shapes are used for:</p>
<ul>
<li><strong>extraSmall</strong>: Subtle rounding for elements like text fields (4dp)</li>
<li><strong>small</strong>: Light rounding for cards, buttons (8dp)</li>
<li><strong>medium</strong>: Moderate rounding for floating elements (12dp)</li>
<li><strong>large</strong>: Significant rounding for prominent elements (16dp)</li>
<li><strong>extraLarge</strong>: Very rounded corners for special elements (28dp)</li>
</ul>
<p>Note: For no rounding (0% corner radius), use <code>RectangleShape</code>. For completely rounded corners (50% corner radius) for circular elements, use <code>CircleShape</code>.</p>
<p>The <code>ThemeShapes</code> can be converted to Material 3 shapes using the <code>toMaterial3Shapes()</code> method for compatibility with Material components.</p>
<h3 id="-themesizes"><a class="header" href="#-themesizes">📐 ThemeSizes</a></h3>
<p>The <code>ThemeSizes</code> component defines standard size values for UI elements to ensure consistent sizing throughout the application.</p>
<pre><code class="language-kotlin">data class ThemeSizes(
    val smaller: Dp,
    val small: Dp,
    val medium: Dp,
    val large: Dp,
    val larger: Dp,
    val huge: Dp,
    val huger: Dp,

    val iconSmall: Dp,
    val icon: Dp,
    val iconLarge: Dp,
    val iconAvatar: Dp,

    val topBarHeight: Dp,
    val bottomBarHeight: Dp,
    val bottomBarHeightWithFab: Dp,
)
</code></pre>
<p>These sizes are used for:</p>
<ul>
<li><strong>General sizes</strong>: <code>smaller</code>, <code>small</code>, <code>medium</code>, <code>large</code>, <code>larger</code>, <code>huge</code>, <code>huger</code> for component dimensions (width, height), button heights, and other UI element dimensions that need standardization</li>
<li><strong>Icon sizes</strong>: <code>iconSmall</code>, <code>icon</code>, <code>iconLarge</code> for different icon sizes throughout the app</li>
<li><strong>Avatar size</strong>: <code>iconAvatar</code> for user avatars and profile pictures</li>
<li><strong>Layout sizes</strong>: <code>topBarHeight</code>, <code>bottomBarHeight</code>, <code>bottomBarHeightWithFab</code> for consistent app bar and navigation bar heights</li>
</ul>
<h3 id="-themespacings"><a class="header" href="#-themespacings">📏 ThemeSpacings</a></h3>
<p>The <code>ThemeSpacings</code> component defines standard spacing values used for margins, padding, and gaps between elements.</p>
<pre><code class="language-kotlin">data class ThemeSpacings(
    val zero: Dp,
    val quarter: Dp,
    val half: Dp,
    val default: Dp,
    val oneHalf: Dp,
    val double: Dp,
    val triple: Dp,
    val quadruple: Dp,
)
</code></pre>
<p>Consistent spacing helps create a rhythmic and harmonious layout:</p>
<ul>
<li><strong>zero</strong>: No spacing (0dp)</li>
<li><strong>quarter</strong>: Quarter of the default spacing, for very tight layouts (4dp)</li>
<li><strong>half</strong>: Half of the default spacing, for tight layouts (8dp)</li>
<li><strong>default</strong>: The standard spacing unit for general use (16dp)</li>
<li><strong>oneHalf</strong>: One and a half times the default spacing (24dp)</li>
<li><strong>double</strong>: Twice the default spacing, for separating sections (32dp)</li>
<li><strong>triple</strong>: Three times the default spacing, for major layout divisions (48dp)</li>
<li><strong>quadruple</strong>: Four times the default spacing, for maximum separation (64dp)</li>
</ul>
<h3 id="🅰-themetypography"><a class="header" href="#🅰-themetypography">🅰️ ThemeTypography</a></h3>
<p>The <code>ThemeTypography</code> component defines text styles for different types of content throughout the application.</p>
<pre><code class="language-kotlin">data class ThemeTypography(
    // Display styles for large headlines
    val displayLarge: TextStyle,
    val displayMedium: TextStyle,
    val displaySmall: TextStyle,

    // Headline styles for section headers
    val headlineLarge: TextStyle,
    val headlineMedium: TextStyle,
    val headlineSmall: TextStyle,

    // Title styles for content titles
    val titleLarge: TextStyle,
    val titleMedium: TextStyle,
    val titleSmall: TextStyle,

    // Body styles for main content
    val bodyLarge: TextStyle,
    val bodyMedium: TextStyle,
    val bodySmall: TextStyle,

    // Label styles for buttons and small text
    val labelLarge: TextStyle,
    val labelMedium: TextStyle,
    val labelSmall: TextStyle,
)
</code></pre>
<p>Each <code>TextStyle</code> includes:</p>
<ul>
<li>Font family</li>
<li>Font weight</li>
<li>Font size</li>
<li>Line height</li>
<li>Letter spacing</li>
<li>Other typographic attributes</li>
</ul>
<p>The <code>ThemeTypography</code> can be converted to Material 3 typography using the <code>toMaterial3Typography()</code> method for compatibility with Material components.</p>
<h3 id="-component-interaction"><a class="header" href="#-component-interaction">↔️ Component Interaction</a></h3>
<p>These theme components work together to create a cohesive design system:</p>
<ol>
<li><strong>ThemeConfig</strong> aggregates all components and provides them to the <code>MainTheme</code></li>
<li><strong>MainTheme</strong> makes components available through <code>CompositionLocal</code> providers</li>
<li>Composables access theme components through the <code>MainTheme</code> object</li>
<li>Components like <code>ThemeColorScheme</code> and <code>ThemeShapes</code> are converted to Material 3 equivalents for use with Material components</li>
</ol>
<p>This structured approach ensures consistent design application throughout the app while providing flexibility for customization.</p>
<h2 id="-maintheme"><a class="header" href="#-maintheme">🌟 MainTheme</a></h2>
<p>The <code>MainTheme</code> is the foundation of our theming system:</p>
<ul>
<li>Acts as a wrapper around Material Design 3’s <code>MaterialTheme</code></li>
<li>Provides additional theme components beyond what Material Design offers</li>
<li>Configurable through a <code>ThemeConfig</code> parameter</li>
<li>Supports dark mode and dynamic color</li>
<li>Exposes theme components through the <code>MainTheme</code> object</li>
</ul>
<h3 id="-theme-provider-implementation-and-usage"><a class="header" href="#-theme-provider-implementation-and-usage">🔌 Theme Provider Implementation and Usage</a></h3>
<h4 id="-how-the-theme-provider-works"><a class="header" href="#-how-the-theme-provider-works">🛠️ How the Theme Provider Works</a></h4>
<p>The <code>MainTheme</code> function uses Jetpack Compose’s <code>CompositionLocalProvider</code> to make theme components available throughout the composition tree:</p>
<pre><code class="language-kotlin">@Composable
fun MainTheme(
    themeConfig: ThemeConfig,
    darkTheme: Boolean = isSystemInDarkTheme(),
    dynamicColor: Boolean = true,
    content: @Composable () -&gt; Unit,
) {
    val themeColorScheme = selectThemeColorScheme(
        themeConfig = themeConfig,
        darkTheme = darkTheme,
        dynamicColor = dynamicColor,
    )
    val themeImages = selectThemeImages(
        themeConfig = themeConfig,
        darkTheme = darkTheme,
    )

    SystemBar(
        darkTheme = darkTheme,
        colorScheme = themeColorScheme,
    )

    CompositionLocalProvider(
        LocalThemeColorScheme provides themeColorScheme,
        LocalThemeElevations provides themeConfig.elevations,
        LocalThemeImages provides themeImages,
        LocalThemeShapes provides themeConfig.shapes,
        LocalThemeSizes provides themeConfig.sizes,
        LocalThemeSpacings provides themeConfig.spacings,
        LocalThemeTypography provides themeConfig.typography,
    ) {
        MaterialTheme(
            colorScheme = themeColorScheme.toMaterial3ColorScheme(),
            shapes = themeConfig.shapes.toMaterial3Shapes(),
            typography = themeConfig.typography.toMaterial3Typography(),
            content = content,
        )
    }
}
</code></pre>
<p>Each theme component is provided through a <code>CompositionLocal</code> that makes it available to all composables in the composition tree. These <code>CompositionLocal</code> values are defined using <code>staticCompositionLocalOf</code> in their respective files:</p>
<pre><code class="language-kotlin">internal val LocalThemeColorScheme = staticCompositionLocalOf&lt;ThemeColorScheme&gt; {
    error("No ThemeColorScheme provided")
}

internal val LocalThemeElevations = staticCompositionLocalOf&lt;ThemeElevations&gt; {
    error("No ThemeElevations provided")
}

// ... other LocalTheme* definitions
</code></pre>
<p>The <code>MainTheme</code> object provides properties to access these values from anywhere in the composition tree:</p>
<pre><code class="language-kotlin">object MainTheme {
    val colors: ThemeColorScheme
        @Composable
        @ReadOnlyComposable
        get() = LocalThemeColorScheme.current

    val elevations: ThemeElevations
        @Composable
        @ReadOnlyComposable
        get() = LocalThemeElevations.current

    // ... other properties
}
</code></pre>
<p>This theme provider mechanism ensures that theme components are available throughout the app without having to pass them as parameters to every composable.</p>
<h2 id="-app-specific-themes"><a class="header" href="#-app-specific-themes">🎭 App-Specific Themes</a></h2>
<p>The app-specific themes (<code>ThunderbirdTheme2</code> and <code>K9MailTheme2</code>) customize the <code>MainTheme</code> for each application:</p>
<ul>
<li>Provide app-specific color schemes</li>
<li>Include app-specific assets (like logos)</li>
<li>Configure theme components through <code>ThemeConfig</code></li>
<li>Use default values for common components (elevations, sizes, spacings, shapes, typography)</li>
</ul>
<h3 id="thunderbirdtheme2"><a class="header" href="#thunderbirdtheme2">ThunderbirdTheme2</a></h3>
<pre><code class="language-kotlin">@Composable
fun ThunderbirdTheme2(
    darkTheme: Boolean = isSystemInDarkTheme(),
    dynamicColor: Boolean = false,
    content: @Composable () -&gt; Unit,
) {
    val images = ThemeImages(
        logo = R.drawable.core_ui_theme2_thunderbird_logo,
    )

    val themeConfig = ThemeConfig(
        colors = ThemeColorSchemeVariants(
            dark = darkThemeColorScheme,
            light = lightThemeColorScheme,
        ),
        elevations = defaultThemeElevations,
        images = ThemeImageVariants(
            light = images,
            dark = images,
        ),
        sizes = defaultThemeSizes,
        spacings = defaultThemeSpacings,
        shapes = defaultThemeShapes,
        typography = defaultTypography,
    )

    MainTheme(
        themeConfig = themeConfig,
        darkTheme = darkTheme,
        dynamicColor = dynamicColor,
        content = content,
    )
}
</code></pre>
<h3 id="k9mailtheme2"><a class="header" href="#k9mailtheme2">K9MailTheme2</a></h3>
<pre><code class="language-kotlin">@Composable
fun K9MailTheme2(
    darkTheme: Boolean = isSystemInDarkTheme(),
    dynamicColor: Boolean = false,
    content: @Composable () -&gt; Unit,
) {
    val images = ThemeImages(
        logo = R.drawable.core_ui_theme2_k9mail_logo,
    )

    val themeConfig = ThemeConfig(
        colors = ThemeColorSchemeVariants(
            dark = darkThemeColorScheme,
            light = lightThemeColorScheme,
        ),
        elevations = defaultThemeElevations,
        images = ThemeImageVariants(
            light = images,
            dark = images,
        ),
        sizes = defaultThemeSizes,
        spacings = defaultThemeSpacings,
        shapes = defaultThemeShapes,
        typography = defaultTypography,
    )

    MainTheme(
        themeConfig = themeConfig,
        darkTheme = darkTheme,
        dynamicColor = dynamicColor,
        content = content,
    )
}
</code></pre>
<h2 id="-using-themes-in-the-app"><a class="header" href="#-using-themes-in-the-app">🎨 Using Themes in the App</a></h2>
<h3 id="-applying-a-theme"><a class="header" href="#-applying-a-theme">🧩 Applying a Theme</a></h3>
<p>To apply a theme to your UI, wrap your composables with the appropriate theme composable:</p>
<pre><code class="language-kotlin">// For Thunderbird app
@Composable
fun ThunderbirdApp() {
    ThunderbirdTheme2 {
        // App content
    }
}

// For K9Mail app
@Composable
fun K9MailApp() {
    K9MailTheme2 {
        // App content
    }
}
</code></pre>
<h3 id="-accessing-theme-components"><a class="header" href="#-accessing-theme-components">🔑 Accessing Theme Components</a></h3>
<p>Inside themed content, you can access theme properties through the <code>MainTheme</code> object:</p>
<pre><code class="language-kotlin">@Composable
fun ThemedButton(
    text: String,
    onClick: () -&gt; Unit,
    modifier: Modifier = Modifier,
) {
    Button(
        onClick = onClick,
        modifier = modifier,
        colors = ButtonDefaults.buttonColors(
            containerColor = MainTheme.colors.primary,
            contentColor = MainTheme.colors.onPrimary,
        ),
        shape = MainTheme.shapes.medium,
    ) {
        Text(
            text = text,
            style = MainTheme.typography.labelLarge,
        )
    }
}
</code></pre>
<h2 id="-dark-mode-and-dynamic-color"><a class="header" href="#-dark-mode-and-dynamic-color">🌓 Dark Mode and Dynamic Color</a></h2>
<p>The theming system supports both dark mode and dynamic color:</p>
<ul>
<li><strong>Dark Mode</strong>: Automatically applies the appropriate color scheme based on the system’s dark mode setting</li>
<li><strong>Dynamic Color</strong>: Optionally uses the device’s wallpaper colors for the theme (Android 12+)</li>
</ul>
<pre><code class="language-kotlin">@Composable
fun ThunderbirdTheme2(
    darkTheme: Boolean = isSystemInDarkTheme(), // Default to system setting
    dynamicColor: Boolean = false, // Disabled by default
    content: @Composable () -&gt; Unit,
) {
    // ...
}
</code></pre>
<h2 id="-customizing-themes"><a class="header" href="#-customizing-themes">🔧 Customizing Themes</a></h2>
<p>To customize a theme, you can create a new theme composable that wraps <code>MainTheme</code> with your custom <code>ThemeConfig</code>:</p>
<pre><code class="language-kotlin">@Composable
fun CustomTheme(
    darkTheme: Boolean = isSystemInDarkTheme(),
    dynamicColor: Boolean = false,
    content: @Composable () -&gt; Unit,
) {
    val images = ThemeImages(
        logo = R.drawable.custom_logo,
    )

    val themeConfig = ThemeConfig(
        colors = ThemeColorSchemeVariants(
            dark = customDarkThemeColorScheme,
            light = customLightThemeColorScheme,
        ),
        elevations = customThemeElevations,
        images = ThemeImageVariants(
            light = images,
            dark = images,
        ),
        sizes = customThemeSizes,
        spacings = customThemeSpacings,
        shapes = customThemeShapes,
        typography = customTypography,
    )

    MainTheme(
        themeConfig = themeConfig,
        darkTheme = darkTheme,
        dynamicColor = dynamicColor,
        content = content,
    )
}
</code></pre>
<h2 id="-testing-with-themes"><a class="header" href="#-testing-with-themes">🧪 Testing with Themes</a></h2>
<p>When writing tests for composables that use theme components, you need to wrap them in a theme:</p>
<pre><code class="language-kotlin">@Test
fun testThemedButton() {
    composeTestRule.setContent {
        ThunderbirdTheme2 {
            ThemedButton(
                text = "Click Me",
                onClick = {},
            )
        }
    }

    composeTestRule.onNodeWithText("Click Me").assertExists()
}
</code></pre>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-design-system"><a class="header" href="#-design-system">🎨 Design System</a></h1>
<p>The design system is a collection of guidelines, principles, and tools that help teams create consistent and cohesive visual designs and user experiences. It is built using the Atomic Design Methodology.</p>
<h2 id="-background"><a class="header" href="#-background">📚 Background</a></h2>
<p><a href="https://developer.android.com/jetpack/compose" title="" target="_blank">Jetpack Compose</a> is a declarative UI toolkit for Android that provides a modern and efficient way to build UIs for Android apps. In this context, design systems and atomic design can help designers and developers create more scalable, maintainable, and reusable UIs.</p>
<h3 id="-design-system-1"><a class="header" href="#-design-system-1">🧩 Design System</a></h3>
<p>A design system is a collection of guidelines, principles, and tools that help teams create consistent and cohesive visual designs and user experiences.
It typically includes a set of reusable components, such as icons, typography, color palettes, and layouts, that can be combined and customized to create new designs.</p>
<p>The design system also provides documentation and resources for designers and developers to ensure that the designs are implemented consistently and efficiently across all platforms and devices.
The goal of a design system is to streamline the design process, improve design quality, and maintain brand consistency.</p>
<p>An example is Google’s <a href="https://m3.material.io/" title="" target="_blank">Material Design</a> that is used to develop cohesive apps.</p>
<h3 id="-atomic-design"><a class="header" href="#-atomic-design">🧪 Atomic Design</a></h3>
<p><img src="architecture/assets/atomic_design.svg" alt="Atomic design" /></p>
<p>Atomic design is a methodology for creating user interfaces (UI) in a design system by breaking them down into smaller, reusable components.
These components are classified into five categories based on their level of abstraction: <strong>atoms</strong>, <strong>molecules</strong>, <strong>organisms</strong>, <strong>templates</strong>, and <strong>pages</strong>.</p>
<ul>
<li><strong>Atoms</strong> are the smallest building blocks, such as buttons, labels, and input fields and could be combined to create more complex components.</li>
<li><strong>Molecules</strong> are groups of atoms that work together, like search bars, forms or menus</li>
<li><strong>Organisms</strong> are more complex components that combine molecules and atoms, such as headers or cards.</li>
<li><strong>Templates</strong> are pages with placeholders for components</li>
<li><strong>Pages</strong> are the final UI</li>
</ul>
<p>By using atomic design, designers and developers can create more consistent and reusable UIs.
This can save time and improve the overall quality, as well as facilitate collaboration between team members.</p>
<h2 id="-acknowledgement"><a class="header" href="#-acknowledgement">📝 Acknowledgement</a></h2>
<ul>
<li><a href="https://atomicdesign.bradfrost.com/chapter-2/" title="" target="_blank">Atomic Design Methodology | Atomic Design by Brad Frost</a></li>
<li><a href="https://www.wearemobilefirst.com/blog/atomic-design" title="" target="_blank">Atomic Design: Getting Started | Blog | We Are Mobile First</a></li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="user-flows"><a class="header" href="#user-flows">User Flows</a></h1>
<p>The user flows diagrams below illustrate typical paths users take through the application, helping developers
understand how different components interact from a user perspective.</p>
<h2 id="mail"><a class="header" href="#mail">Mail</a></h2>
<h3 id="reading-email"><a class="header" href="#reading-email">Reading email</a></h3>
<p><img src="architecture/../assets/ReadEmail.png" alt="read email sequence" /></p>
<p><img src="architecture/../assets/ReadEmailClasses.png" alt="read email classes" /></p>
<h3 id="sending-email"><a class="header" href="#sending-email">Sending email</a></h3>
<p><img src="architecture/../assets/SendEmail.png" alt="send email sequence" /></p>
<h2 id="verifying-flows"><a class="header" href="#verifying-flows">Verifying Flows</a></h2>
<p>We plan to test these user flows using <a href="https://maestro.dev/" title="" target="_blank">maestro</a>, a tool for automating UI tests. Maestro allows us to write tests in a
simple YAML format, making it easy to define user interactions and verify application behavior.</p>
<p>The current flows could be found in the *<code>ui-flows</code> directory in the repository.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-legacy-module-integration"><a class="header" href="#-legacy-module-integration">🔙 Legacy Module Integration</a></h1>
<p>This document outlines how existing legacy code is integrated into the new modular architecture of the application and
the strategy for its migration. The core principle is to isolate legacy code and provide a controlled way for
newer modules to interact with legacy functionality without becoming directly dependent on it.</p>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>This document should be read in conjunction with <a href="architecture/module-structure.html">Module Structure</a> and <a href="architecture/module-organization.html">Module Organization</a> to get a complete understanding of the modular architecture.</p>
</div>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>The Thunderbird for Android project is transitioning from a monolithic architecture to a modular one. During this
transition, we need to maintain compatibility with existing legacy code while gradually migrating to the new
architecture. The <code>legacy:*</code>, <code>mail:*</code>, and <code>backend:*</code> modules contain functionality that is still essential for the
project but does not yet adhere to the new modular architecture. These modules are integrated into the new architecture
through the <code>:app-common</code> module, which acts as a bridge or adapter to provide access to legacy functionality without
directly depending on it.</p>
<p>The key components in this integration strategy are:</p>
<ol>
<li><strong>Legacy Modules</strong>: <code>legacy:*</code>, <code>mail:*</code>, and <code>backend:*</code> modules containing existing functionality</li>
<li><strong>Interfaces</strong>: Well-defined interfaces in <code>feature:*:api</code> and <code>core:*</code> modules</li>
<li><strong>App Common Bridge</strong>: The <code>:app-common</code> module that implements these interfaces and delegates to legacy code</li>
<li><strong>Dependency Injection</strong>: Configuration that provides the appropriate implementations to modules</li>
</ol>
<h2 id="integration-approach-the-app-common-bridge"><a class="header" href="#integration-approach-the-app-common-bridge">Integration Approach “<em>The App Common Bridge</em>”</a></h2>
<p>Newer application modules (such as features or core components) depend on well-defined <strong>Interfaces</strong>
(e.g., those found in <code>feature:*:api</code> modules). Typically, a feature will provide its own modern <strong>Implementation</strong>
(e.g., <code>:feature:mail:impl</code>) for its API.</p>
<p>However, to manage dependencies on code still within <code>legacy:*</code>, <code>mail:*</code>, and <code>backend:*</code> modules and prevent it
from spreading, we use <code>app-common</code> as <strong>bridge</strong> or <strong>adapter</strong> to provide an alternative implementation for these. In
this role, <code>app-common</code> is responsible for:</p>
<ol>
<li><strong>Implementing interfaces</strong>: <code>app-common</code> provides concrete implementations for interfaces that newer modules define.</li>
<li><strong>Delegating to legacy code</strong>: Internally, these <code>app-common</code> implementations will delegate calls, adapt data, and manage interactions with the underlying <code>legacy:*</code>, <code>mail:*</code>, and <code>backend:*</code> modules.</li>
<li><strong>Containing glue code</strong>: All logic required to connect the modern interfaces with the legacy systems is encapsulated within <code>app-common</code>.</li>
</ol>
<p>This approach ensures that:</p>
<ul>
<li>Newer modules are decoupled from legacy implementations: They only interact with the defined interfaces, regardless of whether the implementation is the modern feature <code>impl</code> or the <code>app-common</code> bridge.</li>
<li>Legacy code is isolated.</li>
<li>A clear path for refactoring is maintained: Initially, the application might be configured to use the <code>app-common</code> bridge. As new, native implementations in feature modules (e.g., <code>:feature:mail:impl</code>) mature, the dependency injection can be switched to use them, often without changes to the modules consuming the interface.</li>
</ul>
<h3 id="bridge-pattern-flow"><a class="header" href="#bridge-pattern-flow">Bridge Pattern Flow</a></h3>
<p>The typical flow is:</p>
<ol>
<li><strong>Interfaces</strong>: Interfaces are defined, usually within the <code>api</code> module of a feature (e.g., <code>:feature:mail:api</code>) or a core module. These interfaces represent the contract for a piece of functionality.</li>
<li><strong>New Module Dependency</strong>: Newer modules (e.g., <code>:feature:somefeature:impl</code> or other parts of <code>:app-common</code>) depend on these defined interfaces, to avoid dependency on concrete legacy classes.</li>
<li><strong>Implementation</strong>: The <code>:app-common</code> module provides concrete implementations for these interfaces.</li>
<li><strong>Delegation to Legacy</strong>: Internally, these implementations within <code>:app-common</code> delegate the actual work to the code residing in the legacy modules (e.g., <code>legacy:*</code>, <code>mail:*</code>, <code>backend:*</code>).</li>
<li><strong>Dependency Injection</strong>: The application’s dependency injection framework is configured to provide instances of these <code>:app-common</code> bridge implementations when a newer module requests an implementation of the interface.</li>
</ol>
<p>This pattern ensures that newer modules remain decoupled from the specifics of legacy code.</p>
<p>The following diagram illustrates this pattern, showing how both a feature’s own implementation and <code>app-common</code> can relate to the interfaces, with <code>app-common</code> specifically bridging to legacy systems:</p>
<pre class="mermaid">graph TB
    subgraph FEATURE[Feature Modules]
        direction TB
        INTERFACES[&quot;`**Interfaces**&lt;br&gt; (e.g., :feature:mail:api)`&quot;]
        IMPLEMENTATIONS[&quot;`**Implementations**&lt;br&gt; (e.g., :feature:mail:impl)`&quot;]
        OTHER_MODULES[&quot;`**Other Modules**&lt;br&gt;(depend on Interfaces)`&quot;]
    end

    subgraph COMMON[App Common Module]
        direction TB
        COMMON_APP[&quot;`**:app-common**&lt;br&gt;Integration Code`&quot;]
    end

    subgraph LEGACY[Legacy Modules]
        direction TB
        LEGACY_K9[&quot;`**:legacy**`&quot;]
        LEGACY_MAIL[&quot;`**:mail**`&quot;]
        LEGACY_BACKEND[&quot;`**:backend**`&quot;]
    end

    OTHER_MODULES --&gt; |uses| INTERFACES
    IMPLEMENTATIONS --&gt; |depends on| INTERFACES
    COMMON_APP --&gt; |implements| INTERFACES
    COMMON_APP --&gt; |delegates to / wraps| LEGACY_K9
    COMMON_APP --&gt; |delegates to / wraps| LEGACY_MAIL
    COMMON_APP --&gt; |delegates to / wraps| LEGACY_BACKEND

    classDef common fill:#e6e6e6,stroke:#000000,color:#000000
    classDef common_module fill:#999999,stroke:#000000,color:#000000
    classDef feature fill:#d9ffd9,stroke:#000000,color:#000000
    classDef feature_module fill:#33cc33,stroke:#000000,color:#000000
    classDef legacy fill:#ffe6e6,stroke:#000000,color:#000000
    classDef legacy_module fill:#ff9999,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class COMMON common
    class COMMON_APP common_module
    class FEATURE feature
    class INTERFACES,IMPLEMENTATIONS,OTHER_MODULES feature_module
    class LEGACY legacy
    class LEGACY_MAIL,LEGACY_BACKEND,LEGACY_K9 legacy_module
</pre>
<h3 id="implementation-techniques"><a class="header" href="#implementation-techniques">Implementation Techniques</a></h3>
<p>Several techniques are used to implement the bridge pattern effectively:</p>
<ol>
<li>
<p><strong>Wrapper Classes</strong>: Creating immutable data classes that wrap legacy data structures, implementing interfaces from the new architecture. These wrappers should not contain conversion methods but should delegate this responsibility to specific mapper classes.</p>
</li>
<li>
<p><strong>Adapter Implementations</strong>: Classes in <code>:app-common</code> that implement interfaces from the new architecture but delegate to legacy code internally.</p>
</li>
<li>
<p><strong>Data Conversion</strong>: Dedicated mapper classes that handle mapping between legacy and new data structures, ensuring clean separation of concerns.</p>
</li>
</ol>
<h4 id="example-account-profile-bridge"><a class="header" href="#example-account-profile-bridge">Example: Account Profile Bridge</a></h4>
<p>A concrete example of this pattern is the account profile bridge, which demonstrates a complete implementation of the bridge pattern across multiple layers:</p>
<ol>
<li><strong>Modern Interfaces</strong>:
<ul>
<li><code>AccountProfileRepository</code> in <code>feature:account:api</code> defines the high-level contract for account profile management</li>
<li><code>AccountProfileLocalDataSource</code> in <code>feature:account:core</code> defines the data access contract</li>
</ul>
</li>
<li><strong>Modern Data Structure</strong>: <code>AccountProfile</code> in <code>feature:account:api</code> is a clean, immutable data class that represents account profile information in the new architecture.</li>
<li><strong>Repository Implementation</strong>: <code>DefaultAccountProfileRepository</code> in <code>feature:account:core</code> implements the <code>AccountProfileRepository</code> interface and depends on <code>AccountProfileLocalDataSource</code>.</li>
<li><strong>Bridge Implementation</strong>: <code>DefaultAccountProfileLocalDataSource</code> in <code>app-common</code> implements the <code>AccountProfileLocalDataSource</code> interface and serves as the bridge to legacy code.</li>
<li><strong>Legacy Access</strong>: The bridge uses <code>DefaultLegacyAccountWrapperManager</code> to access legacy account data:
<ul>
<li><code>LegacyAccountWrapperManager</code> in <code>core:android:account</code> defines the contract for legacy account access</li>
<li><code>LegacyAccountWrapper</code> in <code>core:android:account</code> is an immutable wrapper around the legacy <code>LegacyAccount</code> class</li>
</ul>
</li>
<li><strong>Data Conversion</strong>: The bridge uses a dedicated mapper class to convert between modern <code>AccountProfile</code> objects and legacy account data.</li>
<li><strong>Dependency Injection</strong>: The <code>appCommonAccountModule</code> in <code>app-common</code> registers <code>DefaultAccountProfileLocalDataSource</code> as implementations of the respective interface.</li>
</ol>
<p>This multi-layered approach allows newer modules to interact with legacy account functionality through clean, modern interfaces without directly depending on legacy code. It also demonstrates how bridges can be composed, with higher-level bridges (AccountProfile) building on lower-level bridges (LegacyAccountWrapper).</p>
<h2 id="testing-considerations"><a class="header" href="#testing-considerations">Testing Considerations</a></h2>
<p>Testing bridge implementations requires special attention to ensure both the bridge itself and its integration with legacy code work correctly:</p>
<ol>
<li><strong>Unit Testing Bridge Classes</strong>:
<ul>
<li>Test the bridge implementation in isolation by faking/stubbing the legacy dependencies</li>
<li>Verify that the bridge correctly translates between the new interfaces and legacy code</li>
<li>Focus on testing the conversion logic and error handling</li>
</ul>
</li>
<li><strong>Integration Testing</strong>:
<ul>
<li>Test the bridge with actual legacy code to ensure proper integration</li>
<li>Verify that the bridge correctly handles all edge cases from legacy code</li>
</ul>
</li>
<li><strong>Test Doubles</strong>:
<ul>
<li>Create fake implementations of bridge classes for testing other components</li>
<li>Example: <code>FakeLegacyAccountWrapperManager</code> can be used to test components that depend on <code>LegacyAccountWrapperManager</code></li>
</ul>
</li>
<li><strong>Migration Testing</strong>:
<ul>
<li>When migrating from a legacy bridge to a new implementation, test both implementations with the same test suite</li>
<li>Ensure behavior consistency during the transition</li>
</ul>
</li>
</ol>
<h3 id="testing-examples"><a class="header" href="#testing-examples">Testing Examples</a></h3>
<p>Below are examples of tests for legacy module integration, demonstrating different testing approaches and best practices.</p>
<h4 id="example-1-unit-testing-a-bridge-implementation"><a class="header" href="#example-1-unit-testing-a-bridge-implementation">Example 1: Unit Testing a Bridge Implementation</a></h4>
<p>This example shows how to test a bridge implementation (<code>DefaultAccountProfileLocalDataSource</code>) in isolation by using a fake implementation of the legacy dependency (<code>FakeLegacyAccountWrapperManager</code>):</p>
<pre><code class="language-kotlin">class DefaultAccountProfileLocalDataSourceTest {

    @Test
    fun `getById should return account profile`() = runTest {
        // arrange
        val accountId = AccountIdFactory.create()
        val legacyAccount = createLegacyAccount(accountId)
        val accountProfile = createAccountProfile(accountId)
        val testSubject = createTestSubject(legacyAccount)

        // act &amp; assert
        testSubject.getById(accountId).test {
            assertThat(awaitItem()).isEqualTo(accountProfile)
        }
    }

    @Test
    fun `getById should return null when account is not found`() = runTest {
        // arrange
        val accountId = AccountIdFactory.create()
        val testSubject = createTestSubject(null)

        // act &amp; assert
        testSubject.getById(accountId).test {
            assertThat(awaitItem()).isEqualTo(null)
        }
    }

    @Test
    fun `update should save account profile`() = runTest {
        // arrange
        val accountId = AccountIdFactory.create()
        val legacyAccount = createLegacyAccount(accountId)
        val accountProfile = createAccountProfile(accountId)

        val updatedName = "updatedName"
        val updatedAccountProfile = accountProfile.copy(name = updatedName)

        val testSubject = createTestSubject(legacyAccount)

        // act &amp; assert
        testSubject.getById(accountId).test {
            assertThat(awaitItem()).isEqualTo(accountProfile)

            testSubject.update(updatedAccountProfile)

            assertThat(awaitItem()).isEqualTo(updatedAccountProfile)
        }
    }

    private fun createTestSubject(
        legacyAccount: LegacyAccountWrapper?,
    ): DefaultAccountProfileLocalDataSource {
        return DefaultAccountProfileLocalDataSource(
            accountManager = FakeLegacyAccountWrapperManager(
                initialAccounts = if (legacyAccount != null) {
                    listOf(legacyAccount)
                } else {
                    emptyList()
                },
            ),
            dataMapper = DefaultAccountProfileDataMapper(
                avatarMapper = DefaultAccountAvatarDataMapper(),
            ),
        )
    }
}
</code></pre>
<p>Key points:</p>
<ul>
<li>The test creates a controlled test environment using a fake implementation of the legacy dependency</li>
<li>It tests both success cases and error handling (account not found)</li>
<li>It verifies that the bridge correctly translates between legacy data structures and domain models</li>
<li>The test is structured with clear arrange, act, and assert sections</li>
</ul>
<h4 id="example-2-creating-test-doubles-for-legacy-dependencies"><a class="header" href="#example-2-creating-test-doubles-for-legacy-dependencies">Example 2: Creating Test Doubles for Legacy Dependencies</a></h4>
<p>This example shows how to create a fake implementation of a legacy dependency (<code>FakeLegacyAccountWrapperManager</code>) for testing:</p>
<pre><code class="language-kotlin">internal class FakeLegacyAccountWrapperManager(
    initialAccounts: List&lt;LegacyAccountWrapper&gt; = emptyList(),
) : LegacyAccountWrapperManager {

    private val accountsState = MutableStateFlow(
        initialAccounts,
    )
    private val accounts: StateFlow&lt;List&lt;LegacyAccountWrapper&gt;&gt; = accountsState

    override fun getAll(): Flow&lt;List&lt;LegacyAccountWrapper&gt;&gt; = accounts

    override fun getById(id: AccountId): Flow&lt;LegacyAccountWrapper?&gt; = accounts
        .map { list -&gt;
            list.find { it.id == id }
        }

    override suspend fun update(account: LegacyAccountWrapper) {
        accountsState.update { currentList -&gt;
            currentList.toMutableList().apply {
                removeIf { it.uuid == account.uuid }
                add(account)
            }
        }
    }
}
</code></pre>
<p>Key points:</p>
<ul>
<li>The fake implementation implements the same interface as the real implementation</li>
<li>It provides a simple in-memory implementation for testing</li>
<li>It uses Kotlin Flows to simulate the reactive behavior of the real implementation</li>
<li>It allows for easy setup of test data through the constructor parameter</li>
</ul>
<h4 id="example-3-testing-data-conversion-logic"><a class="header" href="#example-3-testing-data-conversion-logic">Example 3: Testing Data Conversion Logic</a></h4>
<p>This example shows how to test data conversion logic in bridge implementations:</p>
<pre><code class="language-kotlin">class DefaultAccountProfileDataMapperTest {

    @Test
    fun `toDomain should convert ProfileDto to AccountProfile`() {
        // Arrange
        val dto = createProfileDto()
        val expected = createAccountProfile()

        val testSubject = DefaultAccountProfileDataMapper(
            avatarMapper = FakeAccountAvatarDataMapper(
                dto = dto.avatar,
                domain = expected.avatar,
            ),
        )

        // Act
        val result = testSubject.toDomain(dto)

        // Assert
        assertThat(result.id).isEqualTo(expected.id)
        assertThat(result.name).isEqualTo(expected.name)
        assertThat(result.color).isEqualTo(expected.color)
        assertThat(result.avatar).isEqualTo(expected.avatar)
    }

    @Test
    fun `toDto should convert AccountProfile to ProfileDto`() {
        // Arrange
        val domain = createAccountProfile()
        val expected = createProfileDto()

        val testSubject = DefaultAccountProfileDataMapper(
            avatarMapper = FakeAccountAvatarDataMapper(
                dto = expected.avatar,
                domain = domain.avatar,
            ),
        )

        // Act
        val result = testSubject.toDto(domain)

        // Assert
        assertThat(result.id).isEqualTo(expected.id)
        assertThat(result.name).isEqualTo(expected.name)
        assertThat(result.color).isEqualTo(expected.color)
        assertThat(result.avatar).isEqualTo(expected.avatar)
    }
}
</code></pre>
<p>Key points:</p>
<ul>
<li>The test verifies that the mapper correctly converts between legacy data structures (DTOs) and domain models</li>
<li>It tests both directions of the conversion (toDomain and toDto)</li>
<li>It uses a fake implementation of a dependency (FakeAccountAvatarDataMapper) to isolate the test</li>
<li>It verifies that all properties are correctly mapped</li>
</ul>
<h4 id="best-practices-for-testing-legacy-module-integration"><a class="header" href="#best-practices-for-testing-legacy-module-integration">Best Practices for Testing Legacy Module Integration</a></h4>
<ol>
<li><strong>Isolate the Bridge</strong>: Test the bridge implementation in isolation by using fake or mock implementations of legacy dependencies.</li>
<li><strong>Test Both Directions</strong>: For data conversion, test both directions (legacy to domain and domain to legacy).</li>
<li><strong>Cover Edge Cases</strong>: Test edge cases such as null values, empty collections, and error conditions.</li>
<li><strong>Use Clear Test Structure</strong>: Structure tests with clear arrange, act, and assert sections.</li>
<li><strong>Create Reusable Test Fixtures</strong>: Create helper methods for creating test data to make tests more readable and maintainable.</li>
<li><strong>Test Reactive Behavior</strong>: For reactive code (using Flows, LiveData, etc.), use appropriate testing utilities (e.g., Turbine for Flow testing).</li>
<li><strong>Verify Integration</strong>: In addition to unit tests, create integration tests that verify the bridge works correctly with actual legacy code.</li>
<li><strong>Test Migration Path</strong>: When migrating from a legacy bridge to a new implementation, test both implementations with the same test suite to ensure behavior consistency.</li>
</ol>
<h2 id="migration-strategy"><a class="header" href="#migration-strategy">Migration Strategy</a></h2>
<p>The long-term strategy involves gradually migrating functionality out of the legacy modules:</p>
<ol>
<li><strong>Identify Functionality</strong>: Pinpoint specific functionalities within legacy modules that need to be modernized.</li>
<li><strong>Define Interfaces</strong>: Ensure clear interfaces are defined (typically in feature <code>api</code> modules) for this functionality.</li>
<li><strong>Entity Modeling</strong>: Create proper domain entity models that represent the business objects as immutable data classes.</li>
<li><strong>Implement in New Modules</strong>: Re-implement the functionality within new, dedicated feature <code>impl</code> modules or core modules.</li>
<li><strong>Update Bridge (Optional)</strong>: If <code>:app-common</code> was bridging to this specific legacy code, its bridge implementation can be updated or removed.</li>
<li><strong>Switch DI Configuration</strong>: Update the dependency injection to provide the new modern implementation instead of the legacy bridge.</li>
<li><strong>Retire Legacy Code</strong>: Once no longer referenced, the corresponding legacy code can be safely removed.</li>
</ol>
<h3 id="migration-example"><a class="header" href="#migration-example">Migration Example</a></h3>
<p>Using the account profile example, the migration process would look like:</p>
<ol>
<li><strong>Identify</strong>: Account profile functionality in legacy modules needs modernization.</li>
<li><strong>Define Interfaces</strong>:
<ul>
<li><code>AccountProfileRepository</code> interface is defined in <code>feature:account:api</code></li>
<li><code>AccountProfileLocalDataSource</code> interface is defined in <code>feature:account:core</code></li>
</ul>
</li>
<li><strong>Entity Modeling</strong>: Create <code>AccountProfile</code> as an immutable data class in <code>feature:account:api</code>.</li>
<li><strong>Implement</strong>: Create a new implementation of <code>AccountProfileLocalDataSource</code> in a modern module, e.g., <code>feature:account:impl</code>.</li>
<li><strong>Update Bridge</strong>: Update or remove <code>DefaultAccountProfileLocalDataSource</code> in <code>app-common</code>.</li>
<li><strong>Switch DI</strong>: Update <code>appCommonAccountModule</code> to provide the new implementation instead of <code>DefaultAccountProfileLocalDataSource</code>.</li>
<li><strong>Retire</strong>: Once all references to legacy account code are removed, the legacy code and lower-level bridges (<code>LegacyAccountWrapperManager</code>, <code>DefaultLegacyAccountWrapperManager</code>) can be safely deleted.</li>
</ol>
<p>This approach ensures a smooth transition with minimal disruption to the application’s functionality.</p>
<h2 id="dependency-direction"><a class="header" href="#dependency-direction">Dependency Direction</a></h2>
<p>A strict dependency rule is enforced: <strong>New modules (features, core) must not directly depend on legacy modules.</strong>
The dependency flow is always from newer modules to interfaces, with <code>:app-common</code> providing the implementation.
If <code>:app-common</code> bridges to legacy code, that is an internal detail of <code>:app-common</code>.</p>
<p>The legacy module integration diagram below explains how legacy code is integrated into the new modular architecture:</p>
<pre class="mermaid">graph TB
    subgraph APP[App Modules]
        direction TB
        APP_TB[&quot;`**:app-thunderbird**&lt;br&gt;Thunderbird for Android`&quot;]
        APP_K9[&quot;`**:app-k9mail**&lt;br&gt;K-9 Mail`&quot;]
    end

    subgraph COMMON[App Common Module]
        direction TB
        COMMON_APP[&quot;`**:app-common**&lt;br&gt;Integration Code`&quot;]
    end

    subgraph FEATURE[Feature Modules]
        direction TB
        FEATURE1[Feature 1]
        FEATURE2[Feature 2]
        FEATURE3[Feature from Legacy]
    end

    subgraph CORE[Core Modules]
        direction TB
        CORE1[Core 1]
        CORE2[Core 2]
        CORE3[Core from Legacy]
    end

    subgraph LIBRARY[Library Modules]
        direction TB
        LIB1[Library 1]
        LIB2[Library 2]
    end

    subgraph LEGACY[Legacy Modules]
        direction TB
        LEGACY_CODE[Legacy Code]
    end

    APP_K9 --&gt; |depends on| COMMON_APP
    APP_TB --&gt; |depends on| COMMON_APP
    COMMON_APP --&gt; |integrates| FEATURE1
    COMMON_APP --&gt; |integrates| FEATURE2
    COMMON_APP --&gt; |integrates| FEATURE3
    FEATURE1 --&gt; |uses| CORE1
    FEATURE1 --&gt; |uses| LIB2
    FEATURE2 --&gt; |uses| CORE2
    FEATURE2 --&gt; |uses| CORE3
    COMMON_APP --&gt; |integrates| LEGACY_CODE
    LEGACY_CODE -.-&gt; |migrate to| FEATURE3
    LEGACY_CODE -.-&gt; |migrate to| CORE3

    classDef app fill:#d9e9ff,stroke:#000000,color:#000000
    classDef app_module fill:#4d94ff,stroke:#000000,color:#000000
    classDef common fill:#e6e6e6,stroke:#000000,color:#000000
    classDef common_module fill:#999999,stroke:#000000,color:#000000
    classDef feature fill:#d9ffd9,stroke:#000000,color:#000000
    classDef feature_module fill:#33cc33,stroke:#000000,color:#000000
    classDef core fill:#e6cce6,stroke:#000000,color:#000000
    classDef core_module fill:#cc99cc,stroke:#000000,color:#000000
    classDef library fill:#fff0d0,stroke:#000000,color:#000000
    classDef library_module fill:#ffaa33,stroke:#000000,color:#000000
    classDef legacy fill:#ffe6e6,stroke:#000000,color:#000000
    classDef legacy_module fill:#ff9999,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class APP app
    class APP_K9,APP_TB app_module
    class COMMON common
    class COMMON_APP common_module
    class FEATURE feature
    class FEATURE1,FEATURE2,FEATURE3 feature_module
    class CORE core
    class CORE1,CORE2,CORE3 core_module
    class LIBRARY library
    class LIB1,LIB2 library_module
    class LEGACY legacy
    class LEGACY_CODE legacy_module
</pre>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="architecture-decision-records"><a class="header" href="#architecture-decision-records">Architecture Decision Records</a></h1>
<p>ADRs are short text documents that serve as a historical context for the architecture decisions we make over the
course of the project.</p>
<h2 id="what-is-an-adr"><a class="header" href="#what-is-an-adr">What is an ADR?</a></h2>
<p>An Architecture Decision Record (ADR) is a document that captures an important architectural decision made along
with its context and consequences. ADRs record the decision making process and allow others to understand the
rationale behind decisions, providing insight and facilitating future decision-making processes.</p>
<h2 id="format-of-an-adr"><a class="header" href="#format-of-an-adr">Format of an ADR</a></h2>
<p>We adhere to Michael Nygard’s <a href="https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions" title="" target="_blank">ADR format proposal</a>,
where each ADR document should contain:</p>
<ol>
<li><strong>Title</strong>: A short descriptive name for the decision.
<ol>
<li><strong>Link to Issue</strong>: A link to the issue that prompted the decision.</li>
<li><strong>Link to Pull Request</strong>: A link to the pull request that implements the ADR.</li>
<li><strong>Link to Tracking Issue</strong>: A link to the tracking issue, if applicable.</li>
</ol>
</li>
<li><strong>Status</strong>: The current status of the decision (proposed, accepted, rejected, deprecated, superseded)</li>
<li><strong>Context</strong>: The context that motivates this decision.</li>
<li><strong>Decision</strong>: The change that we’re proposing and/or doing.</li>
<li><strong>Consequences</strong>: What becomes easier or more difficult to do and any risks introduced as a result of the decision.</li>
</ol>
<h2 id="creating-a-new-adr"><a class="header" href="#creating-a-new-adr">Creating a new ADR</a></h2>
<p>When creating a new ADR, please follow the provided <a href="architecture/adr/0000-adr-template.html">ADR template file</a> and ensure that your
document is clear and concise.</p>
<p>Once you are ready to propose your ADR, you should:</p>
<ol>
<li>Create an issue in the repository, get consensus from at least one other project contributor.</li>
<li>Make a post on <a href="https://thunderbird.topicbox.com/groups/mobile-planning" title="" target="_blank">the mobile-planning list</a>
to announce your ADR. You can use the below template as needed.</li>
<li>Create a pull request in the repository linking the issue.</li>
<li>Make a decision together with mobile module owners, the PR will be merged when accepted.</li>
</ol>
<h2 id="directory-structure"><a class="header" href="#directory-structure">Directory Structure</a></h2>
<p>The ADRs will be stored in a directory named <code>docs/adr</code>, and each ADR will be a file named <code>NNNN-title-with-dashes.md</code>
where <code>NNNN</code> is a four-digit number that is increased by 1 for every new adr.</p>
<h2 id="adr-life-cycle"><a class="header" href="#adr-life-cycle">ADR Life Cycle</a></h2>
<p>The life cycle of an ADR is as follows:</p>
<ol>
<li><strong>Proposed</strong>: The ADR is under consideration.</li>
<li><strong>Accepted</strong>: The decision described in the ADR has been accepted and should be adhered to, unless it is superseded by another ADR.</li>
<li><strong>Rejected</strong>: The decision described in the ADR has been rejected.</li>
<li><strong>Deprecated</strong>: The decision described in the ADR is no longer relevant due to changes in system context.</li>
<li><strong>Superseded</strong>: The decision described in the ADR has been replaced by another decision.</li>
</ol>
<p>Each ADR will have a status indicating its current life-cycle stage. An ADR can be updated over time, either to change
the status or to add more information.</p>
<h2 id="contributions"><a class="header" href="#contributions">Contributions</a></h2>
<p>We welcome contributions in the form of new ADRs or updates to existing ones. Please ensure all contributions follow
the standard format and provide clear and concise information.</p>
<h2 id="appendix-intent-to-adopt-template"><a class="header" href="#appendix-intent-to-adopt-template">Appendix: Intent to Adopt Template</a></h2>
<p>You may use this template in your Intent to Adopt email as noted above. Tweak it as you feel is useful.</p>
<blockquote>
<p>Hello everyone,</p>
<p>I’m writing to share an intent to adopt a new architecture decision: [ADR-[Number]] [Title of ADR]</p>
<p>This change addresses [brief summary of the problem] and proposes [brief description of the approach].</p>
<p>This decision is based on [briefly mention motivating factors, constraints, or technical context].</p>
<p>You can read the full proposal here: [link to ADR]</p>
<p>If you have feedback or concerns, please respond in the linked issue. We plan to finalize the
decision after [proposed date], factoring in discussion at that time.</p>
<p>Thanks,
[Your Name]</p>
</blockquote>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="switch-from-java-to-kotlin"><a class="header" href="#switch-from-java-to-kotlin">Switch from Java to Kotlin</a></h1>
<ul>
<li>Pull Request: <a href="https://github.com/thunderbird/thunderbird-android/pull/7221" title="" target="_blank">#7221</a></li>
</ul>
<h2 id="status"><a class="header" href="#status">Status</a></h2>
<ul>
<li><strong>Accepted</strong></li>
</ul>
<h2 id="context"><a class="header" href="#context">Context</a></h2>
<p>We’ve been using Java as our primary language for Android development. While Java has served us well, it has certain
limitations in terms of null safety, verbosity, functional programming, and more. Kotlin, officially supported by
Google for Android development, offers solutions to many of these issues and provides more modern language features
that can improve productivity, maintainability, and overall code quality.</p>
<h2 id="decision"><a class="header" href="#decision">Decision</a></h2>
<p>Switch our primary programming language for Android development from Java to Kotlin. This will involve rewriting our
existing Java codebase in Kotlin and writing all new code in Kotlin. To facilitate the transition, we will gradually
refactor our existing Java codebase to Kotlin.</p>
<h2 id="consequences"><a class="header" href="#consequences">Consequences</a></h2>
<ul>
<li><strong>Positive Consequences</strong>
<ul>
<li>Improved null safety, reducing potential for null pointer exceptions.</li>
<li>Increased code readability and maintainability due to less verbose syntax.</li>
<li>Availability of modern language features such as coroutines for asynchronous programming, and extension functions.</li>
<li>Officially supported by Google for Android development, ensuring future-proof development.</li>
</ul>
</li>
<li><strong>Negative Consequences</strong>
<ul>
<li>The process of refactoring existing Java code to Kotlin can be time-consuming.</li>
<li>Potential for introduction of new bugs during refactoring.</li>
</ul>
</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="ui---wrap-material-components-in-atomic-design-system"><a class="header" href="#ui---wrap-material-components-in-atomic-design-system">UI - Wrap Material Components in Atomic Design System</a></h1>
<ul>
<li>Pull Request: <a href="https://github.com/thunderbird/thunderbird-android/pull/7221" title="" target="_blank">#7221</a></li>
</ul>
<h2 id="status-1"><a class="header" href="#status-1">Status</a></h2>
<ul>
<li><strong>Accepted</strong></li>
</ul>
<h2 id="context-1"><a class="header" href="#context-1">Context</a></h2>
<p>As we continued developing our Jetpack Compose application, we found a need to increase the consistency, reusability,
and maintainability of our user interface (UI) components. We have been using Material components directly throughout our
application. This lead to a lack of uniformity and increases the complexity of changes as the same modifications had to
be implemented multiple times across different screens.</p>
<h2 id="decision-1"><a class="header" href="#decision-1">Decision</a></h2>
<p>To address these challenges, we’ve decided to adopt an
<a href="architecture/adr/../design-system.html">Atomic Design System</a> as a foundation for our application UI.
This system encapsulates Material components within our own <a href="https://github.com/thunderbird/thunderbird-android/tree/main/core/ui/compose/designsystem" title="" target="_blank">components</a>,
organized into categories of <em>atoms</em>, <em>molecules</em>, and <em>organisms</em>. We also defined <em>templates</em> as layout structures
that can be flexibly combined to construct <em>pages</em>. These components collectively form the building blocks that we are
using to construct our application’s UI.</p>
<h2 id="consequences-1"><a class="header" href="#consequences-1">Consequences</a></h2>
<ul>
<li><strong>Positive Consequences</strong>
<ul>
<li>Increased reusability of components across the application, reducing code duplication.</li>
<li>More consistent UI and uniform styling across the entire application.</li>
<li>Improved maintainability, as changes to a component only need to be made in one place.</li>
</ul>
</li>
<li><strong>Negative Consequences</strong>
<ul>
<li>Initial effort and time investment needed to implement the atomic design system.</li>
<li>Developers need to adapt to the new system and learn how to use it effectively.</li>
<li>Potential for over-complication if simple components are excessively broken down into atomic parts.</li>
</ul>
</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="switch-test-assertions-from-truth-to-assertk"><a class="header" href="#switch-test-assertions-from-truth-to-assertk">Switch Test Assertions from Truth to assertk</a></h1>
<ul>
<li>Pull Request: <a href="https://github.com/thunderbird/thunderbird-android/pull/7242" title="" target="_blank">#7242</a></li>
</ul>
<h2 id="status-2"><a class="header" href="#status-2">Status</a></h2>
<ul>
<li><strong>Accepted</strong></li>
</ul>
<h2 id="context-2"><a class="header" href="#context-2">Context</a></h2>
<p>Our project has been using the Truth testing library for writing tests. While Truth has served us well, it is primarily
designed for Java and lacks some features that make our Kotlin tests more idiomatic and expressive. As our codebase is
<a href="architecture/adr/0001-switch-from-java-to-kotlin.html">primarily Kotlin</a>, we have been looking for a testing library that is more aligned
with Kotlin’s features and idioms.</p>
<h2 id="decision-2"><a class="header" href="#decision-2">Decision</a></h2>
<p>We have decided to use <a href="https://github.com/willowtreeapps/assertk" title="" target="_blank">assertk</a> as the default assertions framework for
writing tests in our project. assertk provides a fluent API that is very similar to Truth, making the transition easier.
Moreover, it is designed to work well with Kotlin, enabling us to leverage Kotlin-specific features in our tests.</p>
<p>We’ve further committed to converting all pre-existing tests from Truth to assertk.</p>
<h2 id="consequences-2"><a class="header" href="#consequences-2">Consequences</a></h2>
<p><strong>Note</strong>: The migration of all Truth tests to assertk has already been completed.</p>
<ul>
<li><strong>Positive Consequences</strong>
<ul>
<li><strong>Ease of Transition</strong>: The syntax of assertk is very similar to Truth, which makes the migration process smoother.</li>
<li><strong>Kotlin-Friendly</strong>: assertk is designed specifically for Kotlin, allowing us to write more idiomatic and
expressive Kotlin tests.</li>
</ul>
</li>
<li><strong>Negative Consequences</strong>
<ul>
<li><strong>Dependency</strong>: While we are replacing one library with another, introducing a new library always carries the risk
of bugs or future deprecation.</li>
<li><strong>Migration Effort</strong>: Existing tests written using Truth will need to be migrated to use assertk, requiring some
effort, although mitigated by the similar syntax.</li>
</ul>
</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="naming-conventions-for-interfaces-and-their-implementations"><a class="header" href="#naming-conventions-for-interfaces-and-their-implementations">Naming Conventions for Interfaces and Their Implementations</a></h1>
<ul>
<li>Pull Request: <a href="https://github.com/thunderbird/thunderbird-android/pull/7794" title="" target="_blank">#7794</a></li>
</ul>
<h2 id="status-3"><a class="header" href="#status-3">Status</a></h2>
<ul>
<li><strong>Accepted</strong></li>
</ul>
<h2 id="context-3"><a class="header" href="#context-3">Context</a></h2>
<p>When there’s an interface that has multiple implementations it’s often easy enough to give meaningful names to both the
interface and the implementations (e.g. the interface <code>Backend</code> with the implementations <code>ImapBackend</code> and
<code>Pop3Backend</code>). Naming becomes harder when the interface mainly exists to allow having isolated unit tests and the
production code contains exactly one implementation of the interface.
Prior to this ADR we didn’t have any naming guidelines and the names varied widely. Often when there was only one
(production) implementation, the class name used one of the prefixes <code>Default</code>, <code>Real</code>, or <code>K9</code>. None of these had any
special meaning and it wasn’t clear which one to pick when creating a new interface/class pair.</p>
<h2 id="decision-3"><a class="header" href="#decision-3">Decision</a></h2>
<p>We’ll be using the following guidelines for naming interfaces and their implementation classes:</p>
<ol>
<li><strong>Interface Naming:</strong> Name interfaces as if they were classes, using a clear and descriptive name. Avoid using the
“IInterface” pattern.</li>
<li><strong>Implementation Naming:</strong> Use a prefix that clearly indicates the relationship between the interface and
implementation, such as <code>DatabaseMessageStore</code> or <code>InMemoryMessageStore</code> for the <code>MessageStore</code> interface.</li>
<li><strong>Descriptive Names:</strong> Use descriptive names for interfaces and implementing classes that accurately reflect their
purpose and functionality.</li>
<li><strong>Platform-specific Implementations:</strong> Use the platform name as a prefix for interface implementations specific to
that platform, e.g. <code>AndroidPowerManager</code>.</li>
<li><strong>App-specific Implementations:</strong> Use the prefix <code>K9</code> for K-9 Mail and <code>Tb</code> for Thunderbird when app-specific
implementations are needed, e.g. <code>K9AppNameProvider</code> and <code>TbAppNameProvider</code>.</li>
<li><strong>Flexibility:</strong> If no brief descriptive name fits and there is only one production implementation, use the prefix
<code>Default</code>, like <code>DefaultImapFolder</code>.</li>
</ol>
<h2 id="consequences-3"><a class="header" href="#consequences-3">Consequences</a></h2>
<ul>
<li><strong>Positive Consequences</strong>
<ul>
<li>Improved code readability and maintainability through consistent naming.</li>
<li>Reduced confusion and misunderstandings by using clear and descriptive names.</li>
</ul>
</li>
<li><strong>Negative Consequences</strong>
<ul>
<li>Initial effort is required to rename existing classes that do not follow these naming conventions.</li>
</ul>
</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="central-management-of-android-project-dependencies-and-gradle-configurations-via-build-plugin-module"><a class="header" href="#central-management-of-android-project-dependencies-and-gradle-configurations-via-build-plugin-module">Central Management of Android Project Dependencies and Gradle Configurations via Build-Plugin Module</a></h1>
<ul>
<li>Pull Request: <a href="https://github.com/thunderbird/thunderbird-android/pull/7803" title="" target="_blank">#7803</a></li>
</ul>
<h2 id="status-4"><a class="header" href="#status-4">Status</a></h2>
<ul>
<li><strong>Accepted</strong></li>
</ul>
<h2 id="context-4"><a class="header" href="#context-4">Context</a></h2>
<p>In our Android project, managing dependencies and configurations directly within each module’s <code>build.gradle.kts</code> file has historically led to inconsistencies, duplication, and difficulty in updates. This challenge was particularly noticeable when maintaining the project configuration. By centralizing this setup in a <code>build-plugin</code> module, we can encapsulate and reuse Gradle logic, streamline the build process, and ensure consistency across all project modules and ease maintainability of our codebase.</p>
<h2 id="decision-4"><a class="header" href="#decision-4">Decision</a></h2>
<p>To address these challenges, we have decided to establish a <code>build-plugin</code> module within our project. This module will serve as the foundation for all common Gradle configurations, dependency management, and custom plugins, allowing for simplified configuration across various project modules and plugins. Key components of this module include:</p>
<ul>
<li><strong>Custom Plugins:</strong> A suite of custom plugins that configure Gradle for different project aspects, ensuring each project type has tailored and streamlined build processes. These plugins should cover Android application, Android library, Jetpack Compose and Java modules.</li>
<li><strong>Dependency Management:</strong> Utilizing the <a href="https://docs.gradle.org/current/userguide/platforms.html" title="" target="_blank">Gradle Version Catalog</a> to centrally manage and update all dependencies and plugins, ensuring that every module uses the same versions and reduces the risk of conflicts.</li>
<li><strong>Common Configuration Settings:</strong> Establishing common configurations for Java, Kotlin, and Android to reduce the complexity and variability in setup across different modules.</li>
</ul>
<h2 id="consequences-4"><a class="header" href="#consequences-4">Consequences</a></h2>
<h3 id="positive-consequences"><a class="header" href="#positive-consequences">Positive Consequences</a></h3>
<ol>
<li><strong>Consistency Across Modules:</strong> All project modules will use the same versions of dependencies and plugins, reducing the risk of conflicts and enhancing uniformity. They will also share common configurations, ensuring consistency in the build process.</li>
<li><strong>Ease of Maintenance:</strong> Centralizing dependency versions in the Gradle Version Catalog allows for simple and quick updates to libraries and tools across all project modules from a single source.</li>
<li><strong>Simplified Configuration Process:</strong> The custom plugins within the <code>build-plugin</code> module provides a streamlined way to apply settings and dependencies uniformly, enhancing productivity and reducing setup complexity.</li>
</ol>
<h3 id="negative-consequences"><a class="header" href="#negative-consequences">Negative Consequences</a></h3>
<ol>
<li><strong>Initial Overhead:</strong> The setup of the build-plugin module with a Gradle Version Catalog and the migration of existing configurations required an initial investment of time and resources, but this has been completed.</li>
<li><strong>Complexity for New Developers:</strong> The centralized build architecture, particularly with the use of a Gradle Version Catalog, may initially seem daunting to new team members who are unfamiliar with this level of abstraction.</li>
<li><strong>Dependency on the Build-Plugin Module:</strong> The entire project becomes reliant on the stability and accuracy of the <code>build-plugin</code> module. Errors within this module or the catalog could impact the build process across all modules.</li>
</ol>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="white-label-architecture"><a class="header" href="#white-label-architecture">White Label Architecture</a></h1>
<ul>
<li>Issue: <a href="https://github.com/thunderbird/thunderbird-android/issues/7807" title="" target="_blank">#7807</a></li>
<li>Pull Request: <a href="https://github.com/thunderbird/thunderbird-android/pull/7805" title="" target="_blank">#7805</a></li>
</ul>
<h2 id="status-5"><a class="header" href="#status-5">Status</a></h2>
<ul>
<li><strong>Accepted</strong></li>
</ul>
<h2 id="context-5"><a class="header" href="#context-5">Context</a></h2>
<p>Our project hosts two separate applications, K-9 Mail and Thunderbird for Android, which share a significant amount of functionality. Despite their common features, each app requires distinct branding elements such as app names, themes, and specific strings.</p>
<h2 id="decision-5"><a class="header" href="#decision-5">Decision</a></h2>
<p>We have decided to adopt a modular white-label architecture, where each application is developed as a separate module that relies on a shared codebase. This structure allows us to streamline configuration details specific to each brand either during build or at runtime. This is how we structure the modules:</p>
<h3 id="application-modules"><a class="header" href="#application-modules">Application Modules</a></h3>
<p>There will be 2 separate modules for each of the two applications: <strong>Thunderbird for Android</strong> will be located in <code>app-thunderbird</code> and <strong>K-9 Mail</strong> in <code>app-k9mail</code>. These modules will contain app-specific implementations, configurations, resources, and startup logic. They should solely depend on the <code>app-common</code> module for shared functionalities and may selectively integrate other modules when needed to configure app-specific functionality.</p>
<h3 id="app-common-module"><a class="header" href="#app-common-module">App Common Module</a></h3>
<p>A central module named <code>app-common</code> acts as the central integration point for shared code among the applications. This module contains the core functionality, shared resources, and configurations that are common to both apps. It should be kept as lean as possible to avoid unnecessary dependencies and ensure that it remains focused on shared functionality.</p>
<h2 id="consequences-5"><a class="header" href="#consequences-5">Consequences</a></h2>
<h3 id="positive-consequences-1"><a class="header" href="#positive-consequences-1">Positive Consequences</a></h3>
<ul>
<li>Enhanced maintainability due to a shared codebase for common functionalities, reducing code duplication.</li>
<li>Increased agility in developing and deploying new features across both applications, as common enhancements need to be implemented only once.</li>
</ul>
<h2 id="negative-consequences-1"><a class="header" href="#negative-consequences-1">Negative Consequences</a></h2>
<ul>
<li>Potential for configuration complexities as differentiations increase between the two applications.</li>
<li>Higher initial setup time and learning curve for new developers due to the modular and decoupled architecture.</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="project-structure"><a class="header" href="#project-structure">Project Structure</a></h1>
<ul>
<li>Issue: <a href="https://github.com/thunderbird/thunderbird-android/issues/7852" title="" target="_blank">#7852</a></li>
<li>Pull Request: <a href="https://github.com/thunderbird/thunderbird-android/pull/7829" title="" target="_blank">#7829</a></li>
</ul>
<h2 id="status-6"><a class="header" href="#status-6">Status</a></h2>
<ul>
<li><strong>Accepted</strong></li>
</ul>
<h2 id="context-6"><a class="header" href="#context-6">Context</a></h2>
<p>The project consists of two distinct applications. To improve maintainability and streamline development, we propose a modular structure using Gradle. This structure is designed to enable clear separation of concerns, facilitate scalable growth, and ensure efficient dependency management. It consists of various module types such as <code>app</code>, <code>app-common</code>, <code>feature</code>, <code>core</code>, and <code>library</code> modules, promoting enhanced modular reusability.</p>
<h2 id="decision-6"><a class="header" href="#decision-6">Decision</a></h2>
<p>To achieve the goals outlined in the context, we have decided to adopt the following modular structure:</p>
<ol>
<li><strong>App Modules</strong>:
<ul>
<li><code>app-thunderbird</code> and <code>app-k9mail</code> are the modules for the two applications, Thunderbird for Android and K-9 Mail respectively. These modules will contain app-specific implementations, configurations, resources, and startup logic. They should solely depend on the <code>app-common</code> module for shared functionalities and may selectively integrate <code>feature</code> and <code>core</code> to setup app-specific needs.</li>
</ul>
</li>
<li><strong>App Common Module</strong>:
<ul>
<li><code>app-common</code>: Acts as the central hub for shared code between both applications. This module serves as the primary “glue” that binds various <code>feature</code> modules together, providing a seamless integration point. While it can depend on <code>library</code> modules for additional functionalities, its main purpose is to orchestrate the interactions among the <code>feature</code> and <code>core</code> modules, ensuring similar functionality across both applications. This module should be kept lean to avoid unnecessary dependencies and ensure it remains focused on shared functionality.</li>
</ul>
</li>
<li><strong>Feature Modules</strong>:
<ul>
<li><code>feature:*</code>: These are independent feature modules, that encapsulate distinct user-facing features. They are designed to be reusable and can be integrated into any application module as needed. They maintain dependencies on <code>core</code> modules and may interact with other <code>feature</code> or <code>library</code> modules.</li>
</ul>
</li>
<li><strong>Core Module</strong>:
<ul>
<li><code>core:*</code>: The core modules contain essential utilities and base classes used across the entire project. These modules are grouped by their functionality (e.g., networking, database management, theming, common utilities). This segmentation allows for cleaner dependency management and specialization within foundational aspects.</li>
</ul>
</li>
<li><strong>Library Modules</strong>:
<ul>
<li><code>library:*</code> These modules are for specific implementations that might be used across various features or applications. They could be third-party integrations or complex utilities and eventually shared across multiple projects.</li>
</ul>
</li>
</ol>
<pre class="mermaid">graph TD
    subgraph APP[App]
        APP_K9[&quot;`
            **:app-k9mail**
            K-9 Mail
        `&quot;]
        APP_TB[&quot;`
            **:app-thunderbird**
            Thunderbird for Android
        `&quot;]
    end

    subgraph COMMON[App Common]
        APP_COMMON[&quot;`
            **:app-common**
            Integration Code
        `&quot;]
    end

    subgraph FEATURE[Feature]
        FEATURE1[Feature 1]
        FEATURE2[Feature 2]
    end

    subgraph CORE[Core]
        CORE1[Core 1]
        CORE2[Core 2]
    end

    subgraph LIBRARY[Library]
        LIB1[Library 1]
        LIB2[Library 2]
    end

    APP --&gt; |depends on| COMMON
    COMMON --&gt; |integrates| FEATURE
    FEATURE --&gt; |uses| CORE
    FEATURE --&gt; |uses| LIBRARY

    classDef module fill:yellow
    classDef app fill:azure
    classDef app_common fill:#ddd
    class APP_K9 app
    class APP_TB app
    class APP_COMMON app_common
</pre>
<h3 id="legacy-modules"><a class="header" href="#legacy-modules">Legacy Modules</a></h3>
<p>Modules that are still required for the project to function, but don’t follow the new project structure.</p>
<p>These modules should not be used for new development.</p>
<p>The goal is to migrate the functionality of these modules to the new structure over time. By placing them under the <code>legacy</code> module, we can easily identify and manage them.</p>
<pre class="mermaid">graph TD
    subgraph APP[App]
        APP_K9[&quot;`
            **:app-k9mail**
            K-9 Mail
        `&quot;]
        APP_TB[&quot;`
            **:app-thunderbird**
            Thunderbird for Android
        `&quot;]
    end

    subgraph COMMON[App Common]
        APP_COMMON[&quot;`
            **:app-common**
            Integration Code
        `&quot;]
    end

    subgraph FEATURE[Feature]
        FEATURE1[Feature 1]
        FEATURE2[Feature 2]
        FEATURE3[Feature from Legacy]
    end

    subgraph CORE[Core]
        CORE1[Core 1]
        CORE2[Core 2]
        CORE3[Core from Legacy]
    end

    subgraph LIBRARY[Library]
        LIB1[Library 1]
        LIB2[Library 2]
    end

    APP --&gt; |depends on| COMMON
    COMMON --&gt; |integrates| FEATURE
    FEATURE --&gt; |uses| CORE
    FEATURE --&gt; |uses| LIBRARY

    subgraph LEGACY[Legacy]
        LEG[Legacy Code]
    end

    COMMON -.-&gt; |integrates| LEGACY
    LEG -.-&gt; |migrate to| FEATURE3
    LEG -.-&gt; |migrate to| CORE3

    classDef module fill:yellow
    classDef app fill:azure
    classDef app_common fill:#ddd
    classDef legacy fill:#F99
    class APP_K9 app
    class APP_TB app
    class APP_COMMON app_common
    class LEGACY legacy
</pre>
<h2 id="consequences-6"><a class="header" href="#consequences-6">Consequences</a></h2>
<h3 id="positive-consequences-2"><a class="header" href="#positive-consequences-2">Positive Consequences</a></h3>
<ul>
<li>Improved modularity facilitates easier code maintenance and scaling.</li>
<li>Clear separation of concerns reduces dependencies and potential conflicts between modules.</li>
<li>Enhanced reusability of the <code>feature</code>, <code>core</code> and <code>library</code> modules across different parts of the application or even in different projects.</li>
</ul>
<h3 id="negative-consequences-2"><a class="header" href="#negative-consequences-2">Negative Consequences</a></h3>
<ul>
<li>Initial complexity in setting up and managing multiple modules may increase the learning curve and setup time for new developers.</li>
<li>Over-modularization can lead to excessive abstraction, potentially impacting runtime performance and complicating the debugging process.</li>
<li>Legacy modules may require additional effort to migrate to the new structure, potentially causing delays in the adoption of the new architecture.</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="change-shared-modules-package-to-netthunderbird"><a class="header" href="#change-shared-modules-package-to-netthunderbird">Change Shared Modules package to <code>net.thunderbird</code></a></h1>
<ul>
<li>Issue: <a href="https://github.com/thunderbird/thunderbird-android/issues/9012" title="" target="_blank">#9012</a></li>
</ul>
<h2 id="status-7"><a class="header" href="#status-7">Status</a></h2>
<ul>
<li><strong>Accepted</strong></li>
</ul>
<h2 id="context-7"><a class="header" href="#context-7">Context</a></h2>
<p>The Thunderbird Android project is a white-label version of K-9 Mail, and both apps — <code>app-thunderbird</code> and <code>app-kmail</code>
— coexist in the same repository. They have distinct application IDs and branding, but share a significant portion of
the code through common modules.</p>
<p>These shared modules currently use the <code>app.k9mail</code> or <code>com.fsck</code> package name, which are legacy artifacts from
K-9 Mail. While K-9 will remain available for some time, the project’s primary focus has shifted toward Thunderbird.</p>
<p>To reflect this shift, establish clearer ownership, and prepare for future development (including cross-platform code
integration), we will rename the packages in shared modules from <code>app.k9mail</code> and <code>com.fsck</code> to <code>net.thunderbird</code>.
The actual application IDs and package names of <code>app-thunderbird</code> and <code>app-k9mail</code> must remain <strong>unchanged</strong>.</p>
<h2 id="decision-7"><a class="header" href="#decision-7">Decision</a></h2>
<p>We decided to rename the base package in all shared modules from <code>app.k9mail</code> and <code>com.fsck</code> to <code>net.thunderbird</code>.</p>
<p>Specifically:</p>
<ul>
<li>All Kotlin/Java packages in shared modules will be refactored to use <code>net.thunderbird</code> as the base</li>
<li>This must not affect the application IDs or packages of <code>app-thunderbird</code> or <code>app-kmail</code>, which will remain as-is</li>
<li>All references, imports, and configuration references will be updated accordingly</li>
<li>Tests, resources, and Gradle module settings will be adjusted to match the new package structure</li>
</ul>
<p>This change will establish a clearer identity for the shared code, align with Thunderbird’s branding, and prepare the
project for cross-platform development.</p>
<h2 id="consequences-7"><a class="header" href="#consequences-7">Consequences</a></h2>
<h2 id="positive-consequences-3"><a class="header" href="#positive-consequences-3">Positive Consequences</a></h2>
<ul>
<li>Shared code reflects Thunderbird branding and identity</li>
<li>Reduces confusion when navigating codebase shared by both apps</li>
<li>Sets the foundation for cross-platform compatibility and future modularization</li>
<li>Helps reinforce long-term direction of the project toward Thunderbird</li>
</ul>
<h2 id="negative-consequences-3"><a class="header" href="#negative-consequences-3">Negative Consequences</a></h2>
<ul>
<li>Large-scale refactoring required across multiple modules</li>
<li>Risk of introducing regressions during package renaming</li>
<li>Potential for disruption in local development setups (e.g., IDE caching, broken imports)</li>
<li>Contributors familiar with the old structure may need time to adjust</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="installing-adb-android-debug-bridge"><a class="header" href="#installing-adb-android-debug-bridge">Installing ADB (Android Debug Bridge)</a></h1>
<p><a href="https://developer.android.com/tools/adb" title="" target="_blank">Android Debug Bridge (<strong>adb</strong>)</a> is a versatile command-line tool that lets you communicate with an Android-powered
device connected to a computer via USB. One of its useful features is the ability to capture a debug log (<code>logcat</code>).</p>
<p>See: <a href="user-guide/setup/../troubleshooting/collecting-debug-logs.html#step-3-collect-the-debug-log">Collect and Share Debug Logs → Step 3</a>.</p>
<h2 id="download-and-install"><a class="header" href="#download-and-install">Download and Install</a></h2>
<p>You don’t need the full Android SDK to use adb. Instead, download the smaller <a href="https://developer.android.com/tools/releases/platform-tools" title="" target="_blank">Android Platform Tools</a> which include <strong>adb</strong> and other essential utilities.</p>
<ol>
<li>Go to the <a href="https://developer.android.com/tools/releases/platform-tools" title="" target="_blank">Android Platform Tools download page</a>.</li>
<li>Download the package for your operating system (Windows, macOS, or Linux).</li>
<li>Extract the contents of the downloaded archive to a location on your computer.</li>
<li>Run <code>adb</code> directly from that folder.</li>
</ol>
<p>If you plan to use <strong>adb</strong> often, add the <code>platform-tools</code> folder to your system <strong>PATH</strong> so you can run adb
from any terminal or command prompt.</p>
<h2 id="enable-debugging-on-your-device"><a class="header" href="#enable-debugging-on-your-device">Enable Debugging on Your Device</a></h2>
<p>Before adb can communicate with your Android device, you must enable <strong>USB debugging</strong>:</p>
<ol>
<li>On your device, go to <strong>Settings</strong> → <strong>About phone</strong>.</li>
<li>Tap <strong>Build number</strong> seven times to enable <strong>Developer options</strong>. You may need to enter your device PIN or password to confirm.</li>
<li>Go back to <strong>Settings</strong> and select <strong>System</strong> (or directly <strong>Developer options</strong> on some devices).</li>
<li>Enable <strong>USB debugging</strong>.</li>
</ol>
<p>For more detailed instructions, refer to the <a href="https://developer.android.com/studio/debug/dev-options" title="" target="_blank">official guide</a>.</p>
<h2 id="connect-your-device"><a class="header" href="#connect-your-device">Connect Your Device</a></h2>
<ol>
<li>Connect your Android device to your computer via USB.</li>
<li>The first time you connect, unlock your device and accept the <strong>RSA key prompt</strong> to authorize the connection.</li>
<li>You may choose to always allow connections from this computer.</li>
</ol>
<p><strong>Windows</strong></p>
<p>You may need to install a <strong>USB driver</strong> for your device if it’s not recognized, see the <a href="https://developer.android.com/studio/run/oem-usb" title="" target="_blank">OEM USB Drivers</a> page for instructions.</p>
<p><strong>Linux</strong></p>
<p>You may need to add a <strong>udev rules</strong> file. See <a href="https://developer.android.com/studio/run/device#setting-up" title="" target="_blank">here</a> for details.</p>
<h2 id="verify-connection"><a class="header" href="#verify-connection">Verify Connection</a></h2>
<p>Run the following from inside the <code>platform-tools</code> folder (or anywhere, if adb is in your PATH):</p>
<pre><code class="language-bash">adb devices
</code></pre>
<p>If connected, you should see your device listed under List of devices attached.</p>
<ul>
<li>If the device is listed as <strong>unauthorized</strong>, check your device for the <strong>RSA prompt</strong> and accept it.</li>
<li>If the device is listed as <strong>offline</strong>:</li>
</ul>
<ol>
<li>Try killing the adb server with <code>adb kill-server</code></li>
<li>Disable and enable USB debugging on the device.</li>
<li>Start the adb server again with <code>adb start-server</code>d</li>
<li>Reconnect the device and check <code>adb devices</code> again.</li>
</ol>
<h2 id="when-finished"><a class="header" href="#when-finished">When Finished</a></h2>
<p>When you’re done using adb, you can simply disconnect your device. If you want to stop the adb server, run:</p>
<pre><code class="language-bash">adb kill-server
</code></pre>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="collecting-debug-logs"><a class="header" href="#collecting-debug-logs">Collecting Debug Logs</a></h1>
<p>Thunderbird for Android can produce debug logs to help diagnose problems and errors. This guide explains how to enable
logging, reproduce the issue, collect logs, and share them with the team.</p>
<h2 id="before-you-start"><a class="header" href="#before-you-start">Before you start</a></h2>
<ul>
<li>If the app is <strong>crashing on startup</strong>, jump directly
to <a href="user-guide/troubleshooting/collecting-debug-logs.html#method-b-using-a-pc-with-adb">Method B: Using a PC with ADB</a>.</li>
<li>Logs may include sensitive information (e.g., email addresses, server hostnames). You should redact <strong>passwords</strong>.</li>
<li>When possible, share the <strong>complete log</strong> to maximize debugging value.</li>
</ul>
<h2 id="step-1-enable-debug-logging"><a class="header" href="#step-1-enable-debug-logging">Step 1: Enable debug logging</a></h2>
<ol>
<li>Open Thunderbird for Android.</li>
<li>Go to: <strong>Settings</strong> → <strong>General settings</strong> → <strong>Debugging</strong>.</li>
<li>Check: <strong>Enable debug logging</strong>.</li>
</ol>
<p>If Thunderbird crashes before you can reach Settings, jump directly
to <a href="user-guide/troubleshooting/collecting-debug-logs.html#method-b-using-a-pc-with-adb">Method B: Using a PC with ADB</a>.</p>
<h2 id="step-2-reproduce-the-problem"><a class="header" href="#step-2-reproduce-the-problem">Step 2: Reproduce the problem</a></h2>
<p>Perform the actions that lead to the error or crash. This ensures the relevant events are captured in the log.</p>
<p>Take note of:</p>
<ul>
<li>The <strong>steps you performed</strong> (e.g. “Opened folder → tapped compose → app crashed”).</li>
<li>The <strong>exact time</strong> the issue occurred (to help locate it in the log).</li>
</ul>
<p>This information makes it easier to match the log entries to the problem when reviewing your report.</p>
<h2 id="step-3-collect-the-debug-log"><a class="header" href="#step-3-collect-the-debug-log">Step 3: Collect the debug log</a></h2>
<p>Choose one of the following methods:</p>
<h3 id="method-a-from-within-the-app"><a class="header" href="#method-a-from-within-the-app">Method A: From within the app</a></h3>
<p>Use this if the app is <strong>not</strong> crashing during startup.</p>
<ul>
<li>Go to: <strong>Settings</strong> → <strong>General settings</strong> → <strong>Debugging</strong>.</li>
<li>Tap the menu and select: <strong>Export logs</strong>.</li>
<li>Choose a location to save the log file.</li>
</ul>
<h3 id="method-b-using-a-pc-with-adb"><a class="header" href="#method-b-using-a-pc-with-adb">Method B: Using a PC with ADB</a></h3>
<p>Use this if the app <strong>crashes on startup</strong> or you prefer collecting logs via a computer.</p>
<p><strong>Requirements:</strong></p>
<ul>
<li>A computer with the <a href="https://developer.android.com/tools/adb" title="" target="_blank">Android Platform Tools (ADB)</a> installed. See
also <a href="user-guide/troubleshooting/../setup/installing-adb.html">Installing ADB</a>.</li>
<li>USB debugging enabled on your Android device.</li>
</ul>
<p><strong>Steps:</strong></p>
<ol>
<li>
<p>Connect your device to the computer and verify ADB sees it:</p>
<pre><code class="language-bash">adb devices
</code></pre>
<p>You should see your device listed. If not, ensure drivers are installed (Windows) and USB debugging is enabled.</p>
</li>
<li>
<p>Find Thunderbird’s <strong>process ID (PID)</strong>:</p>
<ul>
<li>
<p>On Linux / macOS:</p>
<pre><code class="language-bash">adb shell ps | grep net.thunderbird.android
# For K-9 Mail:
adb shell ps | grep com.fsck.k9
</code></pre>
</li>
<li>
<p>On Windows (Command Prompt):</p>
<pre><code class="language-bash">adb shell ps -A | findstr net.thunderbird.android
# For K-9 Mail:
adb shell ps -A | findstr com.fsck.k9
</code></pre>
</li>
</ul>
<p>Example output:</p>
<pre><code class="language-plaintext">u0_a153       5191   587 4468612 112380 SyS_epoll_wait      0 S net.thunderbird.android
</code></pre>
<p>In this example, the PID is <strong>5191</strong>.</p>
</li>
<li>
<p>Capture the debug log to a file:</p>
<pre><code class="language-bash">adb logcat -d --pid=&lt;PID&gt; &gt; thunderbird-log.txt
</code></pre>
<p>Replace <code>&lt;PID&gt;</code> (including brackets) with the actual number.</p>
<ul>
<li>If you see an ADB error like <code>&gt; was unexpected at this time.</code>, it usually means you forgot to replace <code>&lt;PID&gt;</code> with
the actual number.
To capture <strong>ongoing logs</strong> while reproducing the issue:</li>
</ul>
<pre><code class="language-bash">adb logcat --pid=&lt;PID&gt; &gt; thunderbird-log.txt
</code></pre>
<p>Stop the command with <strong>Ctrl+C</strong> (Windows/Linux) or <strong>Command+C</strong> (macOS).</p>
</li>
</ol>
<p><strong>Tips:</strong></p>
<ul>
<li>If the app restarts and gets a new PID, repeat step 2 to obtain the current PID and run the capture command again.</li>
<li>If <code>pgrep</code> is unavailable, see <a href="user-guide/troubleshooting/collecting-debug-logs.html#troubleshooting-adb">Troubleshooting ADB</a></li>
</ul>
<h2 id="step-4-check-logs-for-sensitive-information"><a class="header" href="#step-4-check-logs-for-sensitive-information">Step 4: Check Logs for Sensitive Information</a></h2>
<p>Debug logs may include details about your account or device. While most of this is safe to share, here are some things
you may want to remove before attaching logs:</p>
<ul>
<li><strong>Passwords</strong>: Look for lines with <code>AUTH</code>, <code>LOGIN</code>, or <code>PASSWORD</code>. Replace with password with <code>redacted-password</code>.</li>
<li><strong>Personal Identifiable Information (PII)</strong>: Email addresses, phone numbers, or real names. Consider replacing with
placeholders like <code>redacted-pii</code>.</li>
<li><strong>Server Hostnames/IPs</strong>: If you’re concerned about privacy, replace with <code>redacted-mail-server</code>.</li>
<li><strong>OAuth Tokens</strong>: Look for lines containing <code>oauth=</code> or <code>token=</code>. Replace with <code>redacted-oauth-token</code>.</li>
</ul>
<h3 id="how-to-quickly-search-logs"><a class="header" href="#how-to-quickly-search-logs">How to Quickly Search Logs</a></h3>
<ul>
<li>
<p>On Windows: Open the file in Notepad or another text editor and use <strong>Ctrl+F</strong> to search.</p>
</li>
<li>
<p>On macOS/Linux: Use <code>grep</code> in the terminal. For example, to find passwords:</p>
<pre><code class="language-bash">grep -iE 'auth|login|password' thunderbird-log.txt
</code></pre>
</li>
</ul>
<h2 id="step-5-report-the-issue-and-attach-logs"><a class="header" href="#step-5-report-the-issue-and-attach-logs">Step 5: Report the Issue and Attach Logs</a></h2>
<ol>
<li>Create a new issue in our <a href="https://github.com/thunderbird/thunderbird-android/issues/new/choose" title="" target="_blank">bug tracker</a></li>
<li>Include the following:
<ul>
<li>Thunderbird for Android <strong>version number</strong> (see <a href="user-guide/troubleshooting/find-your-app-version.html">Find out version number</a>).</li>
<li>A clear description of the problem and ideally steps to reproduce it.</li>
<li>The collected log file as an <strong>attachment</strong>.</li>
<li>Any relevant <strong>screenshots</strong> or <strong>screen recordings</strong>.</li>
</ul>
</li>
</ol>
<h2 id="troubleshooting-adb"><a class="header" href="#troubleshooting-adb">Troubleshooting ADB</a></h2>
<p>If <code>adb devices</code> shows <strong>unauthorized</strong>, accept the RSA key prompt on your device. If it doesn’t appear:</p>
<pre><code class="language-bash">adb kill-server
adb start-server
</code></pre>
<p>On <em>Windows</em>, install OEM USB drivers if your device isn’t detected.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="find-your-app-version"><a class="header" href="#find-your-app-version">Find Your App Version</a></h1>
<p>For <a href="https://github.com/k9mail/k-9/issues/new/choose" title="" target="_blank">bug reports</a> it’s important for the developers to know which
version of Thunderbird you’re using. This is especially true if you attach debug logs, since they show exactly which
part of the code was active when the error occurred. Because the apps are updated frequently, version numbers
(and code line references) can change quickly.</p>
<p>Follow the instructions below to find the exact version number you’re running.</p>
<h2 id="methods"><a class="header" href="#methods">Methods</a></h2>
<p>There are several ways to check the version number: inside the app, through Android’s system settings, or with ADB.</p>
<h3 id="in-the-app-about-screen"><a class="header" href="#in-the-app-about-screen">In the App (About screen)</a></h3>
<ol>
<li>Start <strong>Thunderbird</strong>.</li>
<li>Go to the <strong>Settings</strong>.</li>
<li>Select <strong>About</strong>.</li>
<li>The version string is shown under <strong>Version</strong>.</li>
</ol>
<h3 id="from-android-app-info"><a class="header" href="#from-android-app-info">From Android: App Info</a></h3>
<p>If the app won’t start, Android usually displays the version number at the bottom of its <strong>App info</strong> screen.</p>
<ol>
<li>Open the system <strong>Settings</strong> app.</li>
<li>Navigate to <strong>Apps</strong> (or <strong>Apps &amp; notifications</strong>).</li>
<li>Find and select <strong>Thunderbird</strong> from the list of installed apps.</li>
<li>Scroll down to the bottom of the screen to find the version number.</li>
</ol>
<p>Alternatively, you can long-press the Thunderbird icon in your app drawer or home screen, then tap the “App info” (i) icon that appears.</p>
<h3 id="using-adb-advanced"><a class="header" href="#using-adb-advanced">Using ADB (Advanced)</a></h3>
<p>If you have <a href="user-guide/troubleshooting/../setup/installing-adb.html">ADB</a> set up, you can retrieve the version number via the command line:</p>
<pre><code class="language-bash">adb shell dumpsys package net.thunderbird.android | grep versionName
adb shell dumpsys package net.thunderbird.android.beta | grep versionCode
adb shell dumpsys package net.thunderbird.android.daily | grep versionCode

# For K-9 Mail:
adb shell dumpsys package com.fsck.k9 | grep versionName
</code></pre>
<p>This will return a line like:</p>
<pre><code class="language-plaintext">versionName=12.1
</code></pre>
<h2 id="special-note-for-custom-builds"><a class="header" href="#special-note-for-custom-builds">Special Note for Custom Builds</a></h2>
<p>If you’ve built your own version of the app from the source repository, please include the commit hash in your bug
report along with the version number.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="thunderbird-for-android-release-documentation"><a class="header" href="#thunderbird-for-android-release-documentation">Thunderbird for Android Release Documentation</a></h1>
<p>Please see the sub-pages for release documentation</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="releases"><a class="header" href="#releases">Releases</a></h1>
<p>Thunderbird for Android follows a release train model to ensure timely and predictable releases. This model allows for regular feature rollouts, stability improvements, and bug fixes.</p>
<h2 id="branches-in-the-release-train-model"><a class="header" href="#branches-in-the-release-train-model">Branches in the Release Train Model</a></h2>
<h3 id="daily"><a class="header" href="#daily">Daily</a></h3>
<p>Daily builds are used for initial testing of new features and changes. Feature flags are used to work on features that are not yet ready for consumption.</p>
<ul>
<li><strong>Branch:</strong> <code>main</code></li>
<li><strong>Purpose:</strong> Active development of new features and improvements</li>
<li><strong>Release Cadence:</strong> Daily</li>
<li><strong>Audience:</strong> Developers and highly technical users who want to test the bleeding edge of Thunderbird. Daily builds are unstable and not recommended for production use.</li>
<li><strong>Availability:</strong> Daily builds are available on the Play Store internal channel. APKs are available on <a href="https://ftp.mozilla.org/pub/thunderbird-mobile/" title="" target="_blank">ftp.mozilla.org</a>.</li>
</ul>
<h3 id="beta"><a class="header" href="#beta">Beta</a></h3>
<p>After features are stabilized in Daily, they are merged into the Beta branch for broader testing. Uplifts are limited to bug/security fixes only. The Beta branch serves as a preview of what will be included in the next stable release, allowing for user feedback and final adjustments before general availability.</p>
<ul>
<li><strong>Branch:</strong> <code>beta</code></li>
<li><strong>Purpose:</strong> Pre-release testing</li>
<li><strong>Release Cadence:</strong> Weekly with the option to skip if not needed</li>
<li><strong>Merge Cadence:</strong> Every 4 weeks</li>
<li><strong>Audience:</strong> Early adopters and testers. Testers are encouraged to provide error logs and help reproduce issues filed.</li>
<li><strong>Availability:</strong> Beta builds are available from the <a href="https://play.google.com/store/apps/details?id=net.thunderbird.android.beta" title="" target="_blank">Play Store</a> and <a href="https://f-droid.org/packages/net.thunderbird.android.beta" title="" target="_blank">F-Droid</a>.</li>
</ul>
<h3 id="release"><a class="header" href="#release">Release</a></h3>
<p>This branch represents the stable version of Thunderbird. It is tested and suitable for general use. Uplifts to Release are limited to stability/security fixes only.</p>
<ul>
<li><strong>Branch:</strong> <code>release</code></li>
<li><strong>Purpose:</strong> Stable releases</li>
<li><strong>Release Cadence:</strong> Major releases every 4 weeks. Minor release 2 weeks after a major release with the option to skip if not needed.</li>
<li><strong>Merge Cadence:</strong> Every 4 weeks</li>
<li><strong>Audience:</strong> General users. Users may be filing bug reports or leaving reviews to express their level of satisfaction.</li>
<li><strong>Availability:</strong> Release builds are available from the <a href="https://play.google.com/store/apps/details?id=net.thunderbird.android" title="" target="_blank">Play Store</a> and <a href="https://f-droid.org/packages/net.thunderbird.android" title="" target="_blank">F-Droid</a>.</li>
</ul>
<h2 id="sample-release-timeline"><a class="header" href="#sample-release-timeline">Sample Release Timeline</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Milestone</th><th>Details</th><th>Date</th></tr></thead><tbody>
<tr><td>TfA 14.0a1 starts</td><td></td><td>Aug 28</td></tr>
<tr><td>TfA 12.0</td><td></td><td>Sep 1</td></tr>
<tr><td>TfA 13.0b1</td><td></td><td>Sep 1</td></tr>
<tr><td>TfA 13.0bX</td><td>If needed</td><td>Sep 8</td></tr>
<tr><td>TfA 12.1</td><td>If needed</td><td>Sep 15</td></tr>
<tr><td>TfA 13.0bX</td><td>If needed</td><td>Sep 15</td></tr>
<tr><td>TfA 14.0a1 soft freeze starts</td><td></td><td>Sep 18</td></tr>
<tr><td>TfA 13.0bX</td><td>If needed</td><td>Sep 22</td></tr>
<tr><td>TfA merge 13.0 beta-&gt;release</td><td></td><td>Sep 22</td></tr>
<tr><td>TfA merge 14.0 main-&gt;beta</td><td></td><td>Sep 25</td></tr>
<tr><td>TfA 15.0a1 starts</td><td></td><td>Sep 25</td></tr>
<tr><td>TfA 13.0</td><td></td><td>Sep 29</td></tr>
<tr><td>TfA 14.0b1</td><td></td><td>Sep 29</td></tr>
</tbody></table>
</div>
<h2 id="soft-freeze"><a class="header" href="#soft-freeze">Soft Freeze</a></h2>
<p>A week long soft freeze occurs for the <code>main</code> branch prior to merging into the <code>beta</code> branch. During this time:</p>
<ul>
<li>Risky code should not land</li>
<li>Disabled feature flags should not be enabled</li>
</ul>
<h2 id="feature-flags"><a class="header" href="#feature-flags">Feature Flags</a></h2>
<p>Thunderbird for Android uses Feature Flags to disable features not yet ready for consumption.</p>
<ul>
<li>On <code>main</code>, feature flags are enabled as soon as developers have completed all pull requests related to the feature.</li>
<li>On <code>beta</code>, feature flags remain enabled unless the feature has not been fully completed and the developers would like to pause the feature.</li>
<li>On <code>release</code>, feature flags are disabled until an explicit decision has been made to enable the feature for all users.</li>
</ul>
<h2 id="uplifts"><a class="header" href="#uplifts">Uplifts</a></h2>
<p>Uplifts should be avoided if possible and fixes should ride the train. There are cases, however, where a bug is severe enough to warrant an uplift.
If the urgency of a fix requires it to uplifted to the Beta or Release channel before the next merge, the uplift process must be followed.</p>
<h3 id="uplift-criteria"><a class="header" href="#uplift-criteria">Uplift Criteria</a></h3>
<p>Beta uplifts should:</p>
<ul>
<li>Be limited to bug/security fixes only. Features ride the train.</li>
<li>Not change any localizable strings.</li>
<li>Have tests, or a strong statement of what can be done in the absence of tests.</li>
<li>Have landed in main and stabilized on the daily channel.</li>
<li>Have a comment in the GitHub issue assessing the reasons the patch is needed and risks involved in taking the patch.</li>
</ul>
<p>Release uplifts should additionally:</p>
<ul>
<li>Be limited to stability/security fixes only. Features ride the train.</li>
<li>Have landed in beta and stabilized on the beta channel.</li>
</ul>
<p>Examples: Fixes for security vulnerabilies, dataloss, or a crash that affects a large number of users.</p>
<h3 id="uplift-process"><a class="header" href="#uplift-process">Uplift Process</a></h3>
<ol>
<li>The requestor creates a pull request against the target uplift branch.</li>
<li>The requestor adds a comment to the pull request with the Approval Request template filled out.</li>
<li>The release driver reviews the uplift request, merging if approved, or closing with a comment if rejected.</li>
</ol>
<p>Template for uplift requests:</p>
<pre><code class="language-sh">[Approval Request]
Original Issue/Pull request:
Regression caused by (issue #):
User impact if declined:
Testing completed (on daily, etc.):
Risk to taking this patch (and alternatives if risky):
</code></pre>
<h2 id="versioning-system"><a class="header" href="#versioning-system">Versioning System</a></h2>
<h3 id="version-names"><a class="header" href="#version-names">Version Names</a></h3>
<p>Thunderbird for Android stable release versions follow the <code>X.Y</code> format, where:</p>
<ul>
<li><strong>X (Major version):</strong> Incremented for each new release cycle.</li>
<li><strong>Y (Patch version):</strong> Incremented when changes are added to an existing major version.</li>
</ul>
<p>For beta builds, the suffix <code>b1</code> is appended, where the number increments for each beta. For daily builds, the suffix <code>a1</code> is appended, which remains constant.</p>
<h3 id="version-codes"><a class="header" href="#version-codes">Version Codes</a></h3>
<p>The version code is an internal version number for Android that helps determine whether one version is more recent than another.</p>
<p>The version code for beta and release is an integer value that increments for each new release.</p>
<p>The version code for daily is calculated based on the date and has the format <code>yDDDHHmm</code>:</p>
<ul>
<li><strong>y</strong>: The number of years since a base year, with 2023 as the starting point (e.g., 2024 is 1)</li>
<li><strong>DDD</strong>: The day of the year in 3 digits, zero-padded</li>
<li><strong>HH</strong>: The hour of the day in 2 digits (00–23)</li>
<li><strong>mm</strong>: The minute of the hour in 2 digits</li>
</ul>
<p>For example:</p>
<ul>
<li><code>2024-02-09 16:45</code> → <code>1 | 040 | 16 | 45</code> → <code>10401645</code></li>
<li><code>2025-10-12 09:23</code> → <code>2 | 285 | 09 | 23</code> → <code>22850923</code></li>
<li><code>2122-02-09 16:45</code> → <code>99 | 040 | 16 | 45</code> → <code>990401645</code></li>
</ul>
<h2 id="merge-days"><a class="header" href="#merge-days">Merge Days</a></h2>
<p>Active development occurs on the <code>main</code> branch and becomes part of the daily build. Every 4 weeks:</p>
<ol>
<li><code>main</code> is merged into <code>beta</code>, for testing.</li>
<li><code>beta</code> is merged into <code>release</code>, making it publicly available.</li>
</ol>
<p>On the former, <code>main</code> carries over to <code>beta</code>, where the community can test the changes as part of “Thunderbird Beta for Testers” (<code>net.thunderbird.android.beta</code>) until the next merge day.
On the latter, code that was in beta goes to release, where the general population receives product updates (<code>net.thunderbird.android</code>).</p>
<p>When a merge occurs, the version name is carried forward to the next branch, and the alpha/beta suffixes are removed/reset accordingly. For example, let’s say we are shortly before the Thunderbird 9.0 release. The latest releases were Thunderbird 8.1, Thunderbird Beta 9.0b4, and Thunderbird Daily 10.0a1. Here is what happens:</p>
<ul>
<li>The <code>beta</code> branch is merged to <code>release</code>. The resulting version on release changes from 8.1 to 9.0.</li>
<li>The <code>main</code> branch is merged to <code>beta</code>. The resulting version on beta changes from 9.0b4 to 10.0b1</li>
<li>The <code>main</code> branch version number is changed from 10.0a1 to 11.0a1</li>
</ul>
<p>While the version name changes, it must be ensured that the version code remains on the same sequence for each branch. For example:</p>
<ul>
<li>If the version code on the beta branch is 20 at 9.0b4, it will be 21 at 10.0b1.</li>
<li>If the version code on the release branch is 12 at 8.1, it will be 13 at 9.0.</li>
</ul>
<p>Our application IDs are specific to the branch they are on. For example:</p>
<ul>
<li>Beta always uses <code>net.thunderbird.android.beta</code> as the app ID for TfA.</li>
<li>Release always uses <code>net.thunderbird.android</code> as the app ID for TfA.</li>
<li>Release always uses <code>com.fsck.k9</code> as the app ID for K-9.</li>
</ul>
<h2 id="milestones"><a class="header" href="#milestones">Milestones</a></h2>
<p>We use GitHub Milestones to track work for each major release. There is only one milestone for the whole major release, so work going into 9.0 and 9.1 would both be in the “Thunderbird 9” milestone. Each milestone has the due date set to the anticipated release date.</p>
<p>There are exactly three open milestones at any given time, some of our automation depends on this being the case. The milestone with the date furthest into the future is the target for the <code>main</code> branch, the one closest is the target for the <code>release</code> branch. When an uplift occurs, the milestone is changed to the respective next target.</p>
<p>Learn more on the <a href="https://github.com/thunderbird/thunderbird-android/milestones" title="" target="_blank">milestones page</a></p>
<h2 id="merge-process"><a class="header" href="#merge-process">Merge Process</a></h2>
<p>The merge process enables various benefits, including:</p>
<ul>
<li>Carrying forward main branch history to beta, and beta branch history to release.</li>
<li>No branch history is lost.</li>
<li>Git tags are retained in the git log.</li>
<li>Files/code that is unique per branch can remain that way (e.g. notes files such as changelog_master.xml, version codes).</li>
</ul>
<p>The following steps are taken when merging main into beta:</p>
<ol>
<li>Lock the main branch with the ‘CLOSED TREE (main)’ ruleset</li>
<li>Send a message to the #tb-mobile-dev:mozilla.org matrix channel to let them know:</li>
</ol>
<ul>
<li>You will be performing the merge from main into beta</li>
<li>The main branch is locked and cannot be changed during the merge</li>
<li>You will let them know when the merge is complete and main is re-opened</li>
</ul>
<ol start="3">
<li>Review merge results and ensure correctness</li>
<li>Ensure feature flags are following the rules</li>
<li>Push the merge</li>
<li>Submit a pull request that increments the version in main</li>
<li>Open a new milestone for the new version on github</li>
<li>Once the version increment is merged into main, unlock the branch</li>
<li>Send a message to the #tb-mobile-dev:mozilla.org channel to notify of merge completion and that main is re-opened</li>
</ol>
<p>The following steps are taken when merging beta into release:</p>
<ol>
<li>Send a message to the #tb-mobile-dev:mozilla.org matrix channel to let them know:</li>
</ol>
<ul>
<li>You will be performing the merge from beta into release</li>
<li>You will let them know when the merge is complete</li>
</ul>
<ol start="2">
<li>Review merge results and ensure correctness</li>
<li>Ensure feature flags are following the rules</li>
<li>Push the merge</li>
<li>Close the milestone for the version that was previously in release</li>
<li>Send a message to the #tb-mobile-dev:mozilla.org channel to notify of merge completion</li>
</ol>
<p>Merges are performed with the <code>do_merge.sh</code> script.</p>
<p>The following will merge main into beta:
<code>scripts/ci/merges/do_merge.sh beta</code></p>
<p>And the following will merge beta into release:
<code>scripts/ci/merges/do_merge.sh release</code></p>
<p>Be sure to review merge results and ensure correctness before pushing to the repository.</p>
<p>Files of particular importance are:</p>
<ul>
<li>app-k9mail/build.gradle.kts</li>
<li>app-thunderbird/build.gradle.kts</li>
<li>app-k9mail/src/main/res/raw/changelog_master.xml</li>
</ul>
<p>These build.gradle.kts files must be handled as described in “Merge Days” section above. This is part of the do_merge.sh automation.
The app-k9mail/src/main/res/raw/changelog_master.xml should not include any beta notes in the release branch.</p>
<h2 id="releases-1"><a class="header" href="#releases-1">Releases</a></h2>
<p>Releases for both K-9 and Thunderbird for Android are automated with github actions.
Daily builds are scheduled with the <a href="https://github.com/thunderbird/thunderbird-android/actions/workflows/daily_builds.yml" title="" target="_blank">Daily Builds</a> action and all builds are performed by the <a href="https://github.com/thunderbird/thunderbird-android/actions/workflows/shippable_builds.yml" title="" target="_blank">Shippable Build &amp; Signing</a> action.</p>
<p>For the historical manual release process, see <a href="ci/HISTORICAL_RELEASE.html">Releasing</a>.</p>
<h3 id="release-process"><a class="header" href="#release-process">Release Process</a></h3>
<p>These are the general steps for a release:</p>
<ol>
<li>Perform merge or uplifts. Each release is the result of either a merge or uplift.</li>
<li>Draft release notes at <a href="https://github.com/thunderbird/thunderbird-notes" title="" target="_blank">thunderbird-notes</a>.</li>
<li>Trigger build via the <a href="https://github.com/thunderbird/thunderbird-android/actions/workflows/shippable_builds.yml" title="" target="_blank">Shippable Build &amp; Signing</a> action.</li>
<li>Review the build results by reviewing the action summary and the git commits resulting from the build.
<ul>
<li>Make sure the version code is incremented properly and not wildly off</li>
<li>Ensure the commits are correct</li>
<li>Ensure the symlink <code>app-metadata</code> points to the right product at this commit</li>
</ul>
</li>
<li>Test the build in the internal testing track
<ul>
<li>Release versions should be thoroughly tested with the test plan in Testrail</li>
<li>Beta versions only require a basic smoke test to ensure it installs</li>
</ul>
</li>
<li>Promote TfA and K-9 releases to production track in Play Store.
<ul>
<li>Set rollout to a low rate (generally 10-30%).</li>
<li>Betas are only released for TfA. K-9 beta users are advised to use Thunderbird.</li>
</ul>
</li>
<li>Wait for Play Store review to complete.
<ul>
<li>Release versions of TfA and K-9 have managed publishing enabled. Once the review has completed you need to publish the release</li>
<li>Beta versions of TfA do not have managed publishing enabled. It will be available once Google has reviewed, even on a weekend.</li>
</ul>
</li>
<li>Update F-Droid to new TfA and K-9 releases by sending a pull request to <a href="https://gitlab.com/fdroid/fdroiddata" title="" target="_blank">fdroiddata</a></li>
<li>Send community updates to Matrix channels, and beta or planning mailing lists as needed.</li>
<li>Approximately 24 hours after initial release to production, assess the following before updating rollout to a higher rate:
<ul>
<li>Crash rates, GitHub issues, install base, and reviews.</li>
</ul>
</li>
</ol>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="release-automation-setup"><a class="header" href="#release-automation-setup">Release Automation Setup</a></h1>
<p>Release automation is triggered by the workflow_dispatch event on the “Shippable Build &amp; Signing”
workflow. GitHub environments are used to set configuration variables and secrets for each
application and release type.</p>
<h2 id="automatic-setup"><a class="header" href="#automatic-setup">Automatic setup</a></h2>
<p>There is a script available for automatic setup, which is helpful if you want to replicate this on
your own repository for devlopment. Please see /scripts/ci/setup_release_automation.</p>
<p>You can run it using:</p>
<pre><code class="language-bash">python -m venv venv
source venv/bin/activate
pip install requests pynacl
cd .signing
python ../scripts/ci/setup_release_automation -r yourfork/thunderbird-android
</code></pre>
<p>You will need the following files:</p>
<ul>
<li>The signing keys with their default filenames</li>
<li>A matrix-account.json with the following keys:</li>
</ul>
<pre><code class="language-json">{
  "homeserver": "matrix-client.matrix.org",
  "room": "room id here",
  "token": "matrix token here",
  "userMap": {
    "github_username": "@matrix_id:mozilla.org"
  }
}
</code></pre>
<ul>
<li><code>play-store-account.json</code> with the service account json that will do the uploads</li>
<li><code>thunderbird-mobile-gh-releaser-bot.clientid.txt</code> as a simple file with the client ID of the releaser bot (you can skip this to use GitHub Actions as the user)</li>
<li><code>thunderbird-mobile-gh-releaser-bot.pem</code> with the private key of the releaser bot</li>
</ul>
<h2 id="build-environments"><a class="header" href="#build-environments">Build Environments</a></h2>
<p>Build environments determine the configuration for the respective release channel. The following are
available:</p>
<ul>
<li>thunderbird_beta</li>
<li>thunderbird_daily</li>
<li>thunderbird_release</li>
</ul>
<p>The following (non-sensitive) variables have been set:</p>
<ul>
<li>RELEASE_TYPE: daily | beta | release</li>
<li>MATRIX_INCLUDES: A JSON string to determine the packages to be built</li>
</ul>
<p>The following MATRIX_INCLUDES would build an apk and aab for Thunderbird, and an apk for K-9 Mail.</p>
<pre><code class="language-json">[
  { "appName": "thunderbird", "packageFormat": "apk", "packageFlavor": "foss" },
  {
    "appName": "thunderbird",
    "packageFormat": "bundle",
    "packageFlavor": "full"
  },
  { "appName": "k9mail", "packageFormat": "apk", "packageFlavor": "foss" }
]
</code></pre>
<p>The environments are locked to the respective branch they belong to.</p>
<h2 id="signing-environments"><a class="header" href="#signing-environments">Signing Environments</a></h2>
<p>These environments contain the secrets for signing. Their names follow this pattern:</p>
<pre><code class="language-text">&lt;appName&gt;_&lt;releaseType&gt;_&lt;packageFlavor&gt;
thunderbird_beta_full
thunderbird_beta_foss
k9mail_beta_foss
</code></pre>
<p>The following secrets are needed:</p>
<ul>
<li>SIGNING_KEY: The base64 encoded signing key, see https://github.com/noriban/sign-android-release for details</li>
<li>KEY_ALIAS: The alias of your signing key</li>
<li>KEY_PASSWORD: The private key password for your signing keystore</li>
<li>KEY_STORE_PASSWORD: The password to your signing keystore</li>
</ul>
<p>The environments are locked to the respective branch they belong to.</p>
<h2 id="publishing-hold-environment"><a class="header" href="#publishing-hold-environment">Publishing Hold Environment</a></h2>
<p>The “publish_hold” is shared by all application variants and is used by the “pre_publish” job.
It has no secrets or variables, but “Required Reviewers” is set to trusted team members who oversee releases. The
effect is that after package signing completes, the publishing jobs that depend on it will not run until released
manually.</p>
<p><img src="ci/assets/publish_hold.png" alt="publish hold" /></p>
<h2 id="github-releases-environment"><a class="header" href="#github-releases-environment">Github Releases Environment</a></h2>
<p>This environment will create the github release. It uses <a href="https://github.com/actions/create-github-app-token" title="" target="_blank">actions/create-github-app-token</a>
to upload the release with limited permissions.</p>
<ul>
<li>RELEASER_APP_CLIENT_ID: Environment variable with the OAuth Client ID of the GitHub app</li>
<li>RELEASER_APP_PRIVATE_KEY: Secret with the private key of the app</li>
</ul>
<p>The releases environment is locked to the release, beta and main branches.</p>
<p>If you leave out the environment, the Github Actions user will be used.</p>
<h2 id="matrix-notify-environment"><a class="header" href="#matrix-notify-environment">Matrix Notify Environment</a></h2>
<p>This environment will notify about build updates. It requires the following keys:</p>
<ul>
<li>MATRIX_NOTIFY_TOKEN: The Matrix token of the user</li>
<li>MATRIX_NOTIFY_HOMESERVER: The homeserver for the account</li>
<li>MATRIX_NOTIFY_ROOM: The room id to notify in</li>
<li>MATRIX_NOTIFY_USER_MAP: A json object that maps github usernames to matrix ids</li>
</ul>
<p>If you leave out this environment, no notifications will be sent.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="developer-release-checklist"><a class="header" href="#developer-release-checklist">Developer Release Checklist</a></h1>
<p>This checklist is for developers. It summarizes what you (as a contributor/feature owner) should do before the scheduled merges in our release train:</p>
<ul>
<li>main → beta</li>
<li>beta → release</li>
</ul>
<p>For the full release-driver process (branch locks, announcements, publishing), see <a href="release/../ci/RELEASE.html">Release → Release Process</a>.</p>
<h2 id="ongoing-between-merges"><a class="header" href="#ongoing-between-merges">Ongoing (between merges)</a></h2>
<p>Do these as part of regular development:</p>
<ul>
<li>Identify potential uplifts early
<ul>
<li>Add risk and user impact notes to the issue/PR; ensure the fix lands on <code>main</code> and bakes on Daily first — see <a href="release/../ci/RELEASE.html#uplifts">Uplifts</a> and <a href="release/../ci/RELEASE.html#uplift-criteria">Uplift Criteria</a></li>
</ul>
</li>
<li>Strings and translations
<ul>
<li>Avoid late string changes; if unavoidable, keep them small, so translators can catch up</li>
<li>Prefer not changing localizable strings for uplifts</li>
<li>Follow <a href="release/../contributing/managing-strings.html#-changing-translations-in-the-repo">Changing translations in this repository</a> only when truly necessary</li>
</ul>
</li>
<li>Quality signals you own
<ul>
<li>Watch crash/ANR reports and GitHub issues for your area of work and investigate regressions</li>
</ul>
</li>
<li>Project management
<ul>
<li>Keep your issues in the project up to date (assignees, labels, status) and link PRs to issues</li>
<li>Ensure your issues are added to the <a href="https://github.com/orgs/thunderbird/projects/20" title="" target="_blank">project sprint board</a> and assigned to the current sprint</li>
<li>Review the sprint board regularly and pick up backlog items as capacity allows, especially bugs and regressions</li>
<li>When reviewing external contributions:
<ul>
<li>Add the issue to the appropriate parent issue if not done already (e.g. <code>[EPIC] Mobile Foundations QX 20XX</code>)</li>
<li>Add the issue to the project sprint board and assign it to the current sprint</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="before-main--beta-developer-responsibilities"><a class="header" href="#before-main--beta-developer-responsibilities">Before main → beta (developer responsibilities)</a></h2>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>A one-week <a href="release/../ci/RELEASE.html#soft-freeze">Soft Freeze</a> occurs before merging <code>main</code> into <code>beta</code>.</p>
</div>
<p>During soft freeze:</p>
<ul>
<li>Avoid landing risky code changes</li>
<li>Do not enable feature flags that are currently disabled</li>
</ul>
<p>Goal: Changes on <code>main</code> are safe to expose to a broader audience.</p>
<ul>
<li>Feature flags
<ul>
<li>Ensure flags match the <a href="release/../ci/RELEASE.html#feature-flags">rules for beta</a>
<ul>
<li>New features are disabled by default unless explicitly approved for beta</li>
<li>Not-ready features must be disabled</li>
</ul>
</li>
<li>Prepare and merge a PR on <code>main</code> with necessary flag changes (before merge day)</li>
</ul>
</li>
<li>Translations
<ul>
<li>Ensure translation updates needed for your features are merged to <code>main</code></li>
<li>If no Weblate PR is pending, trigger one and help review it (fix conflicts if needed)</li>
</ul>
</li>
</ul>
<h2 id="before-beta--release-developer-responsibilities"><a class="header" href="#before-beta--release-developer-responsibilities">Before beta → release (developer responsibilities)</a></h2>
<p>Goal: Changes on <code>beta</code> are safe for general availability.</p>
<ul>
<li>Feature flags
<ul>
<li>Verify flags align with <a href="release/../ci/RELEASE.html#feature-flags">rules for release</a>
<ul>
<li>Features are disabled unless explicitly approved for release</li>
<li>Not-ready features remain disabled</li>
</ul>
</li>
<li>If changes are required, open a PR on <code>main</code> and request uplift to <code>beta</code> following the criteria in <a href="release/../ci/RELEASE.html#uplift-criteria">Uplift Criteria</a></li>
</ul>
</li>
<li>Translations
<ul>
<li>No new string changes at this stage; confirm your changes don’t introduce them</li>
</ul>
</li>
<li>Stability checks you can influence
<ul>
<li>Review crash/ANR reports and GitHub issues for changes affecting beta and release</li>
<li>Investigate regressions and propose fixes if needed</li>
<li>Ensure your changes have been tested on beta and address any issues found</li>
</ul>
</li>
</ul>
<h2 id="optional-pr-checklist-snippet"><a class="header" href="#optional-pr-checklist-snippet">Optional: PR checklist snippet</a></h2>
<p>Paste the following snippet into your PR description to help reviewers and release drivers verify readiness for merge:</p>
<pre><code class="language-markdown">- [ ] Feature flags set according to target branch rules ([beta](../ci/RELEASE.md#feature-flags) / [release](../ci/RELEASE.md#feature-flags))
- [ ] Tests added/updated; CI green on affected modules
- [ ] No new localizable strings (or justified and coordinated)
- [ ] Translations accounted for (Weblate PR merged or not required)
- [ ] Uplift label and risk/impact notes added if proposing uplift ([criteria](../ci/RELEASE.md#uplift-criteria))
</code></pre>
<h2 id="after-merges-what-developers-should-verify"><a class="header" href="#after-merges-what-developers-should-verify">After merges (what developers should verify)</a></h2>
<ul>
<li>Validate outcome for your changes
<ul>
<li>Watch crash/ANR and error reports for regressions related to your changes after rollout</li>
<li>Be prepared to propose/prepare a hotfix via the uplift process if necessary</li>
</ul>
</li>
</ul>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>Merge-day coordination (branch locks, Matrix announcements, running scripts) is handled by release drivers. See <a href="release/../ci/RELEASE.html#merge-process">Merge Process</a> for details.</p>
</div>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="create-k-9-mail-releases"><a class="header" href="#create-k-9-mail-releases">Create K-9 Mail releases</a></h1>
<div class="warning">
This document contains the historical manual release process for K-9 Mail. Please use the <a href="ci/AUTOMATION.html">automated process</a> instead.
We're keeping this around in case we need to do a manual release.
</div>
<h2 id="one-time-setup"><a class="header" href="#one-time-setup">One-time setup</a></h2>
<ol>
<li>Create a <code>.signing</code> folder in the root of the Git repository, if it doesn’t exist yet.</li>
<li>Download the <code>k9-release-signing.jks</code> and <code>k9.release.signing.properties</code> files from 1Password and place them in the <code>.signing</code> folder.</li>
</ol>
<p>Example <code>&lt;app&gt;.&lt;releaseType&gt;.signing.properties</code> file:</p>
<pre><code class="language-properties">&lt;app&gt;.&lt;releaseType&gt;.storeFile=&lt;path to keystore "../.signing/k9mail.jks"&gt;
&lt;app&gt;.&lt;releaseType&gt;.storePassword=&lt;storePassword&gt;
&lt;app&gt;.&lt;releaseType&gt;.keyAlias=&lt;keyAlias&gt;
&lt;app&gt;.&lt;releaseType&gt;.keyPassword=&lt;keyPassword&gt;
</code></pre>
<ul>
<li><code>&lt;app&gt;</code> is the short name of the app, e.g. <code>k9</code></li>
<li><code>&lt;releaseType&gt;</code> is the type of release, e.g. <code>release</code></li>
</ul>
<h3 id="one-time-setup-for-f-droid-builds"><a class="header" href="#one-time-setup-for-f-droid-builds">One-time setup for F-Droid builds</a></h3>
<ol>
<li>
<p>Install <em>fdroidserver</em> by following
the <a href="https://f-droid.org/docs/Installing_the_Server_and_Repo_Tools" title="" target="_blank">installation instructions</a>.</p>
<ol>
<li>On MacOS, it’s best to install the latest version from source, because the version in Homebrew has some issues.
<ol>
<li>
<p>Install the android command line tools if not available already.</p>
<pre><code class="language-shell">brew install --cask android-commandlinetools
</code></pre>
</li>
<li>
<p>Install latest <em>fdroidserver</em> from source:</p>
<pre><code class="language-shell">python -m venv fdroidserver-env
source fdroidserver-env/bin/activate
pip install git+https://gitlab.com/fdroid/fdroidserver.git
</code></pre>
</li>
<li>
<p>To use <em>fdroidserver</em> from the command line, you need to activate the virtual environment before each use:</p>
<pre><code class="language-shell">source fdroidserver-env/bin/activate
</code></pre>
</li>
<li>
<p>To deactivate the virtual environment:</p>
<pre><code class="language-shell">deactivate
</code></pre>
</li>
</ol>
</li>
</ol>
</li>
<li>
<p><a href="https://gitlab.com/users/sign_up" title="" target="_blank">Sign up for a Gitlab account</a> and fork
the <a href="https://gitlab.com/fdroid/fdroiddata" title="" target="_blank">fdroiddata</a> repository.</p>
</li>
<li>
<p>Clone your fork of the <em>fdroiddata</em> repository.</p>
</li>
</ol>
<h2 id="release-a-beta-version"><a class="header" href="#release-a-beta-version">Release a beta version</a></h2>
<ol>
<li>
<p>Update versionCode and versionName in <code>app-k9mail/build.gradle.kts</code></p>
</li>
<li>
<p>Create change log entries in</p>
<ul>
<li><code>app-k9mail/src/main/res/raw/changelog_master.xml</code></li>
<li><code>app-metadata/com.fsck.k9/en-US/changelogs/${versionCode}.txt</code>
Use past tense. Try to keep them high level. Focus on the user (experience).</li>
</ul>
</li>
<li>
<p>Update the metadata link to point to K-9 Mail’s data:
<code>ln --symbolic --no-dereference --force app-metadata/com.fsck.k9 metadata</code></p>
</li>
<li>
<p>Commit the changes. Message: “Version $versionName”</p>
</li>
<li>
<p>Run <code>./gradlew clean :app-k9mail:assembleRelease --no-build-cache --no-configuration-cache</code></p>
</li>
<li>
<p>Update an existing installation to make sure the app is signed with the proper key and runs on a real device.</p>
<pre><code class="language-shell">adb install -r app-k9mail/build/outputs/apk/release/app-k9mail-release.apk
</code></pre>
</li>
<li>
<p>Tag as $versionName, e.g. <code>6.508</code></p>
</li>
<li>
<p>Copy <code>app-k9mail/build/outputs/apk/release/app-k9mail-release.apk</code> as <code>k9-${versionName}.apk</code> to Google Drive (MZLA
Team &gt; K9 &gt; APKs)</p>
</li>
<li>
<p>Change versionName in <code>app-k9mail/build.gradle.kts</code> to next version name followed by <code>-SNAPSHOT</code></p>
</li>
<li>
<p>Commit the changes. Message: “Prepare for version $newVersionName”</p>
</li>
<li>
<p>Update <code>gh-pages</code> branch with the new change log</p>
</li>
<li>
<p>Push <code>main</code> branch</p>
</li>
<li>
<p>Push tags</p>
</li>
<li>
<p>Push <code>gh-pages</code> branch</p>
</li>
</ol>
<h3 id="create-release-on-github"><a class="header" href="#create-release-on-github">Create release on GitHub</a></h3>
<ol>
<li>Go to https://github.com/thunderbird/thunderbird-android/tags and select the appropriate tag</li>
<li>Click “Create release from tag”</li>
<li>Fill out the form
<ul>
<li>Click “Generate release notes”</li>
<li>Replace contents under “What’s changed” with change log entries</li>
<li>Add GitHub handles in parentheses to change log entries</li>
<li>If necessary, add another entry “Internal changes” (or similar) so people who contributed changes outside of the
entries mentioned in the change log can be mentioned via GitHub handle.</li>
<li>Attach the APK</li>
<li>Select “Set as a pre-release”</li>
<li>Click “Publish release”</li>
</ul>
</li>
</ol>
<h3 id="create-release-on-f-droid"><a class="header" href="#create-release-on-f-droid">Create release on F-Droid</a></h3>
<ol>
<li>
<p>Fetch the latest changes from the <em>fdroiddata</em> repository.</p>
</li>
<li>
<p>Switch to a new branch in your copy of the <em>fdroiddata</em> repository.</p>
</li>
<li>
<p>Edit <code>metadata/com.fsck.k9.yml</code> to create a new entry for the version you want to release. Usually it’s copy &amp; paste
of the previous entry and adjusting <code>versionName</code>, <code>versionCode</code>, and <code>commit</code> (use the tag name).
Leave <code>CurrentVersion</code> and <code>CurrentVersionCode</code> unchanged. Those specify which version is the stable/recommended
build.</p>
<p>Example:</p>
<pre><code class="language-yaml">- versionName: "${versionName}"
  versionCode: ${versionCode}
  commit: "${tagName}"
  subdir: app-k9mail
  gradle:
    - yes
  scandelete:
    - build-plugin/build
</code></pre>
</li>
<li>
<p>Commit the changes. Message: “Update K-9 Mail to $newVersionName (beta)”</p>
</li>
<li>
<p>Run <code>fdroid build --latest com.fsck.k9</code> to build the project using F-Droid’s toolchain.</p>
</li>
<li>
<p>Push the changes to your fork of the <em>fdroiddata</em> repository.</p>
</li>
<li>
<p>Open a merge request on Gitlab. (The message from the server after the push in the previous step should contain a
URL)</p>
</li>
<li>
<p>Select the <em>App update</em> template and fill it out.</p>
</li>
<li>
<p>Create merge request and the F-Droid team will do the rest.</p>
</li>
</ol>
<h3 id="create-release-on-google-play"><a class="header" href="#create-release-on-google-play">Create release on Google Play</a></h3>
<ol>
<li>Go to the <a href="https://play.google.com/console/" title="" target="_blank">Google Play Console</a></li>
<li>Select the <em>K-9 Mail</em> app</li>
<li>Click on <em>Open testing</em> in the left sidebar</li>
<li>Click on <em>Create new release</em></li>
<li>Upload the APK to <em>App bundles</em></li>
<li>Fill out Release name (e.g. “$versionCode ($versionName)”)</li>
<li>Fill out Release notes (copy from <code>app-metadata/com.fsck.k9/en-US/changelogs/${versionCode}.txt</code>)</li>
<li>Click <em>Next</em></li>
<li>Review the release</li>
<li>Configure a full rollout for beta versions</li>
<li>On the Publishing overview page, click <em>Send change for review</em></li>
<li>Wait for the review to complete</li>
<li>In case of a rejection, fix the issues and repeat the process</li>
</ol>
<h2 id="release-a-stable-version"><a class="header" href="#release-a-stable-version">Release a stable version</a></h2>
<p>When the team decides the <code>main</code> branch is stable enough and it’s time to release a new stable version, create a new
maintenance branch (off <code>main</code>) using the desired version number with the last two digits dropped followed by <code>-MAINT</code>.
Example: <code>6.8-MAINT</code> when the first stable release is K-9 Mail 6.800.</p>
<p>Ideally the first stable release contains no code changes when compared to the last beta version built from <code>main</code>.
That way the new release won’t contain any changes that weren’t exposed to user testing in a beta version before.</p>
<ol>
<li>
<p>Switch to the appropriate maintenance branch, e.g. <code>6.8-MAINT</code></p>
</li>
<li>
<p>Update versionCode and versionName in <code>app-k9mail/build.gradle.kts</code> (stable releases use an even digit after the
dot, e.g. <code>5.400</code>, <code>6.603</code>)</p>
</li>
<li>
<p>Create change log entries in</p>
<ul>
<li><code>app-k9mail/src/main/res/raw/changelog_master.xml</code></li>
<li><code>app-k9mail/fastlane/metadata/android/en-US/changelogs/${versionCode}.txt</code>
Use past tense. Try to keep them high level. Focus on the user (experience).</li>
</ul>
</li>
<li>
<p>Update the metadata link to point to K-9 Mail’s data:
<code>ln --symbolic --no-dereference --force app-metadata/com.fsck.k9 metadata</code></p>
</li>
<li>
<p>Commit the changes. Message: “Version $versionName”</p>
</li>
<li>
<p>Run <code>./gradlew clean :app-k9mail:assembleRelease --no-build-cache --no-configuration-cache</code></p>
</li>
<li>
<p>Update an existing installation to make sure the app is signed with the proper key and runs on a real device.</p>
<pre><code class="language-shell">adb install -r app-k9mail/build/outputs/apk/release/app-k9mail-release.apk
</code></pre>
</li>
<li>
<p>Tag as $versionName, e.g. <code>6.800</code></p>
</li>
<li>
<p>Copy <code>app-k9mail/build/outputs/apk/release/app-k9mail-release.apk</code> as <code>k9-${versionName}.apk</code> to Google Drive (MZLA
Team &gt; K9 &gt; APKs)</p>
</li>
<li>
<p>Update <code>gh-pages</code> branch with the new change log. Create a new file if it’s the first stable release in a series.</p>
</li>
<li>
<p>Push maintenance branch</p>
</li>
<li>
<p>Push tags</p>
</li>
<li>
<p>Push <code>gh-pages</code> branch</p>
</li>
</ol>
<h3 id="create-release-on-github-1"><a class="header" href="#create-release-on-github-1">Create release on GitHub</a></h3>
<ol>
<li>Go to https://github.com/thunderbird/thunderbird-android/tags and select the appropriate tag</li>
<li>Click “Create release from tag”</li>
<li>Fill out the form
<ul>
<li>Click “Generate release notes”</li>
<li>Replace contents under “What’s changed” with change log entries</li>
<li>Add GitHub handles in parentheses to change log entries</li>
<li>If necessary, add another entry “Internal changes” (or similar) so people who contributed changes outside of the
entries mentioned in the change log can be mentioned via GitHub handle.</li>
<li>Attach the APK</li>
<li>Select “Set as the latest release”</li>
<li>Click “Publish release”</li>
</ul>
</li>
</ol>
<h3 id="create-release-on-f-droid-1"><a class="header" href="#create-release-on-f-droid-1">Create release on F-Droid</a></h3>
<ol>
<li>
<p>Fetch the latest changes from the <em>fdroiddata</em> repository.</p>
</li>
<li>
<p>Switch to a new branch in your copy of the <em>fdroiddata</em> repository.</p>
</li>
<li>
<p>Edit <code>metadata/com.fsck.k9.yml</code> to create a new entry for the version you want to release. Usually it’s copy &amp; paste
of the previous entry and adjusting <code>versionName</code>, <code>versionCode</code>, and <code>commit</code> (use the tag name).
Change <code>CurrentVersion</code> and <code>CurrentVersionCode</code> to the new values, making this the new stable/recommended build.</p>
<p>Example:</p>
<pre><code class="language-yaml">- versionName: "${versionName}"
  versionCode: ${versionCode}
  commit: "${tagName}"
  subdir: app-k9mail
  gradle:
    - yes
  scandelete:
    - build-plugin/build
</code></pre>
</li>
<li>
<p>Commit the changes. Message: “Update K-9 Mail to $newVersionName”</p>
</li>
<li>
<p>Run <code>fdroid build --latest com.fsck.k9</code> to build the project using F-Droid’s toolchain.</p>
</li>
<li>
<p>Push the changes to your fork of the <em>fdroiddata</em> repository.</p>
</li>
<li>
<p>Open a merge request on Gitlab. (The message from the server after the push in the previous step should contain a
URL)</p>
</li>
<li>
<p>Select the <em>App update</em> template and fill it out.</p>
</li>
<li>
<p>Create merge request and the F-Droid team will do the rest.</p>
</li>
</ol>
<h3 id="create-release-on-google-play-1"><a class="header" href="#create-release-on-google-play-1">Create release on Google Play</a></h3>
<ol>
<li>Go to the <a href="https://play.google.com/console/" title="" target="_blank">Google Play Console</a></li>
<li>Select the <em>K-9 Mail</em> app</li>
<li>Click on <em>Production</em> in the left sidebar</li>
<li>Click on <em>Create new release</em></li>
<li>Upload the APK to <em>App bundles</em></li>
<li>Fill out Release name (e.g. “$versionCode ($versionName)”)</li>
<li>Fill out Release notes (copy from <code>app-k9mail/fastlane/metadata/android/en-US/changelogs/${versionCode}.txt</code>)</li>
<li>Click <em>Next</em></li>
<li>Review the release</li>
<li>Start with a staged rollout (usually 20%)</li>
<li>On the Publishing overview page, click <em>Send change for review</em></li>
<li>Wait for the review to complete</li>
<li>In case of a rejection, fix the issues and repeat the process</li>
<li>Once the review is complete, monitor the staged rollout for issues and increase the rollout percentage as necessary</li>
</ol>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="f-droid"><a class="header" href="#f-droid">F-Droid</a></h3>
<p>If the app doesn’t show up in the F-Droid client:</p>
<ul>
<li>Check the build cycle, maybe you just missed it and it will be available in the next cycle. (The cycle is usually every 5 days.)</li>
<li>Check <a href="https://fdroidstatus.org/status/fdroid" title="" target="_blank">F-Droid Status</a> for any issues.</li>
<li>Check <a href="https://monitor.f-droid.org/builds" title="" target="_blank">F-Droid Monitor</a> for any errors mentioning <code>com.fsck.k9</code>.</li>
</ul>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer><div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="how-to-document"><a class="header" href="#how-to-document">How to Document</a></h1>
<p>This guide provides detailed instructions for contributing to and maintaining the documentation for the Thunderbird for Android project. It explains the tools used, the structure of the documentation, and guidelines for creating and editing content.</p>
<p>We use <a href="https://rust-lang.github.io/mdBook/" title="" target="_blank">mdbook</a> to generate the documentation. The source files for the documentation are located in the <code>docs/</code> directory.</p>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>If you’d like to contribute to this project, please familiarize yourself with our <a href="CONTRIBUTING.html">Contribution Guide</a>.</p>
<p>To add or modify the documentation, please edit the markdown files located in the <code>docs/</code> directory using standard Markdown syntax, including <a href="https://github.github.com/gfm/" title="" target="_blank">GitHub flavored Markdown</a>. You can use <code>headers</code>, <code>lists</code>, <code>links</code>, <code>code blocks</code>, and other Markdown features to structure your content.</p>
<p>For creating diagrams, we use the <a href="https://mermaid-js.github.io/mermaid/#/" title="" target="_blank">mermaid</a> syntax. To include mermaid diagrams in your Markdown files, use the following syntax:</p>
<pre><code class="language-markdown">```mermaid
graph TD;
    A--&gt;B;
    A--&gt;C;
    B--&gt;D;
    C--&gt;D;
```
</code></pre>
<p>Result:</p>
<pre class="mermaid">graph TD;
    A--&gt;B;
    A--&gt;C;
    B--&gt;D;
    C--&gt;D;
</pre>
<h3 id="adding-a-new-page"><a class="header" href="#adding-a-new-page">Adding a New Page</a></h3>
<p>To add a new page, create a markdown file in the <code>docs/</code> directory or within a suitable subfolder. For example:</p>
<ul>
<li>To create a new top-level page: <code>docs/NEW_PAGE.md</code>.</li>
<li>To create a page within a subfolder: <code>docs/subfolder/new-subpage.md</code>.</li>
</ul>
<p>To include the new page in the table of contents, add a link to the <code>SUMMARY.md</code> file pointing to newly created page.</p>
<p>For consistency with GitHub conventions and other mandatory files, markdown files in the top level
<code>docs/</code> directory shall be written in uppercase, as well the README.md file within subfolders.
Further markdown files in subdirectories shall use a lowercase filename.</p>
<h3 id="organizing-with-subfolders"><a class="header" href="#organizing-with-subfolders">Organizing with Subfolders</a></h3>
<p>Subfolders in the <code>docs/</code> folder can be used to organize related documentation. This can be useful if related topics should be grouped together. For example, we have a subfolder named <code>architecture/</code> for all documentation related to our application’s architecture.</p>
<h3 id="linking-new-pages-in-the-summary"><a class="header" href="#linking-new-pages-in-the-summary">Linking New Pages in the Summary</a></h3>
<p>The <code>SUMMARY.md</code> file serves as the table of contents (TOC) for the documentation. To include the new page in the TOC, a link needs to be added in the <code>SUMMARY.md</code> file, like so:</p>
<pre><code class="language-markdown">- [Page Title](relative/path/to/file.md)
</code></pre>
<p>Indentation is used to create hierarchy in the TOC:</p>
<pre><code class="language-markdown">- [Page Title](relative/path/to/file.md)
  - [Subpage Title](relative/path/to/subfolder/file.md)
</code></pre>
<h3 id="assets"><a class="header" href="#assets">Assets</a></h3>
<p>If you need to embed images, put them in the assets folder closest to the file they are being used
in. This can either be the top-level assets folder, or a (potentially new) assets subfolder in the
respective section.</p>
<h2 id="documentation-toolchain"><a class="header" href="#documentation-toolchain">Documentation Toolchain</a></h2>
<p>The documentation is built using mdbook and several extensions. Follow these steps to set up the required tools.</p>
<h3 id="install-mdbook-and-extensions"><a class="header" href="#install-mdbook-and-extensions">Install mdbook and extensions</a></h3>
<p>Ensure you have <a href="https://doc.rust-lang.org/cargo/" title="" target="_blank">Cargo</a> installed, then run:</p>
<pre><code class="language-shell">./docs/install.sh
</code></pre>
<p>This script installs <code>mdbook</code> and the required extensions and other dependencies.</p>
<p>Use –force to update the dependencies, recommended when mdbook was updated:</p>
<pre><code class="language-shell">./docs/install.sh --force
</code></pre>
<h3 id="extensions"><a class="header" href="#extensions">Extensions</a></h3>
<p>We use the following mdbook extensions:</p>
<ul>
<li><a href="https://github.com/jonahgoldwastaken/mdbook-external-links" title="" target="_blank">mdbook-external-links</a> for opening external links in a new tab.</li>
<li><a href="https://github.com/badboy/mdbook-last-changed" title="" target="_blank">mdbook-last-changed</a> for last change date inclusion.</li>
<li><a href="https://github.com/badboy/mdbook-mermaid" title="" target="_blank">mdbook-mermaid</a> for diagram generation.</li>
<li><a href="https://github.com/slowsage/mdbook-pagetoc" title="" target="_blank">mdbook-pagetoc</a> for automatic page table of contents.</li>
</ul>
<h2 id="building-the-documentation"><a class="header" href="#building-the-documentation">Building the Documentation</a></h2>
<p>Once you have <code>mdbook</code> and its extensions installed, you can build the documentation by running this command:</p>
<pre><code class="language-shell">mdbook build docs
</code></pre>
<p>The generated documentation will be available in the <code>book/docs/latest/</code> folder.</p>
<p>To preview the documentation, run the following command:</p>
<pre><code class="language-shell">mdbook serve docs --open
</code></pre>
<p>The <code>mdbook serve docs</code> command will serve the book at <a href="http://localhost:3000" title="" target="_blank">http://localhost:3000</a> and rebuild the documentation on changes. The <code>--open</code> option will open the book in your web browser and is optional.</p>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="assets/theme/mermaid.min.js"></script>
        <script src="assets/theme/mermaid-init.js"></script>
        <script src="assets/theme/navigation.js"></script>
        <script src="assets/theme/pagetoc.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
