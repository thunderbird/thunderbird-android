<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Module Organization - Thunderbird for Android - Developer Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Developer Documentation for the Thunderbird for Android project.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../assets/theme/last-changed.css">
        <link rel="stylesheet" href="../assets/theme/navigation.css">
        <link rel="stylesheet" href="../assets/theme/pagetoc.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Thunderbird for Android - Developer Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/thunderbird/thunderbird-android" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/thunderbird/thunderbird-android/edit/main/./architecture/module-organization.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="-module-organization"><a class="header" href="#-module-organization">📦 Module Organization</a></h1>
<p>The Thunderbird for Android project is following a modularization approach, where the codebase is divided into multiple
distinct modules. These modules encapsulate specific functionality and can be developed, tested, and maintained
independently. This modular architecture promotes reusability, scalability, and maintainability of the codebase.</p>
<p>This document outlines the adopted module organization for the Thunderbird for Android project, serving as a guide for
developers to understand the codebase structure and ensure consistent architectural patterns.</p>
<h2 id="-module-overview"><a class="header" href="#-module-overview">📂 Module Overview</a></h2>
<p>The modules are organized into several types, each serving a specific purpose in the overall architecture:</p>
<pre class="mermaid">graph TB
    subgraph APP[App Modules]
        direction TB
        APP_TB[&quot;`**:app-thunderbird**&lt;br&gt;Thunderbird for Android`&quot;]
        APP_K9[&quot;`**:app-k9mail**&lt;br&gt;K-9 Mail`&quot;]
    end

    subgraph COMMON[App Common Module]
        direction TB
        COMMON_APP[&quot;`**:app-common**&lt;br&gt;Integration Code`&quot;]
    end

    subgraph FEATURE[Feature Modules]
        direction TB
        FEATURE_ACCOUNT[&quot;`**:feature:account**`&quot;]
        FEATURE_SETTINGS[&quot;`**:feature:settings**`&quot;]
        FEATURE_ONBOARDING[&quot;`**:feature:onboarding**`&quot;]
        FEATURE_MAIL[&quot;`**:feature:mail**`&quot;]
    end

    subgraph CORE[Core Modules]
        direction TB
        CORE_UI[&quot;`**:core:ui**`&quot;]
        CORE_COMMON[&quot;`**:core:common**`&quot;]
        CORE_ANDROID[&quot;`**:core:android**`&quot;]
        CORE_NETWORK[&quot;`**:core:network**`&quot;]
        CORE_DATABASE[&quot;`**:core:database**`&quot;]
        CORE_TESTING[&quot;`**:core:testing**`&quot;]
    end

    subgraph LIBRARY[Library Modules]
        direction TB
        LIB_AUTH[&quot;`**:library:auth**`&quot;]
        LIB_CRYPTO[&quot;`**:library:crypto**`&quot;]
        LIB_STORAGE[&quot;`**:library:storage**`&quot;]
    end

    subgraph LEGACY[Legacy Modules]
        direction TB
        LEGACY_K9[&quot;`**:legacy**`&quot;]
        LEGACY_MAIL[&quot;`**:mail**`&quot;]
        LEGACY_BACKEND[&quot;`**:backend**`&quot;]
    end

    APP ~~~ COMMON
    COMMON ~~~ FEATURE
    FEATURE ~~~ CORE
    CORE ~~~ LIBRARY
    LIBRARY ~~~ LEGACY

    APP --&gt; |depends on| COMMON
    COMMON --&gt; |depends on| FEATURE
    FEATURE --&gt; |depends on| CORE
    CORE --&gt; |depends on| LIBRARY
    COMMON --&gt; |depends on&lt;br&gt;as legacy bridge| LEGACY

    classDef app fill:#d9e9ff,stroke:#000000,color:#000000
    classDef app_module fill:#4d94ff,stroke:#000000,color:#000000
    classDef common fill:#e6e6e6,stroke:#000000,color:#000000
    classDef common_module fill:#999999,stroke:#000000,color:#000000
    classDef feature fill:#d9ffd9,stroke:#000000,color:#000000
    classDef feature_module fill:#33cc33,stroke:#000000,color:#000000
    classDef core fill:#e6cce6,stroke:#000000,color:#000000
    classDef core_module fill:#cc99cc,stroke:#000000,color:#000000
    classDef library fill:#fff0d0,stroke:#000000,color:#000000
    classDef library_module fill:#ffaa33,stroke:#000000,color:#000000
    classDef legacy fill:#ffe6e6,stroke:#000000,color:#000000
    classDef legacy_module fill:#ff9999,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px
    linkStyle 0,1,2,3,4 stroke-width:0px

    class APP app
    class APP_TB,APP_K9 app_module
    class COMMON common
    class COMMON_APP common_module
    class FEATURE feature
    class FEATURE_ACCOUNT,FEATURE_SETTINGS,FEATURE_ONBOARDING,FEATURE_MAIL feature_module
    class CORE core
    class CORE_UI,CORE_COMMON,CORE_ANDROID,CORE_DATABASE,CORE_NETWORK,CORE_TESTING core_module
    class LIBRARY library
    class LIB_AUTH,LIB_CRYPTO,LIB_STORAGE library_module
    class LEGACY legacy
    class LEGACY_MAIL,LEGACY_BACKEND,LEGACY_K9 legacy_module
</pre>
<h3 id="module-types"><a class="header" href="#module-types">Module Types</a></h3>
<h4 id="-app-modules"><a class="header" href="#-app-modules">📱 App Modules</a></h4>
<p>The App Modules (<code>app-thunderbird</code> and <code>app-k9mail</code>) contain the application-specific code, including:</p>
<ul>
<li>Application entry points and initialization logic</li>
<li>Final dependency injection setup</li>
<li>Navigation configuration</li>
<li>Integration with feature modules solely for that application</li>
<li>App-specific themes and resources (strings, themes, etc.)</li>
</ul>
<h4 id="-app-common-module"><a class="header" href="#-app-common-module">🔄 App Common Module</a></h4>
<p>The <code>app-common</code> module acts as the central hub for shared code between both applications. This module serves as the
primary “glue” that binds various <code>feature</code> modules together, providing a seamless integration point. It also contains:</p>
<ul>
<li>Shared application logic</li>
<li>Feature coordination</li>
<li>Common dependency injection setup</li>
<li>Legacy code bridges and adapters</li>
</ul>
<h5 id="what-should-go-in-app-common"><a class="header" href="#what-should-go-in-app-common">What Should Go in App Common</a></h5>
<p>The app-common module should contain:</p>
<ol>
<li><strong>Shared Application Logic</strong>: Code that’s needed by both app modules but isn’t specific to any one feature.
<ul>
<li>Example: <code>BaseApplication</code> provides common application initialization, language management, and theme setup.</li>
<li>This avoids duplication between app-thunderbird and app-k9mail.</li>
</ul>
</li>
<li><strong>Feature Integration Code</strong>: Code that connects different features together.
<ul>
<li>Example: Code that coordinates between account and mail features.</li>
<li>This maintains separation between features while allowing them to work together.</li>
</ul>
</li>
<li><strong>Common Dependency Injection Setup</strong>: Koin modules that configure dependencies shared by both applications.
<ul>
<li>Example: <code>AppCommonModule</code> includes legacy modules and app-common specific modules.</li>
<li>This ensures consistent dependency configuration across both applications.</li>
</ul>
</li>
<li><strong>Legacy Code Bridges/Adapters</strong>: Implementations of interfaces defined in feature modules that delegate to legacy code.
<ul>
<li>Example: <code>DefaultAccountProfileLocalDataSource</code> implements <code>AccountProfileLocalDataSource</code> from <code>feature:account:core</code> and delegates to legacy account code.</li>
<li>These bridges isolate legacy code and prevent direct dependencies on it from feature modules.</li>
</ul>
</li>
</ol>
<h5 id="what-should-not-go-in-app-common"><a class="header" href="#what-should-not-go-in-app-common">What Should NOT Go in App Common</a></h5>
<p>The following should NOT be placed in app-common:</p>
<ol>
<li><strong>Feature-Specific Business Logic</strong>: Business logic that belongs to a specific feature domain should be in that feature’s module.
<ul>
<li>Example: Mail composition logic should be in <code>feature:mail</code>, not in app-common.</li>
<li>This maintains clear separation of concerns and feature independence.</li>
</ul>
</li>
<li><strong>UI Components</strong>: UI components should be in core:ui or in feature modules.
<ul>
<li>Example: A custom button component should be in core:ui, while a mail-specific UI component should be in feature:mail.</li>
<li>This ensures proper layering and reusability.</li>
</ul>
</li>
<li><strong>Direct Legacy Code</strong>: Legacy code should remain in legacy modules, with app-common providing bridges.
<ul>
<li>Example: Don’t move legacy mail code into app-common; instead, create a bridge in app-common.</li>
<li>This maintains the separation between legacy and modern code.</li>
</ul>
</li>
<li><strong>New Feature Implementations</strong>: New features should be implemented in feature modules, not in app-common.
<ul>
<li>Example: A new calendar feature should be in <code>feature:calendar</code>, not in app-common.</li>
<li>This ensures features can evolve independently.</li>
</ul>
</li>
</ol>
<h5 id="decision-criteria-for-new-contributors"><a class="header" href="#decision-criteria-for-new-contributors">Decision Criteria for New Contributors</a></h5>
<p>When deciding whether code belongs in app-common or a feature module, consider:</p>
<ol>
<li><strong>Is it shared between both applications?</strong> If yes, it might belong in app-common.</li>
<li><strong>Is it specific to a single feature domain?</strong> If yes, it belongs in that feature module.</li>
<li><strong>Does it bridge to legacy code?</strong> If yes, it belongs in app-common.</li>
<li><strong>Does it coordinate between multiple features?</strong> If yes, it might belong in app-common.</li>
<li><strong>Is it a new feature implementation?</strong> If yes, create a new feature module instead.</li>
</ol>
<p>Remember that app-common should primarily contain integration code, shared application logic, and bridges to legacy code. Feature-specific logic should be in feature modules, even if used by both applications.</p>
<h4 id="-feature-modules"><a class="header" href="#-feature-modules">✨ Feature Modules</a></h4>
<p>The <code>feature:*</code> modules are independent and encapsulate distinct user-facing feature domains. They are designed to be
reusable and can be integrated into any application module as needed.</p>
<p>Feature implementation modules (e.g., <code>:feature:account:impl</code>) should ideally not depend directly on other feature
implementation modules. Instead, they should depend on the public <code>:api</code> module of other features (e.g.,
<code>:feature:someOtherFeature:api</code>) to access their functionality through defined contracts, see
<a href="module-structure.html#-api-module">module structure</a> for more details.</p>
<p>When features are complex, they can be split into smaller sub feature modules, addressing specific aspects or
functionality within a feature domain:</p>
<ul>
<li><code>:feature:account:api</code>: Public interfaces for account management</li>
<li><code>:feature:account:settings:api</code>: Public interfaces for account settings</li>
<li><code>:feature:account:settings:impl</code>: Concrete implementations of account settings</li>
</ul>
<h4 id="-core-modules"><a class="header" href="#-core-modules">🧰 Core Modules</a></h4>
<p>The <code>core:*</code> modules contain foundational functionality used across the application:</p>
<ul>
<li><strong>core:ui</strong>: UI components, themes, and utilities</li>
<li><strong>core:common</strong>: Common utilities and extensions</li>
<li><strong>core:network</strong>: Networking utilities and API client infrastructure</li>
<li><strong>core:database</strong>: Database infrastructure and utilities</li>
<li><strong>core:testing</strong>: Testing utilities</li>
</ul>
<p>Core modules should only contain generic, reusable components that have no specific business logic.
Business objects (e.g., account, mail, etc.) should live in their respective feature modules.</p>
<h4 id="-library-modules"><a class="header" href="#-library-modules">📚 Library Modules</a></h4>
<p>The <code>library:*</code> modules are for specific implementations that might be used across various features or applications.
They could be third-party integrations or complex utilities and eventually shared across multiple projects.</p>
<h4 id="-legacy-modules"><a class="header" href="#-legacy-modules">🔙 Legacy Modules</a></h4>
<p>The <code>legacy:*</code> modules that are still required for the project to function, but don’t follow the new project structure.
These modules should not be used for new development. The goal is to migrate the functionality of these modules to the
new structure over time.</p>
<p>Similarly the <code>mail:*</code> and <code>backend:*</code> modules are legacy modules that contain the old mail and backend implementations.
These modules are being gradually replaced by the new feature modules.</p>
<p>The <code>legacy</code> modules are integrated into the <code>app-common</code> module, allowing them to be used by other parts of the app.
The glue code for bridging legacy code to the new modular architecture is also located in the <code>app-common</code> module. See
<a href="legacy-module-integration.html">module legacy integration</a> for more details.</p>
<h2 id="-module-dependencies"><a class="header" href="#-module-dependencies">🔗 Module Dependencies</a></h2>
<p>The module dependency diagram below illustrates how different modules interact with each other in the project,
showing the dependencies and integration points between modules:</p>
<ul>
<li><strong>App Modules</strong>: Depend on the App Common module for shared functionality and selectively integrate feature modules</li>
<li><strong>App Common</strong>: Integrates various feature modules to provide a cohesive application</li>
<li><strong>Feature Modules</strong>: Use core modules and libraries for their implementation, may depend on other feature api modules</li>
<li><strong>App-Specific Features</strong>: Some features are integrated directly by specific apps (K-9 Mail or Thunderbird)</li>
</ul>
<p>Rules for module dependencies:</p>
<ul>
<li><strong>One-Way Dependencies</strong>: Modules should not depend on each other in a circular manner</li>
<li><strong>API-Implementation Separation</strong>: Modules should depend on <code>api</code> modules, not <code>implementation</code> modules, see <a href="module-structure.html#module-structure">module structure</a></li>
<li><strong>Feature Integration</strong>: Features should be integrated through the <code>app-common</code> module, which acts as the central integration hub</li>
<li><strong>Dependency Direction</strong>: Dependencies should flow from app modules to common, then to features, and finally to core and libraries</li>
</ul>
<pre class="mermaid">graph TB
    subgraph APP[App Modules]
        direction TB
        APP_TB[&quot;`**:app-thunderbird**&lt;br&gt;Thunderbird for Android`&quot;]
        APP_K9[&quot;`**:app-k9mail**&lt;br&gt;K-9 Mail`&quot;]
    end

    subgraph COMMON[App Common Module]
        direction TB
        COMMON_APP[&quot;`**:app-common**&lt;br&gt;Integration Code`&quot;]
    end

    subgraph FEATURE[Feature Modules]
        direction TB
        FEATURE_ACCOUNT_API[&quot;`**:feature:account:api**`&quot;]
        FEATURE_ACCOUNT_IMPL[&quot;`**:feature:account:impl**`&quot;]
        FEATURE_SETTINGS_API[&quot;`**:feature:settings:api**`&quot;]
        FEATURE_K9[&quot;`**:feature:k9OnlyFeature:impl**`&quot;]
        FEATURE_TB[&quot;`**:feature:tfaOnlyFeature:impl**`&quot;]
    end

    subgraph CORE[Core Modules]
        direction TB
        CORE_UI_API[&quot;`**:core:ui:api**`&quot;]
        CORE_COMMON_API[&quot;`**:core:common:api**`&quot;]
    end

    subgraph LIBRARY[Library Modules]
        direction TB
        LIB_AUTH[&quot;`**:library:auth**`&quot;]
        LIB_STORAGE[&quot;`**:library:storage**`&quot;]
    end

    APP_K9 --&gt; |depends on| COMMON_APP
    APP_TB --&gt; |depends on| COMMON_APP
    COMMON_APP --&gt; |uses| FEATURE_ACCOUNT_API
    COMMON_APP --&gt; |injects/uses impl of| FEATURE_ACCOUNT_IMPL
    FEATURE_ACCOUNT_IMPL --&gt; FEATURE_ACCOUNT_API
    COMMON_APP --&gt; |uses| FEATURE_SETTINGS_API
    APP_K9 --&gt; |injects/uses impl of| FEATURE_K9
    APP_TB --&gt; |injects/uses impl of| FEATURE_TB
    FEATURE_ACCOUNT_API --&gt; |uses| CORE_UI_API
    FEATURE_SETTINGS_API --&gt; |uses| CORE_COMMON_API
    FEATURE_TB --&gt; |uses| LIB_AUTH
    FEATURE_K9 --&gt; |uses| LIB_STORAGE
    CORE_COMMON_API --&gt; |uses| LIB_STORAGE

    classDef app fill:#d9e9ff,stroke:#000000,color:#000000
    classDef app_module fill:#4d94ff,stroke:#000000,color:#000000
    classDef common fill:#e6e6e6,stroke:#000000,color:#000000
    classDef common_module fill:#999999,stroke:#000000,color:#000000
    classDef feature fill:#d9ffd9,stroke:#000000,color:#000000
    classDef feature_module fill:#33cc33,stroke:#000000,color:#000000
    classDef core fill:#e6cce6,stroke:#000000,color:#000000
    classDef core_module fill:#cc99cc,stroke:#000000,color:#000000
    classDef library fill:#fff0d0,stroke:#000000,color:#000000
    classDef library_module fill:#ffaa33,stroke:#000000,color:#000000
    classDef legacy fill:#ffe6e6,stroke:#000000,color:#000000
    classDef legacy_module fill:#ff9999,stroke:#000000,color:#000000

    linkStyle default stroke:#999,stroke-width:2px

    class APP app
    class APP_TB,APP_K9 app_module
    class COMMON common
    class COMMON_APP common_module
    class FEATURE feature
    class FEATURE_ACCOUNT_API,FEATURE_ACCOUNT_IMPL,FEATURE_SETTINGS_API,FEATURE_MAIL feature_module
    class CORE core
    class CORE_UI_API,CORE_COMMON_API core_module
    class LIBRARY library
    class LIB_AUTH,LIB_STORAGE library_module

    classDef featureK9 fill:#ffcccc,stroke:#cc0000,color:#000000
    classDef featureTB fill:#ccccff,stroke:#0000cc,color:#000000
    class FEATURE_K9 featureK9
    class FEATURE_TB featureTB
</pre>
<footer id="last-change">Last change: <time datetime="2025-09-30">2025-09-30</time>, commit: <a href="https://github.com/thunderbird/thunderbird-android/commit/5e9af44">5e9af44</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../architecture/README.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../architecture/module-structure.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../architecture/README.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../architecture/module-structure.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../assets/theme/mermaid.min.js"></script>
        <script src="../assets/theme/mermaid-init.js"></script>
        <script src="../assets/theme/navigation.js"></script>
        <script src="../assets/theme/pagetoc.js"></script>



    </div>
    </body>
</html>
